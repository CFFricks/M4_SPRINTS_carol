"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5176],{52736:function(t,e,i){i.d(e,{j:function(){return H}});var n={getProps:function(){return{}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("input"))},events:{input:function(t){var e=t.target;return{type:"change",x:e.xValue,y:e.yValue}},"button-press":function(){return{type:"press"}},"button-release":function(){return{type:"release"}}}};function r(t){return!!t||void 0}var a={events:{"button-press":function(){return{type:"reset-press"}},"button-release":function(){return{type:"reset-release"}}},getProps:function(t){return t?{ledPower:r(t.ledPower>.05),led13:r(t.led13>.05),ledRX:r(t.ledRX>.05),ledTX:r(t.ledTX>.05)}:{}}},s={getProps:function(t){return{hasSignal:r(null===t||void 0===t?void 0:t.playing)}}},o=i(82670),u={getProps:function(){return{}},syncInitialState:function(t){var e=function(){return t.dispatchEvent(new InputEvent("input"))};e(),new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e()}))})).observe(t,{attributes:!0})},events:{input:function(t){var e=t.target;if((0,o.Z)(e,HTMLElement)){var i=parseFloat(e.getAttribute("temperature")||""),n=parseFloat(e.getAttribute("humidity")||"");return{temperature:isNaN(i)?24:i,humidity:isNaN(n)?40:n}}}}},l={getProps:function(t){return t?{ledPower:r(t.ledPower>.05),led1:r(t.led1>.05)}:{}}},c={getProps:function(t){return t?{ledPower:r(t.ledPower>.05),led1:r(t.led>.05)}:{}}},d={getProps:function(){return{}},syncInitialState:function(t){var e=function(){return t.dispatchEvent(new InputEvent("input",{detail:parseFloat(t.getAttribute("distance")||"400")}))};e(),new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e()}))})).observe(t,{attributes:!0})},events:{input:function(t){var e=t.detail;if(null!=e)return{distance:e}}}},h={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i){for(var n=i.getImageData(0,0,128,128),r=n.data,a=t.pixels,s=t.invert,o=0;o<128;o++)for(var u=0;u<128;u++){var l=a[128*o+u],c=s?~l:l,d=4*(o*n.width+u);r[d+0]=(63488&c)>>8,r[d+1]=(2016&c)>>3,r[d+2]=(31&c)<<3,r[d+3]=255}i.putImageData(n,0,0)}}},v=240,f={getProps:function(){return{}},applyUpdate:function(t,e){var i,n=null===(i=e.canvas)||void 0===i?void 0:i.getContext("2d");if(n){for(var r=n.getImageData(0,0,v,320),a=r.data,s=t.pixels,o=t.invert,u=t.bgr,l=0;l<320;l++)for(var c=0;c<v;c++){var d=s[l*v+c],h=o?~d:d,f=4*(l*r.width+c),p=(63488&h)>>8,g=(31&h)<<3;a[f+0]=u?p:g,a[f+1]=(2016&h)>>3,a[f+2]=u?g:p,a[f+3]=255}n.putImageData(r,0,0)}},simulationStopped:function(t){var e,i=null===(e=t.canvas)||void 0===e?void 0:e.getContext("2d");i&&i.clearRect(0,0,v,320)}},p={getProps:function(){return{}},events:{"button-press":function(t){if((0,o.Z)(t,CustomEvent)&&"number"===typeof t.detail.irCode)return{address:0,command:t.detail.irCode}}}},g={getProps:function(t){return t?{cursor:r(t.cursor),blink:r(t.blink),cursorX:t.cursorX,cursorY:t.cursorY}:{}},applyUpdate:function(t,e){if(e.characters=t.value,e.backlight=t.backlight,t.cgramUpdated){var i=e.font.slice(0),n=t.cgram.slice(0,64);i.set(n,0),i.set(n,64),e.font=i}},simulationStopped:function(t){t.characters=new Uint8Array(80).fill(32),t.backlight=!1}},m={getProps:function(t){return null!=t?{value:r(t>=.01),brightness:t}:{}}},y={getProps:function(){return{}},events:{"button-press":function(t){if((0,o.Z)(t,CustomEvent))return{type:"press",row:t.detail.row,column:t.detail.column}},"button-release":function(t){if((0,o.Z)(t,CustomEvent))return{type:"release",row:t.detail.row,column:t.detail.column}}}},w={getProps:function(t){return t?{led1:r(t.ledOn)}:{}}},k=i(14116);function Z(t,e,i){return"serpentine"===i?function(t,i){return t%2===0?t*e+i:t*e+(e-i-1)}:function(t,i){return t*e+i}}var b={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i)for(var n,r=t.cols,a=t.rows,s=t.pixels,o=t.layout,u=t.brightness,l=t.colorFormat,c=Z(0,r,o),d=null!==(n=parseInt(e.dataset.pixsize||"",10))&&void 0!==n?n:1,h="circle"===e.dataset.pixtype,v=function(e){return isNaN(t.gamma)?e:255*Math.pow(e/255,t.gamma)},f=0;f<a;f++)for(var p=0;p<r;p++){var g=s[c(f,p)],m=void 0,y=void 0,w=void 0;if(l===k.q.RGBA){var b=u*((g>>24&255)/255);m=b*(255&g),y=b*(g>>8&255),w=b*(g>>16&255)}else w=u*v(255&g),m=u*v(g>>8&255),y=u*v(g>>16&255);if(i.fillStyle="rgb(".concat(m,", ").concat(y,", ").concat(w,")"),h){var C=d/2;i.beginPath(),i.ellipse(p*d+C,f*d+C,C,C,0,0,360),i.fill()}else i.fillRect(p*d,f*d,d,d)}}},C=i(11113),x={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i)for(var n,r=t.pixels,a="circle"===e.dataset.pixtype,s=null!==(n=parseInt(e.dataset.pixsize||"",10))&&void 0!==n?n:1,o=0;o<C.Cb;o++)for(var u=0;u<C.bf;u++){var l=r[o*C.bf+u],c=255&l,d=l>>8&255,h=l>>16&255;if(i.fillStyle="rgb(".concat(h,", ").concat(d,", ").concat(c,")"),a){var v=s/2;i.beginPath(),i.ellipse(u*s+v,o*s+v,v,v,0,0,360),i.fill()}else i.fillRect(u*s,o*s,s,s)}}},S={getProps:function(){return{}},applyUpdate:function(t,e){var i=t.cols,n=t.rows,r=t.pixels,a=t.layout,s=t.brightness/255,o=Z(0,i,a);if("function"===typeof e.setPixel)for(var u=0;u<n;u++)for(var l=0;l<i;l++){var c=r[o(u,l)],d=s*(255&c),h=s*(c>>8&255),v=s*(c>>16&255);e.setPixel(u,l,{r:h,g:v,b:d})}}},_={getProps:function(){return{}},applyUpdate:function(t,e){var i,n,r=null===(n=(i=e).getPort)||void 0===n?void 0:n.call(i);if(r&&this.lastValue!==t){this.lastValue=t;for(var a=new Uint8Array(3*t.length),s=0;s<t.length;s++){var o=t[s],u=255&o,l=o>>8&255,c=o>>16&255;a[3*s]=l,a[3*s+1]=c,a[3*s+2]=u}if(r.writable.locked)console.log("Serial NeoPixel: Skipped a frame");else{e.setTransmitting(!0);var d=r.writable.getWriter();d.write(a).then((function(){d.releaseLock()}))}}}},P={getProps:function(t){return t?{ledPower:r(t.ledOn),ledDO:r(t.ledDigitalOut)}:{}}},D={getProps:function(){return{min:"0",max:"1023",step:"1"}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("input",{detail:t.value}))},events:{input:function(t){var e=t.detail;if(null!=e)return{value:e}}}},I={getProps:function(){return{}},syncInitialState:function(t){t.wokwiListeners||(t.addEventListener("wokwi-keydown",(function(){t.pressed=!0,t.dispatchEvent(new CustomEvent("button-press"))})),t.addEventListener("wokwi-keyup",(function(){t.pressed=!1,t.dispatchEvent(new CustomEvent("button-release"))})),t.wokwiListeners=!0)},events:{"button-press":function(){return{type:"press"}},"button-release":function(){return{type:"release"}}}},A={getProps:function(){return{}},events:{dial:function(t){return(0,o.Z)(t,CustomEvent)?{type:"dial",digit:t.detail.digit}:null}}},R=i(51438),B=i(52951),E=i(14924),U=function(){function t(e){var i=this;(0,R.Z)(this,t),(0,E.Z)(this,"rpm",void 0),(0,E.Z)(this,"raf",void 0),(0,E.Z)(this,"targetAngle",void 0),(0,E.Z)(this,"lastAnimationTime",void 0),(0,E.Z)(this,"animate",void 0),(0,E.Z)(this,"servo",void 0),this.servo=e,this.rpm=60,this.raf=null,this.targetAngle=this.servo.angle,this.lastAnimationTime=0,this.animate=function(){var t=(new Date).getTime(),e=360*(t-i.lastAnimationTime)*i.rpm/60/1e3,n=i.targetAngle-i.angle,r=Math.min(Math.abs(n),e);r&&(i.servo.angle=i.angle+r*(n>0?1:-1),i.lastAnimationTime=t),i.raf=n?requestAnimationFrame(i.animate):null}}return(0,B.Z)(t,[{key:"angle",get:function(){return this.servo.angle},set:function(t){this.targetAngle=t,t!==this.angle?null==this.raf&&(this.lastAnimationTime=(new Date).getTime(),this.animate()):this.stop()}},{key:"stop",value:function(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}}]),t}(),N=Symbol("animator"),T={getProps:function(){return{}},applyUpdate:function(t,e){e[N]||(e[N]=new U(e)),e[N].angle=t}},O={getProps:function(t){return null!=t?{values:JSON.stringify(t.segments),colonValue:r(t.colon>.05)}:{values:"[]"}}},M={getProps:function(){return{}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("input",{detail:t.value}))},events:{input:function(t){var e=t.detail;if(null!=e)return{value:e}}}},V={getProps:function(){return{}},applyUpdate:function(t,e){e.setPixels(t)},simulationStopped:function(t){t.setPixels(new Uint32Array(0))}},L={getProps:function(t){return t?{ref:function(e){if(e){for(var i=e.imageData,n=t.pixels,r=t.invert,a=t.displayOn,s=t.reverseRows,o=t.scrollOffset,u=t.startLine,l=i.data,c=i.width,d=i.height,h=0;h<d;h++)for(var v=0;v<c;v++){var f=h+o+u,p=(s?d-1-f:f)%d,g=n[Math.floor(p/8)*c+v]&1<<p%8?!r:r,m=4*(h*i.width+v);l.fill(g?255:0,m,m+3),l[m+3]=a?255:0}e.redraw()}}}:{ref:function(t){t&&t.imageData&&(t.imageData.data.fill(0),t.redraw())}}}},F={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i){var n=t.pixels,r=i.getImageData(0,0,e.clientWidth,e.clientHeight);new Uint32Array(r.data.buffer).set(n),i.putImageData(r,0,0)}}},J={getProps:function(t){return null!=t?{values:JSON.stringify(t.segments)}:{values:"[]"}}},K={getProps:function(){return{}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("switch-change",{detail:-1}))},events:{"switch-change":function(t){return{values:t.target.values}}}},W=i(26042);var H={"wokwi-led":m,"wokwi-buzzer":s,"wokwi-dht22":u,"wokwi-lcd1602":g,"wokwi-lcd2004":g,"wokwi-led-ring":{getProps:function(){return{}},applyUpdate:function(t,e){if("function"===typeof e.setPixel)for(var i=0;i<t.length;i++){var n=t[i],r=(255&n)/255,a=(n>>8&255)/255,s=(n>>16&255)/255;e.setPixel(i,{r:a,g:s,b:r})}}},"wokwi-arduino-mega":a,"wokwi-arduino-nano":a,"wokwi-arduino-uno":a,"wokwi-dip-switch-8":K,"wokwi-esp32-devkit-v1":l,"wokwi-ssd1306":L,"wokwi-ds1307":{getProps:function(){return{}}},"wokwi-franzininho":c,"wokwi-hc-sr04":d,"wokwi-ir-receiver":{getProps:function(){return{}}},"wokwi-ir-remote":p,"wokwi-membrane-keypad":y,"wokwi-pi-pico":{getProps:function(t){return t?{led:t.led}:{}}},"wokwi-pushbutton":I,"wokwi-rotary-dialer":A,"wokwi-7segment":O,"wokwi-neopixel":{getProps:function(t){var e=null===t||void 0===t?void 0:t[0];return null!=e?{b:(255&e)/255,r:(e>>8&255)/255,g:(e>>16&255)/255}:{}}},"wokwi-neopixel-canvas":b,"wokwi-apa102-matrix":b,"wokwi-led-matrix":S,"wokwi-il9163":h,"wokwi-ili9341":f,"wokwi-neopixel-matrix":S,"wokwi-neopixel-serial":_,"wokwi-servo":T,"wokwi-slide-switch":M,"wokwi-splendida":V,"wokwi-max7219-matrix":{getProps:function(){return{}},applyUpdate:function(t,e){e.updatePixels(t.pixels)}},"wokwi-potentiometer":D,"wokwi-slide-potentiometer":D,"wokwi-analog-joystick":n,"wokwi-tv":F,"wokwi-logic-analyzer":{getProps:function(t){return t?{samples:t.samples,activeChannels:t.activeChannels}:{}}},"wokwi-photoresistor-sensor":P,"wokwi-ky-040":{getProps:function(){return{}},events:{"rotate-cw":function(){return{type:"rotate-cw"}},"rotate-ccw":function(){return{type:"rotate-ccw"}},"button-press":function(){return{type:"press"}},"button-release":function(){return{type:"release"}}}},"wokwi-mpu6050":w,"wokwi-rgb-led":{getProps:function(t){return null!=t?{ledRed:t.r,ledGreen:t.g,ledBlue:t.b}:{}}},"wokwi-tinypico":{getProps:function(t){return t?{ledPower:t.ledPower,ledRed:t.ledRed,ledGreen:t.ledGreen,ledBlue:t.ledBlue}:{}}},"wokwi-hub75-matrix":x,"wokwi-led-bar-graph":J,"wokwi-stepper-motor":{getProps:function(t){return t?(0,W.Z)({angle:t.angle},function(t){switch(t.display){case"angle":return{value:t.angle.toFixed(1),units:"degrees"};case"steps":return{value:Math.round(t.steps).toString(),units:"steps"};case"none":return{value:"",units:""}}}(t)):{angle:0}}},"wokwi-tm1637-7segment":{getProps:function(t){return null!=t?{values:JSON.stringify(t.segments),colonValue:r(t.colon),brightness:t.brightness}:{values:"[]"}}},"wokwi-biaxial-stepper":{getProps:function(t){var e,i;return{outerHandAngle:null!==(e=null===t||void 0===t?void 0:t.angle1)&&void 0!==e?e:0,innerHandAngle:null!==(i=null===t||void 0===t?void 0:t.angle2)&&void 0!==i?i:0}}},"wokwi-relay-module":{getProps:function(t){return t||{}}}}},5176:function(t,e,i){i.d(e,{F:function(){return Us},G:function(){return As}});var n=i(47568),r=i(51438),a=i(52951),s=i(14924),o=i(82670),u=i(26042),l=i(69396),c=i(10253),d=i(29815),h=i(20414),v=i(34051),f=i.n(v),p=i(68949),g=i(67090),m=i(12672),y=i(80947),w={ili9341:function(t,e){for(var i=t.pixels,n=t.invert,r=t.bgr,a=e.data,s=e.width,o=e.height,u=0;u<o;u++)for(var l=0;l<s;l++){var c=i[u*s+l],d=n?~c:c,h=4*(u*e.width+l),v=(63488&d)>>8,f=(31&d)<<3;a[h+0]=r?v:f,a[h+1]=(2016&d)>>3,a[h+2]=r?f:v,a[h+3]=255}},ssd1306:function(t,e){for(var i=t.pixels,n=t.invert,r=t.displayOn,a=t.reverseRows,s=t.scrollOffset,o=t.startLine,u=e.data,l=e.width,c=e.height,d=0;d<c;d++)for(var h=0;h<l;h++){var v=d+s+o,f=(a?c-1-v:v)%c,p=i[Math.floor(f/8)*l+h]&1<<f%8?!n:n,g=4*(d*e.width+h);u.fill(p?255:0,g,g+3),u[g+3]=r?255:0}}};function k(t){var e,i={},n=!0,r=!1,a=void 0;try{for(var s,o=(null!==(e=t.displays)&&void 0!==e?e:[])[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;i[u.id]=w[u.chip]}}catch(l){r=!0,a=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return{applyUpdate:function(t,e){var n=e.canvases;if(n){var r=!0,a=!1,s=void 0;try{for(var o,u=Object.keys(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=o.value,d=n[c],h=null===d||void 0===d?void 0:d.getContext("2d"),v=i[c];if(d&&h&&v){var f=h.getImageData(0,0,d.width,d.height);v(t[c],f),h.putImageData(f,0,0)}}}catch(l){a=!0,s=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}},simulationStopped:function(t){var e=t.canvases;if(e){var i=!0,n=!1,r=void 0;try{for(var a,s=Object.values(e)[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value,u=null===o||void 0===o?void 0:o.getContext("2d");o&&u&&u.clearRect(0,0,o.width,o.height)}}catch(l){n=!0,r=l}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},getProps:function(t){return t?{ledValues:t}:{}}}}var Z=i(37405),b=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this;(0,r.Z)(this,t),(0,s.Z)(this,"outgoingByte",0),(0,s.Z)(this,"incomingByte",0),(0,s.Z)(this,"bitIndex",0),(0,s.Z)(this,"selected",!1),(0,s.Z)(this,"onTransmit",void 0),(0,s.Z)(this,"paused",!1),(0,s.Z)(this,"enable",void 0),(0,s.Z)(this,"disable",void 0);var o=i>=2,u=1===i||3===i,l=e.ss,c=e.miso,d=e.clk,h=e.mosi;null===c||void 0===c||c.setState(n?Z.J.PullUp:Z.J.HighZ);var v=n?Z.J.PullUp:Z.J.High,f=c?function(){c.setState(a.outgoingByte&1<<7-a.bitIndex?v:Z.J.Low)}:function(){return 0},p=function(){var t,e;(a.incomingByte=a.incomingByte<<1|((null===h||void 0===h?void 0:h.value)?1:0),a.bitIndex++,8===a.bitIndex)&&(a.bitIndex=0,a.outgoingByte=0,null===(e=(t=a).onTransmit)||void 0===e||e.call(t,a.incomingByte),a.incomingByte=0)};this.selected=null==l||l.driven&&!1===l.value,this.enable=function(){a.selected||(a.bitIndex=0,o||f(),a.selected=!0,a.paused=!1)},this.disable=function(){null===c||void 0===c||c.setState(n?Z.J.PullUp:Z.J.HighZ),a.selected=!1},null===l||void 0===l||l.onStateChange((function(){(null===l||void 0===l?void 0:l.driven)&&!1===(null===l||void 0===l?void 0:l.value)?a.enable():a.disable()})),d.onValueChange((function(){if(a.selected&&!a.paused){var t=o!==d.value;u===t?f():p()}}))}return(0,a.Z)(t,[{key:"sendByte",value:function(t){this.outgoingByte=t}}]),t}(),C=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;(0,r.Z)(this,t),(0,s.Z)(this,"_pixels",void 0),(0,s.Z)(this,"index",void 0),(0,s.Z)(this,"frame",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"zeroCounter",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"pixels",void 0),this.pins=e,this.pixels=i,this._pixels=new Uint32Array(this.pixels),this.index=0,this.frame=0,this.value=0,this.updated=!1,this.zeroCounter=0;var a=new b({clk:e.clock,mosi:e.data,ss:e.ss});a.onTransmit=function(t){if(t)n.zeroCounter=0;else if(n.zeroCounter++,n.zeroCounter>=4)return n.index=0,void(n.frame=0);if(n.frame||(t=t<<3&255|(1&t?7:0)),n.value=n.value<<8|t,3===n.frame){var e=n.index,i=n._pixels,r=n.value;e<i.length&&(i[e]=r,n.updated=!0),n.index++,n.frame=0}else n.frame++}}return(0,a.Z)(t,[{key:"update",value:function(){return this.updated?(this.updated=!1,this._pixels):null}},{key:"reset",value:function(){this._pixels.fill(0)}}]),t}(),x=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"apa102Decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.apa102Decoder=new C({data:i.get("DI"),clock:i.get("CI")},1)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.apa102Decoder.update();if(t){var e=t[0],i=(e>>>24)/255,n=e>>16&255,r=e>>8&255,a=255&e;return{value:{r:Math.pow(a/256*i,.5),g:Math.pow(r/256*i,.5),b:Math.pow(n/256*i,.5)}}}return null}},{key:"reset",value:function(){this.apa102Decoder.reset()}}]),t}();(0,s.Z)(x,"pinNames",["DI","CI","VCC","GND","DO","CO"]);var S=i(95315),_=i(70222),P=i(88409),D=i(13918),I=[128,133,134,135,136,137,145,146,147,148,149,150,164,165,188],A=new WeakMap,R=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"registers",void 0),(0,s.Z)(this,"addr",void 0),(0,_.Z)(this,A,{writable:!0,value:void 0}),(0,s.Z)(this,"clock",void 0),this.clock=e,this.registers=new Uint8Array(256),this.addr=0,(0,P.Z)(this,A,!1);var a=new D.A({scl:i.get("SCL"),sda:i.get("SDA")},56);this.reset(),a.onConnect=function(){return(0,P.Z)(n,A,!0),!0},a.onReadByte=function(){var t=n.registers[n.addr];return n.addr=(n.addr+1)%256,t},a.onWriteByte=function(t){if((0,S.Z)(n,A))return n.addr=t,(0,P.Z)(n,A,!1),!0;var e=n.addr;return I.includes(e)&&(n.registers[e]=t),n.addr=(n.addr+1)%256,!0}}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=t.touches.slice(0,2);this.registers[2]=e.length;for(var i=0;i<e.length;i++){var n=e[i],r=i?6:0,a=n.x,s=n.y,o="press"===n.eventType?0:"release"===n.eventType?1:2;this.registers[r+3]=o<<6|a>>8,this.registers[r+4]=255&a,this.registers[r+5]=i<<4|s>>8,this.registers[r+6]=255&s,this.registers[r+7]=Math.floor(255*n.force),this.registers[r+8]=128}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.addr=0,this.registers.fill(0);for(var t=3;t<=14;t++)this.registers[t]=255;this.registers[128]=40,this.registers[134]=1,this.registers[135]=10,this.registers[136]=8,this.registers[137]=40,this.registers[145]=10,this.registers[146]=25,this.registers[147]=25,this.registers[148]=25,this.registers[149]=25,this.registers[150]=50,this.registers[163]=6,this.registers[164]=1,this.registers[165]=0,this.registers[166]=16,this.registers[168]=17,this.registers[175]=1,this.registers[188]=1}}]),t}();(0,s.Z)(R,"pinNames",["VCC","GND","SCL","SDA","INT"]);var B,E=(B={},(0,s.Z)(B,38,1),(0,s.Z)(B,54,1),(0,s.Z)(B,193,1),(0,s.Z)(B,180,1),(0,s.Z)(B,197,2),(0,s.Z)(B,199,1),(0,s.Z)(B,58,1),(0,s.Z)(B,242,1),(0,s.Z)(B,192,2),(0,s.Z)(B,194,2),(0,s.Z)(B,195,2),(0,s.Z)(B,196,2),(0,s.Z)(B,182,2),(0,s.Z)(B,177,3),(0,s.Z)(B,178,3),(0,s.Z)(B,42,4),(0,s.Z)(B,43,4),(0,s.Z)(B,179,6),(0,s.Z)(B,45,9),(0,s.Z)(B,224,15),(0,s.Z)(B,225,15),B),U=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"width",240),(0,s.Z)(this,"height",320),(0,s.Z)(this,"pixels",new Uint16Array(this.height*this.width)),(0,s.Z)(this,"displayOn",!1),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"invert",!1),(0,s.Z)(this,"bgr",!1),(0,s.Z)(this,"activeColumn",0),(0,s.Z)(this,"activePage",0),(0,s.Z)(this,"columnStart",0),(0,s.Z)(this,"columnEnd",0),(0,s.Z)(this,"pageStart",0),(0,s.Z)(this,"pageEnd",0),(0,s.Z)(this,"scanningDirection",0),(0,s.Z)(this,"highByte",!0),(0,s.Z)(this,"highByteValue",0),(0,s.Z)(this,"commandMode",!1),(0,s.Z)(this,"commandProcessed",!1),(0,s.Z)(this,"currentCommandIndex",0),(0,s.Z)(this,"currentCommandLength",0),(0,s.Z)(this,"currentCommand",new Uint8Array(64));var a=i.get("D/C");this.reset(),new b({mosi:i.get("MOSI"),miso:i.get("MISO"),clk:i.attached("SCK")?i.get("SCK"):i.get("CLK"),ss:i.get("CS")}).onTransmit=function(t){return a.value?n.processData(t):n.processCommand(t,!0),0}}return(0,a.Z)(t,[{key:"update",value:function(){if(this.updated){this.updated=!1;var t=this;return{value:{pixels:t.pixels,invert:t.invert,bgr:t.bgr}}}return null}},{key:"snapshot",value:function(){this.update()}},{key:"value",get:function(){return""}},{key:"reset",value:function(){this.displayOn=!1,this.activeColumn=0,this.activePage=0,this.columnStart=0,this.columnEnd=239,this.pageStart=0,this.pageEnd=319}},{key:"processCommand",value:function(t,e){if(e&&(this.currentCommandIndex&&!this.commandProcessed&&console.warn("Unknown ILI9341 Command",this.currentCommand[0].toString(16),this.currentCommand.slice(1,this.currentCommandIndex)),this.commandMode=!0,this.commandProcessed=!1,this.currentCommandIndex=0,this.currentCommandLength=1+(E[t]||0)),this.currentCommand[this.currentCommandIndex]=t,this.currentCommandIndex++,!(this.currentCommandIndex<this.currentCommandLength||this.commandProcessed)){var i=this.currentCommand[0];this.commandProcessed=!0;var n=!1;switch(i){case 0:case 192:case 1:case 58:case 197:break;case 16:case 40:this.displayOn=!1,n=!0;break;case 17:case 41:this.displayOn=!0,n=!0;break;case 32:this.invert=!1,n=!0;break;case 33:this.invert=!0,n=!0;break;case 44:this.commandMode=!1,this.highByte=!0;break;case 54:this.bgr=!!(8&this.currentCommand[1]),this.scanningDirection=252&this.currentCommand[1];break;case 42:case 43:var r=this.currentCommand[1]<<8|this.currentCommand[2],a=this.currentCommand[3]<<8|this.currentCommand[4],s=43===i;(32&this.scanningDirection?!s:s)?(this.activePage=r,this.pageStart=r,this.pageEnd=a):(this.activeColumn=r,this.columnStart=r,this.columnEnd=a);break;default:this.commandProcessed=!1}n&&this.displayOn&&(this.updated=!0)}}},{key:"processData",value:function(t){if(this.commandMode)this.processCommand(t,!1);else{if(this.highByte)return this.highByte=!1,void(this.highByteValue=t);var e=this.highByteValue<<8|t,i=this.activeColumn,n=this.activePage,r=!!(128&this.scanningDirection)!==!!(4&this.scanningDirection),a=!!(64&this.scanningDirection)===!!(4&this.scanningDirection);32&this.scanningDirection?(i=r?this.width-1-i:i,n=a?this.height-1-n:n):(i=a?this.width-1-i:i,n=r?this.height-1-n:n);var s=n*this.width+i;this.pixels[s]=e,32&this.scanningDirection?(this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart))):(this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart))),this.updated=!0,this.highByte=!0}}}]),t}();(0,s.Z)(U,"pinNames",["D/C","CS","SCK","MOSI","MISO"]);var N=function(){function t(e,i,n){var a,o=this;(0,r.Z)(this,t),(0,s.Z)(this,"frameNanos",void 0),(0,s.Z)(this,"subframeNanos",void 0),(0,s.Z)(this,"updateTime",void 0),(0,s.Z)(this,"lastState",void 0),(0,s.Z)(this,"subframe",void 0),(0,s.Z)(this,"subframes",void 0),(0,s.Z)(this,"subframesIndex",void 0),(0,s.Z)(this,"onTime",void 0),(0,s.Z)(this,"listener",void 0),(0,s.Z)(this,"gamma",void 0),(0,s.Z)(this,"prevValue",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updateTime=0,this.lastState=0,this.subframe=0,this.subframes=new Float64Array(8),this.subframesIndex=0,this.onTime=0,this.prevValue=null;var u,l=parseFloat(null!==(a=null===n||void 0===n?void 0:n.get("fps"))&&void 0!==a?a:""),c=l>.1?l:80;this.frameNanos=Math.floor(1e9/(c/8)),this.subframeNanos=Math.floor(this.frameNanos/8),this.subframe=Math.floor(e.cpuNanos/this.frameNanos);var d=parseFloat(null!==(u=null===n||void 0===n?void 0:n.get("gamma"))&&void 0!==u?u:"");this.gamma=d>.1?d:2.8;var h=i.get("A"),v=i.get("C");if(h&&v){this.listener=function(){var t=e.cpuNanos,i=o.subframes,n=o.updateTime,r=o.lastState,a=o.subframeNanos,s=Math.floor(t/a),u=s-o.subframe;if(u){if(u<i.length){r&&(o.onTime+=a-n%a);for(var l=o.onTime/a,c=0;c<u;c++)i[o.subframesIndex]=0==c?l:o.lastState,o.subframesIndex=(o.subframesIndex+1)%i.length}else i.fill(r?1:0);o.onTime=r?a-n%a:0}else r&&(o.onTime+=t-n);o.subframe=s,o.lastState=function(){var t=h.value?1:0,e=v.value?0:1;return h.driven&&v.driven?t*e:0}(),o.updateTime=e.cpuNanos},this.listener(),h.onStateChange(this.listener),v.onStateChange(this.listener)}}return(0,a.Z)(t,[{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this,i=e.updateTime,n=e.frameNanos,r=this.clock.cpuNanos-i,a=this.lastState;if(r<n){var s,o,u=this.subframes;null===(o=(s=this).listener)||void 0===o||o.call(s),a=u.reduce((function(t,e){return t+e}))/u.length}var l=Math.pow(a,1/this.gamma);if(this.prevValue!==l){var c={value:l};return this.prevValue=l,c}return t?{value:this.lastState}:null}},{key:"reset",value:function(){this.lastState=0}}]),t}();(0,s.Z)(N,"pinNames",["A","C"]);var T,O=(T={},(0,s.Z)(T,129,1),(0,s.Z)(T,38,6),(0,s.Z)(T,39,6),(0,s.Z)(T,41,5),(0,s.Z)(T,42,5),(0,s.Z)(T,163,2),(0,s.Z)(T,32,1),(0,s.Z)(T,33,2),(0,s.Z)(T,34,2),(0,s.Z)(T,168,1),(0,s.Z)(T,211,1),(0,s.Z)(T,218,1),(0,s.Z)(T,213,1),(0,s.Z)(T,217,1),(0,s.Z)(T,219,1),(0,s.Z)(T,141,1),T),M={0:5,1:64,2:128,3:256,4:3,5:4,6:25,7:2},V=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"width",void 0),(0,s.Z)(this,"height",void 0),(0,s.Z)(this,"pixels",void 0),(0,s.Z)(this,"displayOn",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"scrollActive",void 0),(0,s.Z)(this,"contrast",void 0),(0,s.Z)(this,"invert",void 0),(0,s.Z)(this,"reverseRows",void 0),(0,s.Z)(this,"segmentRemap",void 0),(0,s.Z)(this,"clockDivider",void 0),(0,s.Z)(this,"multiplexRatio",void 0),(0,s.Z)(this,"phase1",void 0),(0,s.Z)(this,"phase2",void 0),(0,s.Z)(this,"nextScrollTime",void 0),(0,s.Z)(this,"activeColumn",void 0),(0,s.Z)(this,"columnStart",void 0),(0,s.Z)(this,"columnEnd",void 0),(0,s.Z)(this,"activePage",void 0),(0,s.Z)(this,"pageStart",void 0),(0,s.Z)(this,"pageEnd",void 0),(0,s.Z)(this,"memoryMode",void 0),(0,s.Z)(this,"startLine",void 0),(0,s.Z)(this,"scrollRight",void 0),(0,s.Z)(this,"scrollVertical",void 0),(0,s.Z)(this,"scrollStartPage",void 0),(0,s.Z)(this,"scrollEndPage",void 0),(0,s.Z)(this,"scrollSpeed",void 0),(0,s.Z)(this,"verticalOffset",void 0),(0,s.Z)(this,"scrollOffset",void 0),(0,s.Z)(this,"controlByte",void 0),(0,s.Z)(this,"continuousMode",void 0),(0,s.Z)(this,"commandMode",void 0),(0,s.Z)(this,"currentCommandIndex",void 0),(0,s.Z)(this,"currentCommandLength",void 0),(0,s.Z)(this,"currentCommand",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.width=128,this.height=64,this.pixels=new Uint8Array(this.width*this.height/8),this.displayOn=!1,this.updated=!1,this.scrollActive=!1,this.contrast=0,this.invert=!1,this.reverseRows=!1,this.segmentRemap=!1,this.clockDivider=0,this.multiplexRatio=0,this.phase1=0,this.phase2=0,this.nextScrollTime=0,this.activeColumn=0,this.columnStart=0,this.columnEnd=0,this.activePage=0,this.pageStart=0,this.pageEnd=0,this.memoryMode=0,this.startLine=0,this.scrollRight=!1,this.scrollVertical=!1,this.scrollStartPage=0,this.scrollEndPage=0,this.scrollSpeed=0,this.verticalOffset=0,this.scrollOffset=0,this.controlByte=!0,this.continuousMode=!0,this.commandMode=!1,this.currentCommandIndex=0,this.currentCommandLength=0,this.currentCommand=new Uint8Array(8);var a=60|(i.attached("SA0")&&i.get("SA0").value?1:0),o=parseInt(n.get("ssd1306-address")||n.get("i2c-address")||"0",16)||a;new D.A({scl:i.attached("SCL")?i.get("SCL"):i.get("CLK"),sda:i.attached("SDA")?i.get("SDA"):i.get("DATA")},o).setHandler(this),this.reset(),this.snapshot()}return(0,a.Z)(t,[{key:"update",value:function(){if(this.scrollActive&&this.clock.cpuMillis>this.nextScrollTime&&(this.scroll(),this.calculateNextScroll()),this.updated){this.updated=!1;var t=this;return{value:{pixels:t.pixels,invert:t.invert,displayOn:t.displayOn,reverseRows:t.reverseRows,contrast:t.contrast,scrollOffset:t.scrollOffset,startLine:t.startLine}}}return null}},{key:"toImageData",value:function(t){for(var e=this,i=e.pixels,n=e.invert,r=e.displayOn,a=e.reverseRows,s=e.scrollOffset,o=e.width,u=e.height,l=t.data,c=0;c<u;c++)for(var d=0;d<o;d++){var h=c+s,v=(a?u-1-h:h)%u,f=i[Math.floor(v/8)*o+d]&1<<v%8?!n:n,p=4*(c*t.width+d);l.fill(f?255:0,p,p+3),l[p+3]=r?255:0}}},{key:"snapshot",value:function(){this.update()}},{key:"value",get:function(){return""}},{key:"reset",value:function(){this.memoryMode=2,this.contrast=127,this.clockDivider=1,this.multiplexRatio=63,this.phase1=2,this.phase2=2,this.scrollActive=!1,this.currentCommandIndex=0,this.activeColumn=0,this.columnStart=0,this.columnEnd=127,this.activePage=0,this.pageStart=0,this.pageEnd=7,this.startLine=0,this.invert=!1}},{key:"i2cConnect",value:function(){return this.controlByte=!0,!0}},{key:"i2cReadByte",value:function(){return 255}},{key:"i2cWriteByte",value:function(t){return this.controlByte?(this.commandMode=!(64&t),this.continuousMode=!(128&t),this.controlByte=!1):(this.commandMode?this.processCommand(t):this.processData(t),this.continuousMode||(this.controlByte=!0)),!0}},{key:"processCommand",value:function(t){if(this.currentCommand[this.currentCommandIndex]=t,this.currentCommandIndex||(this.currentCommandLength=1+(O[t]||0)),this.currentCommandIndex++,!(this.currentCommandIndex<this.currentCommandLength)){var e=this.currentCommand[0],i=!1;switch(e){case 129:this.contrast=this.currentCommand[1],i=!0;break;case 174:this.displayOn=!1,this.updated=!0;break;case 175:this.displayOn=!0,this.updated=!0;break;case 166:this.invert=!1,i=!0;break;case 167:this.invert=!0,i=!0;break;case 227:case 141:case 211:case 168:case 218:case 219:case 163:case 165:case 164:break;case 32:this.memoryMode=3&this.currentCommand[1];break;case 33:this.columnStart=127&this.currentCommand[1],this.columnEnd=127&this.currentCommand[2],this.activeColumn=this.columnStart;break;case 34:this.pageStart=7&this.currentCommand[1],this.pageEnd=7&this.currentCommand[2],this.activePage=this.pageStart;break;case 46:this.scrollOffset=0,this.scrollActive=!1;break;case 47:this.scrollActive=!0,this.calculateNextScroll();break;case 38:case 39:this.scrollVertical=!1,this.scrollRight=38===e,this.scrollStartPage=7&this.currentCommand[2],this.scrollSpeed=7&this.currentCommand[3],this.scrollEndPage=7&this.currentCommand[4];break;case 41:case 42:this.scrollRight=41===e,this.scrollStartPage=7&this.currentCommand[2],this.scrollSpeed=7&this.currentCommand[3],this.scrollEndPage=7&this.currentCommand[4],this.verticalOffset=63&this.currentCommand[5],this.scrollVertical=this.verticalOffset>0;break;case 213:this.clockDivider=1+(15&this.currentCommand[1]);break;case 217:this.phase1=15&this.currentCommand[1],this.phase2=this.currentCommand[1]>>4&15;break;case 192:this.reverseRows=!0,i=!0;break;case 200:this.reverseRows=!1,i=!0;break;case 160:this.segmentRemap=!1;break;case 161:this.segmentRemap=!0;break;default:if(e<=15){this.activeColumn=240&this.activeColumn|e;break}if(e>=16&&e<=31){this.activeColumn=15&this.activeColumn|(15&e)<<4;break}if(e>=64&&e<=127){this.startLine=63&e,i=!0;break}if(e>=176&&e<=183){this.activePage=7&e;break}console.warn("Unknown SSD1306 Command",e.toString(16),this.currentCommand.slice(1,this.currentCommandIndex))}i&&this.displayOn&&(this.updated=!0),this.currentCommandIndex=0}}},{key:"processData",value:function(t){var e=this.segmentRemap?this.activeColumn:this.width-1-this.activeColumn,i=this.activePage*this.width+e;switch(this.pixels[i]=t,this.memoryMode){case 0:this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart));break;case 1:this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart));break;default:this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart)}this.updated=!0}},{key:"i2cDisconnect",value:function(){}},{key:"scroll",value:function(){for(var t=this.width,e=this.scrollStartPage;e<=this.scrollEndPage;e++){var i=e*t;if(this.scrollRight){var n=this.pixels[i+t-1];this.pixels.set(this.pixels.slice(i,i+t-1),i+1),this.pixels[i]=n}else{var r=this.pixels[i];this.pixels.set(this.pixels.slice(i+1,i+t),i),this.pixels[i+t-1]=r}this.updated=!0}this.scrollVertical&&(this.scrollOffset=(this.scrollOffset+this.verticalOffset)%this.height)}},{key:"scrollFrameTime",get:function(){return 1e3*M[this.scrollSpeed]/this.frameFrequency}},{key:"calculateNextScroll",value:function(){this.nextScrollTime=this.clock.cpuMillis+this.scrollFrameTime}},{key:"frameFrequency",get:function(){var t=this.phase1+this.phase2+50;return 37e4/(this.clockDivider*t*(1+this.multiplexRatio))}}]),t}();(0,s.Z)(V,"pinNames",["CLK","DATA","SCL","SDA","SA1"]);var L=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"_pixels",void 0),(0,s.Z)(this,"pixelIndex",void 0),(0,s.Z)(this,"currentValue",void 0),(0,s.Z)(this,"bitIndex",void 0),(0,s.Z)(this,"lastState",void 0),(0,s.Z)(this,"lastTimestamp",void 0),(0,s.Z)(this,"detectZero",void 0),(0,s.Z)(this,"detectOne",void 0),(0,s.Z)(this,"overflow",void 0),(0,s.Z)(this,"pendingUpdate",void 0),(0,s.Z)(this,"lastUpdated",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"listeners",void 0),(0,s.Z)(this,"clock",void 0),this.clock=i,this._pixels=new Uint32Array(1),this.pixelIndex=0,this.currentValue=0,this.bitIndex=0,this.lastState=!1,this.lastTimestamp=0,this.detectZero=!1,this.detectOne=!1,this.overflow=!1,this.pendingUpdate=!1,this.lastUpdated=0,this.updated=!1,this.listeners=new Set,e.onValueChange((function(t){var e=i.cpuNanos-a.lastTimestamp;!a.overflow&&a.lastState&&(e>=170&&e<=630&&(a.detectZero=!0),e>=570&&e<=1030&&(a.detectOne=!0),a.checkLastBit()),a.lastState||(a.detectZero&&e>=620?a.feedBit(0):a.detectOne&&e>=220&&a.feedBit(1),e>=5e4&&a.resetState(),a.detectZero=!1,a.detectOne=!1),a.overflow&&n&&n.setState(t?Z.J.High:Z.J.Low),a.lastState=t,a.lastTimestamp=i.cpuNanos}))}return(0,a.Z)(t,[{key:"checkLastBit",value:function(){23===this.bitIndex&&(this._pixels[this.pixelIndex]=this.currentValue|(this.detectOne?1:0),this.pendingUpdate=!0)}},{key:"feedBit",value:function(t){if(t&&(this.currentValue|=1<<23-this.bitIndex),this.bitIndex++,24===this.bitIndex&&(this._pixels[this.pixelIndex++]=this.currentValue,this.pendingUpdate=!0,this.bitIndex=0,this.currentValue=0),this.pixelIndex>=this.pixels.length){this.overflow=!0;var e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(this._pixels)}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}},{key:"resetState",value:function(){this.detectZero=!1,this.detectOne=!1,this.overflow=!1,this.bitIndex=0,this.currentValue=0,this.pixelIndex=0}},{key:"reset",value:function(){this.resetState(),this.pendingUpdate=!1,this.lastUpdated=0,this.updated=!1}},{key:"update",value:function(){if(this.lastUpdated<this.clock.cpuNanos&&(this.lastUpdated=this.clock.cpuNanos,this.updated=this.pendingUpdate,this.pendingUpdate)){var t=this.clock.cpuNanos-this.lastTimestamp;!this.overflow&&23===this.bitIndex&&this.detectZero&&!this.lastState&&t>=620&&(this._pixels[this.pixelIndex]=this.currentValue),this.pendingUpdate=!1}return this.updated?this._pixels:null}},{key:"resize",value:function(t){if(this._pixels.length<t){var e=new Uint32Array(t);e.set(this._pixels),this._pixels=e}}},{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"pixels",get:function(){return this._pixels}}]),t}(),F=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.attached("DO")?i.get("DO"):void 0;this.decoder=new L(i.get("DI"),e,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.decoder.update();if(t){var e=t[0],i=(255&e)/255,n=(e>>8&255)/255,r=(e>>16&255)/255;return{value:{r:Math.pow(n,.5),g:Math.pow(r,.5),b:Math.pow(i,.5)}}}return null}},{key:"reset",value:function(){this.decoder.reset()}}]),t}();(0,s.Z)(F,"pinNames",["DI","VCC","DO"]);var J,K=i(8371),W=i(35154),H=i(80450);!function(t){t[t.Idle=0]="Idle",t[t.SetWriteCount=1]="SetWriteCount",t[t.SetReadCount=2]="SetReadCount",t[t.Write=3]="Write",t[t.GetReadAvailable=4]="GetReadAvailable",t[t.GetReadLength=5]="GetReadLength",t[t.Read=6]="Read"}(J||(J={}));var q=function(){function t(e,i,n,a){var o=this;(0,r.Z)(this,t),(0,s.Z)(this,"rx",void 0),(0,s.Z)(this,"tx",void 0),(0,s.Z)(this,"i2c",void 0),(0,s.Z)(this,"rxBuf",void 0),(0,s.Z)(this,"rxBufIdx",void 0),(0,s.Z)(this,"txQueue",void 0),(0,s.Z)(this,"i2cMode",void 0),(0,s.Z)(this,"i2cState",void 0),(0,s.Z)(this,"i2cWriteCount",void 0),(0,s.Z)(this,"i2cReadCount",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"vars",void 0),this.clock=e,this.vars=a,this.rxBuf=new Uint8Array(1024),this.rxBufIdx=0,this.txQueue=[],this.i2cMode=!1,this.i2cState=J.Idle,this.i2cWriteCount=0,this.i2cReadCount=0,this.rx=new W.g(e,i.get("RX_P"),9600),this.tx=new H.x(e,i.get("TX_P"),9600),this.i2c=new D.A({scl:i.get("SCL_P"),sda:i.get("SDA_P")},23),this.rx.subscribe((function(t){o.i2cMode=!1;var e=!0,i=!1,n=void 0;try{for(var r,a=t[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;o.onRxByte(s)}}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}})),this.tx.onTxComplete=function(){var t=o.txQueue.shift();null!=t&&o.tx.transmit(t)},this.i2c.onConnect=function(t,e){return o.i2cMode=!0,e?(o.i2cState=J.SetWriteCount,o.i2cReadCount=0):o.i2cState=J.GetReadAvailable,!0},this.i2c.onWriteByte=function(t){switch(o.i2cState){case J.SetWriteCount:return o.i2cWriteCount=t,o.i2cState=t?J.Write:J.SetReadCount,!0;case J.SetReadCount:return o.i2cReadCount=t,o.i2cState=J.Idle,!0;case J.Write:return!!o.i2cWriteCount&&(o.onRxByte(t),o.i2cWriteCount--,!0);default:return!1}},this.i2c.onReadByte=function(){switch(o.i2cState){case J.GetReadAvailable:return o.i2cState=J.GetReadLength,(0,K.u)(o.txQueue.length-o.i2cReadCount,0,253);case J.GetReadLength:return o.i2cState=J.Read,o.i2cReadCount;case J.Read:var t;return o.i2cReadCount?(o.i2cReadCount--,null!==(t=o.txQueue.shift())&&void 0!==t?t:0):0;default:return 0}}}return(0,a.Z)(t,[{key:"onRxByte",value:function(t){if(10===t){if(!this.rxBufIdx)return;var e=(new TextDecoder).decode(this.rxBuf.subarray(0,this.rxBufIdx));this.processCommand(e),this.rxBufIdx=0}else this.rxBufIdx<this.rxBuf.length&&(this.rxBuf[this.rxBufIdx++]=t)}},{key:"sendResponse",value:function(t){var e,i,n=(new TextEncoder).encode(t);this.i2cMode||this.tx.isBusy?(e=this.txQueue).push.apply(e,(0,d.Z)(n)):(this.tx.transmit(n[0]),(i=this.txQueue).push.apply(i,(0,d.Z)(n.subarray(1))))}},{key:"processCommand",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var n,r,a;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch("https://wokwi.com/api/external/blues?r=".concat(encodeURIComponent(t)));case 2:return n=i.sent,i.next=5,n.json();case 5:r=i.sent,a="string"===typeof r?r:JSON.stringify(r),e.sendResponse(a+"\r\n");case 8:case"end":return i.stop()}}),i)})))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.rxBufIdx=0,this.txQueue.splice(0,this.txQueue.length)}}]),t}();(0,s.Z)(q,"pinNames",["VCC","GND","RX_P","TX_P","SCL_P","SDA_P"]);var G=i(1965),z=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e}return(0,a.Z)(t,[{key:"nanos",get:function(){return this.clock.cpuNanos}},{key:"schedule",value:function(t,e){return this.clock.addEvent(e,t),t}},{key:"unschedule",value:function(t){return this.clock.createEvent(t).unschedule(),!0}}]),t}(),X=i(28467),j=i(98561),Q=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"esp32",void 0),(0,s.Z)(this,"next",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"pins",void 0),this.clock=e,this.pins=i,this.next=function(){var t=n.esp32.cores[0];t.idle&&!t.nextInterrupt||t.runInstruction(),n.clock.addEvent(100,n.next)}}return(0,a.Z)(t,[{key:"init",value:function(e){var r=e.wifi,a=this;return(0,n.Z)(f().mark((function e(){var n,s,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.e(3421).then(i.bind(i,53421)),t.snapshotPromise||(t.snapshotPromise=t.downloadAT()),e.next=4,n;case 4:return s=e.sent.ESP32C3,o=new s({flashSizeMB:4,clock:new z(a.clock)}),e.t0=a,e.t1=o,e.next=10,t.snapshotPromise;case 10:e.t2=e.sent,e.t0.loadSnapshot.call(e.t0,e.t1,e.t2),a.initUart(o),a.initWiFi(o,r),a.initNVS(o),a.esp32=o,a.clock.addEvent(100,a.next);case 17:case"end":return e.stop()}}),e)})))()}},{key:"initUart",value:function(t){t.uart[0].onTX=function(){t.uart[0].txComplete()};var e=new H.x(this.clock,this.pins.get("U0TXD")),i=new W.g(this.clock,this.pins.get("U0RXD")),n=t.uart[1];e.baudRate=115200,i.baudRate=115200,n.onTX=function(t){e.transmit(t)},e.onTxComplete=function(){return n.txComplete()},i.subscribe((function(t){n.feedByte(t[0])}))}},{key:"initWiFi",value:function(t,e){var i=this,n=t.wifi;t.wifi.setMacAddress(new G.o("24:0a:c4:00:01:10").bytes),n.onTX=function(n){var r=t.wifi.channel;i.clock.addEvent(1e5,(function(){e.medium.transmit({channel:r,data:n})}))},e.medium.listen((function(t){n.sendFrame(t.data,(0,j.a)())}))}},{key:"initNVS",value:function(t){var e=65536;t.flash.fill(255,e,122880),t.flash.set([252,255,255,255,0,0,0,0,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,132,45,186,185,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,1,255,113,211,175,4,110,118,115,46,110,101,116,56,48,50,49,49,0,0,0,0,1,255,255,255,255,255,255,255,1,1,1,255,61,2,179,83,111,112,109,111,100,101,0,0,0,0,0,0,0,0,0,0,1],e)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}},{key:"loadSnapshot",value:function(t,e){var i=new X.B(e);if("WOKWI SNAPSHOT\r\n"!==i.readChars(16))throw new Error("Invalid data");var n=i.readUint32();if(n>=65536)throw new Error("Invalid data");var r=JSON.parse(i.readChars(n));if(1!==r.v)throw new Error("Invalid version");if(r.chip!==t.id)throw new Error("Incompatible MCU");for(;i.currentOffset<e.byteLength;){var a=i.readUint32(),s=i.readUint32(),o=i.readUint32();i.readUint32();var u=i.readChars(s),l=i.readBytes(o);switch(u){case"ROM":t.loadROM(l);break;case"FLASH":t.flash.set(l,a);break;case"SRAM":t.sram.data.set(l,a);break;case"IRAM":t.iramCache.data.set(l,a);break;case"MMU":t.mmuTableMemory.data.set(l);break;case"CORE":t.cores[a].restoreState(new Uint32Array(new Uint8Array(l).buffer))}}}}],[{key:"downloadAT",value:function(){return(0,n.Z)(f().mark((function t(){var e;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://wokwi.github.io/firmware-assets/esp-at/esp32-c3-at-2.3.0.0.wokwi");case 2:return e=t.sent,t.t0=Uint8Array,t.next=6,e.arrayBuffer();case 6:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 8:case"end":return t.stop()}}),t)})))()}}]),t}();(0,s.Z)(Q,"pinNames",["GND","U0TXD","GPIO2","CH_EN","GPIO0","RESET","U0RXD","VCC"]),(0,s.Z)(Q,"snapshotPromise",void 0);var $={"0603":N,apa102:x,ws2812:F},Y={ssd1306:V,ili9341:U},tt={ft6206:R};function et(t,e){var i,o=function(t,i){var n=new Map,r=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value,d=l.name,h=l.target,v=(0,c.Z)(h.split(":"),2),f=v[0],p=v[1];f===i&&p&&n.set(p,d)}}catch(g){a=!0,s=g}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}return{get:function(e){var r;return t.get(null!==(r=n.get(e))&&void 0!==r?r:"".concat(i,":").concat(e))},attached:function(e){var i=n.get(e);return!!i&&t.attached(i)}}};return i=function(){function e(i,n,a,u){(0,r.Z)(this,e),(0,s.Z)(this,"controllers",void 0),(0,s.Z)(this,"values",void 0),(0,s.Z)(this,"clock",void 0),this.clock=i,this.controllers=[],this.values={};var l,c,d=new Map,h=!0,v=!1,f=void 0;try{for(var p,g=this,m=function(t,e){var i=e.value,r={get:function(t){var e;return n.get(null!==(e=i.pins[t])&&void 0!==e?e:"".concat(i.id,":").concat(t))},attached:function(t){var e=i.pins[t];return!!e&&n.attached(e)}},a=$[i.type];if(!a)return"continue";g.controllers.push({id:i.id,controller:new a(g.clock,r,d,u)})},y=(null!==(l=t.leds)&&void 0!==l?l:[])[Symbol.iterator]();!(h=(p=y.next()).done);h=!0)m(0,p)}catch(M){v=!0,f=M}finally{try{h||null==y.return||y.return()}finally{if(v)throw f}}var w,k=!0,Z=!1,b=void 0;try{for(var C,x=(null!==(c=t.chips)&&void 0!==c?c:[])[Symbol.iterator]();!(k=(C=x.next()).done);k=!0){var S=C.value;switch(S.type){case"blues-notecard":var _=o(n,S.id);this.controllers.push({id:S.id,controller:new q(this.clock,_,d,u)});break;case"esp-01":var P=o(n,S.id);this.controllers.push({id:S.id,controller:new Q(this.clock,P)})}}}catch(M){Z=!0,b=M}finally{try{k||null==x.return||x.return()}finally{if(Z)throw b}}var D=!0,I=!1,A=void 0;try{for(var R,B=(null!==(w=t.displays)&&void 0!==w?w:[])[Symbol.iterator]();!(D=(R=B.next()).done);D=!0){var E=R.value,U=Y[E.chip];if(U){var N=new U(i,o(n,E.id),a,u);if(this.controllers.push({id:E.id,controller:N}),E.touch){var T=tt[E.touch.chip];if(!T)continue;var O=new T(i,o(n,E.touch.id),d,u);this.controllers.push({id:E.touch.id,controller:O})}}}}catch(M){I=!0,A=M}finally{try{D||null==B.return||B.return()}finally{if(I)throw A}}}return(0,a.Z)(e,[{key:"onEvent",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s,o=r.value,u=o.id,l=o.controller;if(u===t.id)null===(s=l.onEvent)||void 0===s||s.call(l,t)}}catch(c){i=!0,n=c}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"init",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Promise.all(e.controllers.map((function(e){var i,n=e.controller;return null===(i=n.init)||void 0===i?void 0:i.call(n,t)})));case 2:case"end":return i.stop()}}),i)})))()}},{key:"update",value:function(){var t=!1,e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value,o=s.id,u=s.controller.update();u&&(this.values[o]=u.value,t=!0)}}catch(l){i=!0,n=l}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}return t?{value:this.values}:null}},{key:"reset",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.controller.reset(t)}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}]),e}(),(0,s.Z)(i,"pinNames",Object.keys(t.pins)),i}function it(t){switch(t){case"esp32":case"esp32-c3":case"esp32-s2":case"esp32-s3":case"rp2040":case"stm32f103c8":case"stm32l432kc":return t;default:return"avr"}}function nt(t){return"GND"===t?y.bq:t.startsWith("power(")?{type:"power",voltage:parseFloat(t.split(/[()]/)[1])}:t}function rt(t,e,i){var n=(0,m.Qc)(e),r=[],a=!0,s=!1,u=void 0;try{for(var l,d=Object.entries(n.pins)[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var h=(0,c.Z)(l.value,2),v=h[0],f=h[1].target;if("string"===typeof f)r.push({name:v,target:f});else if((0,o.Z)(f,Array))for(var p=0;p<f.length;p++)r.push({name:v,target:f[p]})}}catch(Z){s=!0,u=Z}finally{try{a||null==d.return||d.return()}finally{if(s)throw u}}if(n.mcu){var g;y.tj[t]={name:n.name,mcuType:it(n.mcu),hexiBoard:function(t){var e,i,r;return null!==(r=null===(e=n.environments)||void 0===e||null===(i=e[t])||void 0===i?void 0:i.fqbn)&&void 0!==r?r:n.fqbn},pins:r.map((function(t){return{name:t.name,target:nt(t.target)}})),environments:null!==(g=n.environments)&&void 0!==g?g:{}},y.dH.push(t)}var w=i.startsWith("https://")?i:URL.createObjectURL(new Blob([i],{type:"image/svg+xml"}));return{board:n,svgURL:w,adapter:k(n),controller:et(n,r)}}var at=i(52736);function st(t,e,i){var n=e(t),r=function(){var r=e(t);r!==n&&(n=r,i(r))},a=!0,s=!1,o=void 0;try{for(var u,l=t[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.onValueChange(r)}}catch(c){s=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}i(n)}var ot={0:16,1:8,2:4,3:2,4:1,5:1,6:1,7:1},ut=[[1,1,0],[-1,1,1],[-1,-1,0],[1,-1,1]],lt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"stepIndex",void 0),(0,s.Z)(this,"microsteps",void 0),(0,s.Z)(this,"enable",void 0),(0,s.Z)(this,"amValue",void 0),(0,s.Z)(this,"apValue",void 0),(0,s.Z)(this,"bmValue",void 0),(0,s.Z)(this,"bpValue",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.stepIndex=8,this.microsteps=16,this.enable=!1,this.amValue=Z.J.Low,this.apValue=Z.J.Low,this.bmValue=Z.J.Low,this.bpValue=Z.J.Low;var a=i.get("1A"),o=i.get("1B"),u=i.get("2B"),l=i.get("2A"),d=i.get("MS1"),h=i.get("MS2"),v=i.get("MS3"),f=i.get("STEP"),p=i.get("DIR"),g=i.get("RESET"),m=i.get("SLEEP"),y=i.get("ENABLE");d.state=Z.J.PullDown,h.state=Z.J.PullDown,v.state=Z.J.PullDown,m.state=Z.J.PullUp,y.state=Z.J.PullDown;var w=function(){o.state=n.enable?n.amValue:Z.J.HighZ,a.state=n.enable?n.apValue:Z.J.HighZ,l.state=n.enable?n.bmValue:Z.J.HighZ,u.state=n.enable?n.bpValue:Z.J.HighZ},k=function(){var t=15&n.stepIndex,e=(0,c.Z)(ut[n.stepIndex>>4&3],3),i=e[0],r=e[1],a=e[2],s=a?t>3:t<12,o=a?t<12:t>3;n.apValue=i>=0?Z.J.High:Z.J.Low,n.amValue=s?i>=0?Z.J.Low:Z.J.High:n.apValue,n.bpValue=r>=0?Z.J.High:Z.J.Low,n.bmValue=o?r>=0?Z.J.Low:Z.J.High:n.bpValue};f.onValueChange((function(t){if(t){var e=p.value;n.stepIndex=(n.stepIndex+(e?n.microsteps:-n.microsteps)+64)%64,k(),w()}})),k(),st([g,m],(function(){return!g.value||!m.value}),(function(t){t&&n.home()})),st([g,m,y],(function(){return m.value&&g.value&&!y.value}),(function(t){n.enable=t,w()})),st([d,h,v],(function(){return(v.value?4:0)|(h.value?2:0)|(d.value?1:0)}),(function(t){n.microsteps=ot[t]}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"home",value:function(){this.stepIndex=8}},{key:"reset",value:function(){this.home()}}]),t}();(0,s.Z)(lt,"pinNames",["ENABLE","MS1","MS2","MS3","RESET","SLEEP","STEP","DIR","GND","VDD","1B","1A","2A","2B","GND","VMOT"]);var ct=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,r.Z)(this,t),(0,s.Z)(this,"connectedValue",void 0),(0,s.Z)(this,"pin1",void 0),(0,s.Z)(this,"pin2",void 0),this.pin1=e,this.pin2=i,this.connectedValue=!1,this.connectedValue=n}return(0,a.Z)(t,[{key:"connected",get:function(){return this.connectedValue},set:function(t){if(this.connectedValue!==t){var e=this.pin1,i=this.pin2;this.connectedValue=t,t?(e.node.bridges.add(i),i.node.bridges.add(e),e.node.updateBridges()):(e.node.bridges.delete(i),i.node.bridges.delete(e),e.node.updateBridges(),i.node.updateBridges())}}}]),t}(),dt=new WeakMap,ht=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"state",void 0),(0,_.Z)(this,dt,{writable:!0,value:void 0}),(0,s.Z)(this,"toggle",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"bridge",void 0),this.clock=e,this.bridge=i,this.state=!1,(0,P.Z)(this,dt,0),this.toggle=function(){n.bridge.connected=!n.bridge.connected}}return(0,a.Z)(t,[{key:"connected",get:function(){return this.state},set:function(t){if(t!==this.state)if(this.state=t,0!==this.clock.cpuNanos){for(var e=1+2*Math.floor(100*Math.random()),i=44e5/e,n=0,r=0;r<e;r++)n+=66+Math.round(Math.random()*(i-66)),this.clock.addEvent(n,this.toggle);(0,P.Z)(this,dt,n+66)}else this.bridge.connected=t}},{key:"bounceDuration",get:function(){return(0,S.Z)(this,dt)}}]),t}();function vt(t,e,i,n){var r=new ct(e,i);return n?new ht(t,r):r}var ft=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"bridge",void 0),(0,s.Z)(this,"horz",void 0),(0,s.Z)(this,"vert",void 0);var a=i.get("SEL"),o=i.get("GND"),u="0"!==n.get("bounce");this.vert=i.get("VERT"),this.horz=i.get("HORZ"),this.bridge=vt(e,a,o,u)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this.bridge;switch(t.type){case"press":e&&(e.connected=!0);break;case"release":e&&(e.connected=!1);break;case"change":this.horz.node.analogPort.writeNormalized(.5+t.x/2),this.vert.node.analogPort.writeNormalized(.5+t.y/2)}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(ft,"pinNames",["VCC","VERT","HORZ","SEL","GND"]);var pt=i(14116),gt=function(){function t(e,i,n){var a;(0,r.Z)(this,t),(0,s.Z)(this,"apa102Decoder",void 0),(0,s.Z)(this,"rows",void 0),(0,s.Z)(this,"cols",void 0),(0,s.Z)(this,"layout",void 0),(0,s.Z)(this,"brightness",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.rows=parseInt(n.get("rows")||"8",10)||8,this.cols=parseInt(n.get("cols")||"8",10)||8,this.layout=n.get("matrixLayout")||"";var o=parseFloat(null!==(a=n.get("matrixBrightness"))&&void 0!==a?a:"1");this.brightness=o>=.01?o:1;var u=this.rows*this.cols;this.apa102Decoder=new C({data:i.get("DI"),clock:i.get("CI")},u)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.apa102Decoder.update();return t?{value:{pixels:t.slice(0,this.rows*this.cols),rows:this.rows,cols:this.cols,brightness:this.brightness,layout:this.layout,colorFormat:pt.q.RGBA}}:null}},{key:"reset",value:function(){this.apa102Decoder.reset()}}]),t}();(0,s.Z)(gt,"pinNames",["DI","CI","VCC","GND","DO","CO"]);var mt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"led13Controller",void 0),(0,s.Z)(this,"rxController",void 0),(0,s.Z)(this,"txController",void 0),(0,s.Z)(this,"resetBridge",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={ledPower:1,ledRX:0,ledTX:0,led13:0};var n=new Map;n.set("A",i.get("13")),n.set("C",i.get("GND")),this.led13Controller=new N(this.clock,n);var a=new Map;a.set("A",i.get("5V")),a.set("C",i.get("0")),this.rxController=new N(this.clock,a);var o=new Map;o.set("A",i.get("5V")),o.set("C",i.get("1")),this.txController=new N(this.clock,o),this.resetBridge=vt(e,i.get("GND"),i.get("RESET"),!1)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){switch(t.type){case"reset-press":this.resetBridge.connected=!0;break;case"reset-release":this.resetBridge.connected=!1}}},{key:"update",value:function(){var t=this.led13Controller.update();t&&(this.value.led13=t.value,this.updated=!0);var e=this.txController.update();e&&(this.value.ledTX=e.value,this.updated=!0);var i=this.rxController.update();i&&(this.value.ledRX=i.value,this.updated=!0);var n=this.updated?{value:(0,u.Z)({},this.value)}:null;return this.updated=!1,n}},{key:"reset",value:function(t){this.led13Controller.reset(),this.txController.reset(),this.rxController.reset(),this.value.led13=0,this.value.ledRX=0,this.value.ledTX=0,t&&(this.value.ledPower=0),this.updated=!0}}]),t}();(0,s.Z)(mt,"pinNames",["0","1","13","GND","5V","RESET"]);var yt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"pinMap",void 0),this.pins=e,this.pinMap=i}return(0,a.Z)(t,[{key:"get",value:function(t){var e;return this.pins.get(null!==(e=this.pinMap[t])&&void 0!==e?e:t)}},{key:"attached",value:function(t){var e;return this.pins.attached(null!==(e=this.pinMap[t])&&void 0!==e?e:t)}}]),t}(),wt=49152,kt=Math.round(60000.00000000001);function Zt(t,e){var i=t<e?t:e,n=t>e?t:e,r=i+65536-n<n-i;return Math.round(r?(i+65536+n)/2:(i+n)/2)}function bt(t){return!isNaN(t)&&t>1e-9}var Ct=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"display",void 0),(0,s.Z)(this,"gearRatio",void 0),(0,s.Z)(this,"steps",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"toffset",void 0),(0,s.Z)(this,"nextDelta",void 0),(0,s.Z)(this,"changeTime",void 0),(0,s.Z)(this,"event",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.display="none",this.gearRatio=1,this.steps=0,this.updated=!0,this.toffset=Zt(0,wt),this.nextDelta=0,this.changeTime=-1,this.event=this.clock.createEvent((function(){return a.finishStep()}));var o,u=i.get("A-"),l=i.get("A+"),c=i.get("B-"),d=i.get("B+"),h=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=u.driven&&l.driven&&u.value!==l.value,n=c.driven&&d.driven&&c.value!==d.value,r=l.value?0:32768,s=d.value?16384:wt,o=i&&n?Zt(r,s):i?r:s;if(a.finishStep(),i||n){var h=a.toffset,v=o-h&65535,f=h-o&65535,p=v<f?v:-f;t?a.toffset=o:(a.nextDelta=p,a.changeTime=e.cpuNanos,a.event.schedule(kt))}},v=!0,f=!1,p=void 0;try{for(var g,m=[u,l,c,d][Symbol.iterator]();!(v=(g=m.next()).done);v=!0){g.value.onStateChange(h)}}catch(C){f=!0,p=C}finally{try{v||null==m.return||m.return()}finally{if(f)throw p}}h(!0);var y,w=null!==(o=n.get("display"))&&void 0!==o?o:"";switch(w){case"angle":this.display=w;break;case"steps":case"":this.display="steps";break;default:this.display="none"}var k=null!==(y=n.get("gearRatio"))&&void 0!==y?y:"";if(k.includes(":")){var Z=k.split(":").map((function(t){return parseFloat(t)}));bt(Z[0])&&bt(Z[1])&&(this.gearRatio=Z[1]/Z[0])}else{var b=parseFloat(k);bt(b)&&(this.gearRatio=b)}}return(0,a.Z)(t,[{key:"finishStep",value:function(){var t=this.nextDelta,e=this.changeTime;if(t){var i=this.clock.cpuNanos-e,n=Math.round(t*Math.min(i/kt,1));this.steps+=n/16384,this.toffset=this.toffset+n&65535,this.updated=!0,this.nextDelta-=n}}},{key:"update",value:function(){if(this.finishStep(),this.updated){var t=this.steps,e=t*this.gearRatio;return this.updated=!1,{value:{steps:t,angle:e/200*360%360,display:this.display}}}return null}},{key:"reset",value:function(){this.updated=!0}}]),t}();(0,s.Z)(Ct,"pinNames",["A-","A+","B-","B+"]);var xt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"stepper1",void 0),(0,s.Z)(this,"stepper2",void 0),(0,s.Z)(this,"value",{angle1:0,angle2:0});var n=new yt(i,{"A-":"A1-","A+":"A1+","B-":"B1-","B+":"B1+"});this.stepper1=new Ct(e,n,new Map);var a=new yt(i,{"A-":"A2-","A+":"A2+","B-":"B2-","B+":"B2+"});this.stepper2=new Ct(e,a,new Map)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.stepper1.update(),e=this.stepper2.update();return t&&(this.value.angle1=t.value.angle),e&&(this.value.angle2=null===e||void 0===e?void 0:e.value.angle),t||e?{value:this.value}:null}},{key:"reset",value:function(){this.stepper1.reset(),this.stepper2.reset()}}]),t}();(0,s.Z)(xt,"pinNames",["A1-","A1+","B1-","B1+","A2-","A2+","B2-","B2+"]);var St=function(){function t(e){var i=e.pin1,n=e.pin2,a=e.volume,o=e.clock,u=this;(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"context",new AudioContext),(0,s.Z)(this,"gainNode",this.context.createGain()),(0,s.Z)(this,"chunkBuffer",new AudioBuffer({length:this.context.sampleRate/10,numberOfChannels:1,sampleRate:this.context.sampleRate})),(0,s.Z)(this,"chunk",this.chunkBuffer.getChannelData(0)),(0,s.Z)(this,"node",null),(0,s.Z)(this,"prevValue",0),(0,s.Z)(this,"playedSamples",0),(0,s.Z)(this,"lastSample",0),(0,s.Z)(this,"active",!1),(0,s.Z)(this,"lastValue",!1),(0,s.Z)(this,"value",null),this.clock=o,this.gainNode.connect(this.context.destination),a>.01&&this.setVolume(a),this.prevValue=(null===i||void 0===i?void 0:i.value)!==!!(null===n||void 0===n?void 0:n.value)?1:0,null===i||void 0===i||i.onValueChange((function(){u.feed(i.value!==!!(null===n||void 0===n?void 0:n.value)?1:0)})),null===n||void 0===n||n.onValueChange((function(){u.feed(!!(null===i||void 0===i?void 0:i.value)!==n.value?1:0)}))}return(0,a.Z)(t,[{key:"setVolume",value:function(t){this.gainNode.gain.value=t}},{key:"feed",value:function(t){if(this.prevValue!==t){var e=this.clock.cpuNanos/1e9,i=this.context.sampleRate,n=Math.floor(e*i)-this.playedSamples;n-this.lastSample>i/20?(this.lastSample=n,n=0):this.lastSample=n,n>this.chunk.length&&(this.playedSamples+=this.chunk.length,this.node=new AudioBufferSourceNode(this.context,{buffer:this.chunkBuffer}),this.node.connect(this.gainNode),this.node.start(),n%=this.chunk.length,this.chunkBuffer=new AudioBuffer({length:i/10,numberOfChannels:1,sampleRate:i}),this.chunk=this.chunkBuffer.getChannelData(0),this.chunk.fill(this.prevValue,0,n)),this.chunk.fill(t,n),this.prevValue=t,this.active=!0}}},{key:"update",value:function(){var t=this.active;return this.active=!1,t!==this.lastValue?(this.lastValue=t,{playing:t}):null}},{key:"reset",value:function(){}},{key:"pause",value:function(){}},{key:"resume",value:function(){}}]),t}(),_t=function(){function t(e){var i=e.pin1,n=e.pin2,a=e.volume,o=e.clock,u=this;(0,r.Z)(this,t),(0,s.Z)(this,"context",new AudioContext),(0,s.Z)(this,"gainNode",this.context.createGain()),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"prevTime",0),(0,s.Z)(this,"lastTime",0),(0,s.Z)(this,"freq",0),(0,s.Z)(this,"prevFreq",0),(0,s.Z)(this,"oscillator",null),(0,s.Z)(this,"lastValue",null),(0,s.Z)(this,"playing",!1),(0,s.Z)(this,"value",null),this.clock=o,this.gainNode.connect(this.context.destination),a>.01&&this.setVolume(a),this.lastValue=(null===i||void 0===i?void 0:i.value)!==!!(null===n||void 0===n?void 0:n.value)?1:0,null===i||void 0===i||i.onValueChange((function(){u.feed(i.value!==!!(null===n||void 0===n?void 0:n.value)?1:0)})),null===n||void 0===n||n.onValueChange((function(){u.feed(!!(null===i||void 0===i?void 0:i.value)!==n.value?1:0)}))}return(0,a.Z)(t,[{key:"setVolume",value:function(t){this.gainNode.gain.value=t}},{key:"feed",value:function(t){if(t!==this.lastValue){this.lastValue=t;var e=this.clock.cpuNanos/1e9,i=Math.round(1/(e-this.prevTime));if(this.prevTime=this.lastTime,this.lastTime=e,i<20)this.oscillator&&(this.oscillator.stop(),this.oscillator=null);else{var n=Math.abs(i-this.freq),r=Math.abs(this.freq-this.prevFreq);this.prevFreq=this.freq,this.freq=i,n<10&&r<10&&(this.oscillator?this.oscillator.frequency.setValueAtTime(i,this.context.currentTime):(this.oscillator=new OscillatorNode(this.context,{type:"square",frequency:i}),this.oscillator.connect(this.gainNode),this.oscillator.start()))}}}},{key:"update",value:function(){var t=this.clock.cpuNanos/1e9;this.oscillator&&t-this.lastTime>.05&&this.oscillator&&(this.oscillator.stop(),this.oscillator=null);var e=this.lastTime>=0&&t-this.lastTime<.5;return this.playing!==e?(this.playing=e,{playing:e}):null}},{key:"reset",value:function(){this.pause(),this.freq=0,this.playing=!1,this.lastTime=0,this.lastValue=null}},{key:"pause",value:function(){this.oscillator?(this.freq=this.oscillator.frequency.value,this.oscillator.stop(),this.oscillator=null):this.freq=0}},{key:"resume",value:function(){this.freq&&!this.oscillator&&(this.oscillator=new OscillatorNode(this.context,{type:"square",frequency:this.freq}),this.oscillator.connect(this.gainNode),this.oscillator.start())}}]),t}(),Pt=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var a={clock:e,volume:parseFloat(n.get("volume")||"1"),pin1:i.get("1"),pin2:i.get("2")},o=n.get("mode");this.backend="accurate"===o?new St(a):new _t(a)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.backend.update();return t?{value:t}:null}},{key:"reset",value:function(){this.backend.reset()}},{key:"pause",value:function(){this.backend.pause()}},{key:"resume",value:function(){this.backend.resume()}}]),t}();(0,s.Z)(Pt,"pinNames",["1","2"]);var Dt=i(79207),It=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var a,o=i.get("CLK"),u=1e9/((0,Dt.Z)(null!==(a=n.get("frequency"))&&void 0!==a?a:"0")||1e4)/2,l=!1;o.state=Z.J.Low;var c=e.createEvent((function(){l=!l,o.state=l?Z.J.High:Z.J.Low,c.schedule(u)}));c.schedule(u)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(It,"pinNames",["CLK"]);var At=1e6,Rt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"pinIn",void 0),(0,s.Z)(this,"bridgeNO",void 0),(0,s.Z)(this,"bridgeNC",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.pinIn=i.get("IN");var a=i.get("NO"),o=i.get("NC"),u=i.get("COM");this.bridgeNO=vt(e,a,u,!1),this.bridgeNC=vt(e,o,u,!1);var l=e.createEvent((function(){n.pinIn.value?(n.bridgeNO.connected=!0,n.bridgeNC.connected=!1):(n.bridgeNO.connected=!1,n.bridgeNC.connected=!0)}));this.pinIn.onValueChange((function(){l.schedule(5*At),n.updated=!0}))}return(0,a.Z)(t,[{key:"reset",value:function(){}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{ledPower:1,led1:this.pinIn.value?1:0}}):null}}]),t}();(0,s.Z)(Rt,"pinNames",["IN","NO","NC","COM","VCC","GND"]);var Bt=new WeakMap,Et=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z.J.PullUp;(0,r.Z)(this,t),(0,_.Z)(this,Bt,{writable:!0,value:void 0}),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"pin",void 0),(0,s.Z)(this,"highState",void 0),this.clock=e,this.pin=i,this.highState=n,(0,P.Z)(this,Bt,!1)}return(0,a.Z)(t,[{key:"busy",get:function(){return(0,S.Z)(this,Bt)}},{key:"transmit",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this,n=this,r=n.clock,a=n.pin;(0,P.Z)(this,Bt,!0);var s=e,o=function(){a.setState(s?i.highState:Z.J.Low),s=!s;var e=t.shift();e?r.addEvent(e,o):(0,P.Z)(i,Bt,!1)};o()}}]),t}(),Ut=function(t,e){var i=Math.abs(Math.round(10*t)),n=Math.round(10*e);return[n>>8,255&n,(t<0?128:0)|i>>8,255&i]},Nt={DHT11:function(t,e){return[Math.floor(e),0,Math.floor(t),0]},DHT12:function(t,e){var i=t<0?128:0;return[Math.round(e),Math.round(10*e)%10,i|Math.round(t),Math.round(10*t)%10]},DHT21:Ut,DHT22:Ut},Tt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"temperature",void 0),(0,s.Z)(this,"humidity",void 0),(0,s.Z)(this,"lastTimestamp",void 0),(0,s.Z)(this,"type",void 0),(0,s.Z)(this,"pulseTransmitter",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.temperature=24,this.humidity=40,this.lastTimestamp=0,this.type="DHT22";var a=i.get("SDA");this.pulseTransmitter=new Et(e,a),a.setState(Z.J.PullUp),a.onValueChange((function(t){var i=e.cpuMillis-n.lastTimestamp;!n.pulseTransmitter.busy&&t&&i>=1&&i<=100&&n.transmit(),n.lastTimestamp=e.cpuMillis}))}return(0,a.Z)(t,[{key:"transmit",value:function(){if(this.pulseTransmitter){var t=Nt[this.type](this.temperature,this.humidity),e=255&t.reduce((function(t,e){return t+e}));t.push(e);var i=[3e4,8e4,8e4],n=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)for(var u=s.value,l=7;l>=0;l--){var c=!!(u&1<<l);i.push(5e4,c?7e4:27e3)}}catch(d){r=!0,a=d}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}i.push(5e4),this.pulseTransmitter.transmit(i)}}},{key:"onEvent",value:function(t){this.temperature=t.temperature,this.humidity=t.humidity}},{key:"reset",value:function(){this.lastTimestamp=0}},{key:"update",value:function(){return null}}]),t}();(0,s.Z)(Tt,"pinNames",["SDA"]);var Ot=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"bridges",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.bridges=[];for(var n=1;n<=8;n++){var a=i.get("".concat(n,"a")),o=i.get("".concat(n,"b"));this.bridges.push(new ct(a,o,!1))}}return(0,a.Z)(t,[{key:"onEvent",value:function(t){for(var e=this.bridges,i=0;i<e.length;i++)e[i].connected=!!t.values[i]}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Ot,"pinNames",["1a","1b","2a","2b","3a","3b","4a","4b","5a","5b","6a","6b","7a","7b","8a","8b"]);var Mt=function(t){return t/10<<4|t%10},Vt=function(t){return(15&t)+10*(t>>4)},Lt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"addr",void 0),(0,s.Z)(this,"isFirstByte",void 0),(0,s.Z)(this,"halted",void 0),(0,s.Z)(this,"nvram",void 0),(0,s.Z)(this,"lastDate",void 0),(0,s.Z)(this,"controlRegister",void 0),(0,s.Z)(this,"delta",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.addr=0,this.isFirstByte=!1,this.halted=!1,this.nvram=new Uint8Array(56),this.lastDate=new Date,this.controlRegister=3,this.delta=0,this.value=null,new D.A({scl:i.get("SCL"),sda:i.get("SDA")},104).setHandler(this)}return(0,a.Z)(t,[{key:"date",get:function(){return this.halted?this.lastDate:new Date((new Date).getTime()-this.delta)},set:function(t){this.lastDate=t,this.delta=(new Date).getTime()-t.getTime()}},{key:"readRegister",value:function(t){var e=this.date;switch(t){case 0:return Mt(e.getSeconds())|(this.halted?128:0);case 1:return Mt(e.getMinutes());case 2:return Mt(e.getHours());case 3:return e.getDay()+1;case 4:return Mt(e.getDate());case 5:return Mt(e.getMonth()+1);case 6:return Mt(e.getFullYear()-2e3);case 7:return this.controlRegister;default:return this.nvram[t-8]}}},{key:"writeRegister",value:function(t,e){var i=new Date(this.date);switch(t){case 0:return this.halted=!!(128&e),i.setSeconds(Vt(127&e)),void(this.date=i);case 1:return i.setMinutes(Vt(e)),void(this.date=i);case 2:return i.setHours(Vt(e)),void(this.date=i);case 3:return;case 4:return i.setDate(Vt(e)),void(this.date=i);case 5:return i.setMonth(Vt(e)-1),void(this.date=i);case 6:return i.setFullYear(2e3+Vt(e)),void(this.date=i);case 7:return void(this.controlRegister=e);default:this.nvram[t-8]=e}}},{key:"i2cConnect",value:function(){return this.isFirstByte=!0,!0}},{key:"i2cReadByte",value:function(){this.isFirstByte=!1;var t=this.readRegister(this.addr);return this.addr=(this.addr+1)%64,t}},{key:"i2cWriteByte",value:function(t){return this.isFirstByte?(this.addr=t,this.isFirstByte=!1,!0):(this.writeRegister(this.addr,t),this.addr=(this.addr+1)%64,!0)}},{key:"i2cDisconnect",value:function(){}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.isFirstByte=!0,this.addr=0}}]),t}();(0,s.Z)(Lt,"pinNames",["SCL","SDA"]);var Ft=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ledController",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={led1:0,ledPower:1};var n=new Map,a=i.get("D2"),o=i.get("GND");n.set("A",a),n.set("C",o),this.ledController=new N(this.clock,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ledController.update();return t&&(this.value.led1=t.value,this.updated=!0),this.updated?{value:(0,u.Z)({},this.value)}:null}},{key:"reset",value:function(t){this.ledController.reset(),t&&(this.value.ledPower=0),this.updated=!0}}]),t}();(0,s.Z)(Ft,"pinNames",["D2","GND"]);var Jt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"nextOutput",Math.random()>=.5),(0,s.Z)(this,"lastNegEdge",0),(0,s.Z)(this,"outputEvent",void 0);var a=i.get("CLK"),o=i.get("D"),u=i.attached("S")?i.get("S"):null,l=i.attached("R")?i.get("R"):null,c=i.get("Q"),d=i.get("NOTQ");this.outputEvent=e.createEvent((function(){var t=n.nextOutput;(null===l||void 0===l?void 0:l.value)?t=!1:(null===u||void 0===u?void 0:u.value)&&(t=!0),c.setState(t?Z.J.High:Z.J.Low),d.setState(t?Z.J.Low:Z.J.High)})),null===u||void 0===u||u.onValueChange((function(t){t&&n.outputEvent.schedule(4)})),null===l||void 0===l||l.onValueChange((function(t){t&&n.outputEvent.schedule(4)})),a.onValueChange((function(t){t&&e.cpuNanos-n.lastNegEdge>=4?(n.nextOutput=o.value,n.outputEvent.schedule(4)):n.lastNegEdge=e.cpuNanos})),this.outputEvent.schedule(4)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Jt,"pinNames",["D","CLK","Q","NOTQ","S","R"]);var Kt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"nextOutput",Math.random()>=.5),(0,s.Z)(this,"lastNegEdge",0),(0,s.Z)(this,"outputEvent",void 0);var a=i.get("CLK"),o=i.get("Q"),u=i.get("S"),l=i.get("R"),c=i.get("NOTQ");this.outputEvent=e.createEvent((function(){var t=n.nextOutput;o.setState(t?Z.J.High:Z.J.Low),c.setState(t?Z.J.Low:Z.J.High)})),a.onValueChange((function(t){!t||e.cpuNanos-n.lastNegEdge<4?n.lastNegEdge=e.cpuNanos:(u.value&&l.value?n.nextOutput=!n.nextOutput:u.value?n.nextOutput=!0:l.value&&(n.nextOutput=!1),n.outputEvent.schedule(4))})),this.outputEvent.schedule(4)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Kt,"pinNames",["S","CLK","R","Q","NOTQ"]);var Wt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ledController",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={led:0,ledPower:1};var n=new Map,a=i.get("PB1"),o=i.get("GND");a&&o&&(n.set("A",a),n.set("C",o)),this.ledController=new N(this.clock,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ledController.update();return t&&(this.value.led=t.value,this.updated=!0),this.updated?{value:(0,u.Z)({},this.value)}:null}},{key:"reset",value:function(t){this.ledController.reset(),this.value.led=0,t&&(this.value.ledPower=0),this.updated=!0}}]),t}();(0,s.Z)(Wt,"pinNames",["PB1","GND"]);var Ht=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"distance",400);var a=i.get("ECHO"),o=i.get("TRIG");a.setState(Z.J.Low),o.onValueChange((function(t){if(!t){var i=3e5,r=Math.round(58.82*n.distance*1e3);e.addEvent(i,(function(){a.setState(Z.J.High)})),e.addEvent(i+r,(function(){a.setState(Z.J.Low)}))}}))}return(0,a.Z)(t,[{key:"onEvent",value:function(t){this.distance=t.distance}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Ht,"pinNames",["ECHO","TRIG"]);var qt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"value",0);var a=i.get("PL"),o=[i.get("D0"),i.get("D1"),i.get("D2"),i.get("D3"),i.get("D4"),i.get("D5"),i.get("D6"),i.get("D7")],u=i.get("Q7"),l=i.get("Q7_N"),c=function(){l.state=1&n.value?Z.J.Low:Z.J.High,u.state=1&n.value?Z.J.High:Z.J.Low},d=function(){a.value||(n.value=(o[0].value?128:0)|(o[1].value?64:0)|(o[2].value?32:0)|(o[3].value?16:0)|(o[4].value?8:0)|(o[5].value?4:0)|(o[6].value?2:0)|(o[7].value?1:0),c())};a.onValueChange(d);var h=!0,v=!1,f=void 0;try{for(var p,g=o[Symbol.iterator]();!(h=(p=g.next()).done);h=!0){p.value.onValueChange(d)}}catch(C){v=!0,f=C}finally{try{h||null==g.return||g.return()}finally{if(v)throw f}}var m=i.get("CP"),y=i.get("CE"),w=i.get("DS"),k=!1,b=function(){var t=m.value||y.value;!k&&t&&a.value&&(n.value=(w.value?128:0)|n.value>>1,e.addEvent(0,c)),k=t};m.onValueChange(b),y.onValueChange(b)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(qt,"pinNames",["PL","CP","D4","D5","D6","D7","Q7_N","GND","Q7","DS","D0","D1","D2","D3","CE","VCC"]);var Gt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"outputs",[]),(0,s.Z)(this,"enable",!1),(0,s.Z)(this,"clear",!1),(0,s.Z)(this,"inputValue",0),(0,s.Z)(this,"outputValue",0);var a=i.get("DS"),o=i.get("Q7S");i.get("SHCP").onValueChange((function(t){if(t){var e,i=null!==(e=a.value)&&void 0!==e&&e;n.inputValue=n.inputValue<<1|(i?1:0)}!t&&o&&(o.state=128&n.inputValue?Z.J.High:Z.J.Low)})),i.get("STCP").onValueChange((function(t){t&&(n.outputValue=n.clear?0:n.inputValue,n.enable&&n.updateOutput())}));var u=i.get("OE");this.enable=!u.value,u.onValueChange((function(t){if(n.enable=!t,t){var e=!0,i=!1,r=void 0;try{for(var a,s=n.outputs[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){a.value.setState(Z.J.HighZ)}}catch(o){i=!0,r=o}finally{try{e||null==s.return||s.return()}finally{if(i)throw r}}}else n.updateOutput()}));var l=i.get("MR");this.clear=!!i.attached("MR")&&!l.value,l.onValueChange((function(t){n.clear=!t,n.inputValue=0}));var c=!0,d=!1,h=void 0;try{for(var v,f=[0,1,2,3,4,5,6,7][Symbol.iterator]();!(c=(v=f.next()).done);c=!0){var p=v.value;this.outputs[p]=i.get("Q".concat(p))}}catch(g){d=!0,h=g}finally{try{c||null==f.return||f.return()}finally{if(d)throw h}}}return(0,a.Z)(t,[{key:"updateOutput",value:function(){var t=this.outputValue,e=!0,i=!1,n=void 0;try{for(var r,a=this.outputs[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.setState(1&t?Z.J.High:Z.J.Low),t>>=1}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Gt,"pinNames",["Q1","Q2","Q3","Q4","Q5","Q6","Q7","GND","Q7S","MR","SHCP","STCP","OE","DS","Q0","VCC"]);var zt,Xt=i(11113),jt=i(29399),Qt=(zt={},(0,s.Z)(zt,54,1),(0,s.Z)(zt,193,1),(0,s.Z)(zt,180,1),(0,s.Z)(zt,197,1),(0,s.Z)(zt,58,1),(0,s.Z)(zt,194,2),(0,s.Z)(zt,195,2),(0,s.Z)(zt,196,2),(0,s.Z)(zt,182,2),(0,s.Z)(zt,177,3),(0,s.Z)(zt,178,3),(0,s.Z)(zt,42,4),(0,s.Z)(zt,43,4),(0,s.Z)(zt,192,3),(0,s.Z)(zt,179,6),(0,s.Z)(zt,224,16),(0,s.Z)(zt,225,16),zt),$t=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"width",128),(0,s.Z)(this,"height",128),(0,s.Z)(this,"pixels",new Uint16Array(this.height*this.width)),(0,s.Z)(this,"blackDisplay",!0),(0,s.Z)(this,"displayOn",!1),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"invert",!1),(0,s.Z)(this,"activeColumn",0),(0,s.Z)(this,"activePage",0),(0,s.Z)(this,"columnStart",0),(0,s.Z)(this,"columnEnd",0),(0,s.Z)(this,"pageStart",0),(0,s.Z)(this,"pageEnd",0),(0,s.Z)(this,"scanningDirection",0),(0,s.Z)(this,"highByte",!0),(0,s.Z)(this,"highByteValue",0),(0,s.Z)(this,"commandMode",!1),(0,s.Z)(this,"currentCommandIndex",0),(0,s.Z)(this,"currentCommandLength",0),(0,s.Z)(this,"currentCommand",new Uint8Array(8));var a=i.get("D/C");this.reset(),new b({mosi:i.get("SDA"),clk:i.get("SCL"),ss:i.get("CS")}).onTransmit=function(t){return a.value?n.processData(t):n.processCommand(t),0}}return(0,a.Z)(t,[{key:"update",value:function(){if(this.updated){this.updated=!1;return{value:{pixels:this.pixels,invert:this.invert}}}return null}},{key:"snapshot",value:function(){this.update()}},{key:"value",get:function(){return""}},{key:"reset",value:function(){this.displayOn=!1,this.activeColumn=0,this.activePage=0,this.columnStart=0,this.columnEnd=127,this.pageStart=0,this.pageEnd=7}},{key:"fixBlackDisplayPageOffsets",value:function(){128&this.scanningDirection&&(this.activePage-=32,this.pageStart-=32),128&this.scanningDirection&&(this.pageEnd-=32)}},{key:"processCommand",value:function(t){if(this.commandMode=!0,this.currentCommand[this.currentCommandIndex]=t,this.currentCommandIndex||(this.currentCommandLength=1+(Qt[t]||0)),this.currentCommandIndex++,!(this.currentCommandIndex<this.currentCommandLength)){var e=this.currentCommand[0],i=!1;switch(e){case 0:case 192:case 1:case 58:case 197:break;case 16:case 40:this.displayOn=!1,i=!0;break;case 17:case 41:this.displayOn=!0,i=!0;break;case 32:this.invert=!1,i=!0;break;case 33:this.invert=!0,i=!0;break;case 44:this.commandMode=!1,this.highByte=!0;break;case 54:this.scanningDirection=252&this.currentCommand[1];break;case 42:case 43:var n=this.currentCommand[1]<<8|this.currentCommand[2],r=this.currentCommand[3]<<8|this.currentCommand[4],a=43===e;(32&this.scanningDirection?!a:a)?(this.activePage=n,this.pageStart=n,this.pageEnd=r,this.blackDisplay&&this.fixBlackDisplayPageOffsets()):(this.activeColumn=n,this.columnStart=n,this.columnEnd=r);break;default:console.warn("Unknown IL9163 Command",e.toString(16),this.currentCommand.slice(1,this.currentCommandIndex))}i&&this.displayOn&&(this.updated=!0),this.currentCommandIndex=0}}},{key:"processData",value:function(t){if(this.commandMode)this.processCommand(t);else{if(this.highByte)return this.highByte=!1,void(this.highByteValue=t);var e=this.highByteValue<<8|t,i=this.activeColumn,n=this.activePage;32&this.scanningDirection?(i=64&this.scanningDirection?this.width-1-i:i,n=128&this.scanningDirection?this.height-1-n:n):(i=128&this.scanningDirection?this.width-1-i:i,n=64&this.scanningDirection?this.height-1-n:n);var r=n*this.width+i;this.pixels[r]=e,32&this.scanningDirection?(this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart))):(this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart))),this.updated=!0,this.highByte=!0}}}]),t}();(0,s.Z)($t,"pinNames",["D/C","CS","SDA","SCL"]);var Yt=526500,te=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"transmitter",void 0);var n=i.get("DAT");n.setState(Z.J.PullUp),this.transmitter=new Et(e,n),t.instances.set(e,this)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){for(var e=this.transmitter,i=255&t.command,n=255&t.address,r=n|(255&~n)<<8|i<<16|(255&~i)<<24,a=[9e6,45e5],s=0;s<32;s++)a.push(Yt,r&1<<s?1687500:526500);a.push(Yt),e.transmit(a,!1)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}],[{key:"find",value:function(e){return t.instances.get(e)}}]),t}();(0,s.Z)(te,"instances",new WeakMap),(0,s.Z)(te,"pinNames",["DAT"]);var ee=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e;null===(e=te.find(this.clock))||void 0===e||e.onEvent(t)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(ee,"pinNames",[]);var ie=i(66869),ne=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"switch",void 0),(0,s.Z)(this,"clk",void 0),(0,s.Z)(this,"dt",void 0),(0,s.Z)(this,"rotateEvent",void 0),(0,s.Z)(this,"currentState",void 0),(0,s.Z)(this,"firstPin",void 0),(0,s.Z)(this,"secondPin",void 0),(0,s.Z)(this,"rotateNext",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.currentState=0,this.rotateNext=function(){switch(n.currentState){case 0:var t;null===(t=n.firstPin)||void 0===t||t.setState(Z.J.Low),n.rotateEvent.schedule((0,ie.r)(2e6,8e6)),n.currentState++;break;case 1:var e;null===(e=n.secondPin)||void 0===e||e.setState(Z.J.Low),n.rotateEvent.schedule((0,ie.r)(2e6,19e6)),n.currentState++;break;case 2:var i;null===(i=n.firstPin)||void 0===i||i.setState(Z.J.PullUp),n.rotateEvent.schedule((0,ie.r)(100,5e6)),n.currentState++;break;case 3:var r;null===(r=n.secondPin)||void 0===r||r.setState(Z.J.PullUp),n.currentState=0}},this.switch=new ct(i.get("SW"),i.get("GND")),this.clk=i.get("CLK"),this.dt=i.get("DT"),this.clk.state=Z.J.PullUp,this.dt.state=Z.J.PullUp,this.rotateEvent=this.clock.createEvent(this.rotateNext)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){switch(t.type){case"press":this.switch.connected=!0;break;case"release":this.switch.connected=!1;break;case"rotate-cw":this.rotate(this.clk,this.dt);break;case"rotate-ccw":this.rotate(this.dt,this.clk)}}},{key:"rotate",value:function(t,e){var i,n;if(0!==this.currentState)return null===(i=this.firstPin)||void 0===i||i.setState(Z.J.PullUp),null===(n=this.secondPin)||void 0===n||n.setState(Z.J.PullUp),this.firstPin=t,this.secondPin=e,this.currentState=0,void this.rotateEvent.schedule(1e3);this.firstPin=t,this.secondPin=e,this.rotateNext()}},{key:"reset",value:function(){}},{key:"update",value:function(){return null}}]),t}();(0,s.Z)(ne,"pinNames",["CLK","DT","SW","VCC","GND"]);var re=80,ae=40,se=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"ddram",new Uint8Array(re)),(0,s.Z)(this,"cgram",new Uint8Array(64)),(0,s.Z)(this,"cgramUpdated",!0),(0,s.Z)(this,"addr",0),(0,s.Z)(this,"writeCGRam",!1),(0,s.Z)(this,"busy",!1),(0,s.Z)(this,"firstByte",!0),(0,s.Z)(this,"registerValue",0),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"shift",0),(0,s.Z)(this,"incrementMode",!0),(0,s.Z)(this,"shiftMode",!1),(0,s.Z)(this,"displayOn",!1),(0,s.Z)(this,"blinkOn",!1),(0,s.Z)(this,"cursorOn",!1),(0,s.Z)(this,"backlight",!1),(0,s.Z)(this,"is8bit",!0),(0,s.Z)(this,"cols",16),(0,s.Z)(this,"rows",2),this.reset()}return(0,a.Z)(t,[{key:"reset",value:function(){this.cgram.fill(0),this.ddram.fill(0),this.cgramUpdated=!0,this.addr=0,this.writeCGRam=!1,this.firstByte=!0,this.registerValue=0,this.shift=0,this.incrementMode=!0,this.shiftMode=!1,this.displayOn=!1,this.blinkOn=!1,this.cursorOn=!1,this.backlight=!1,this.is8bit=!0,this.updated=!0}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:this.snapshot()}):null}},{key:"snapshot",value:function(){var t=this,e=t.rows,i=t.cols,n=t.shift,r=t.ddram,a=new Uint8Array(e*i),s=[0,ae,i,ae+i];if(this.displayOn)for(var o=0;o<e;o++)for(var u=0;u<i;u++){var l=(u+ae-n)%ae;a[o*i+u]=r[s[o]+l]}else a.fill(32);var c=this,d=c.cursorOn,h=c.blinkOn,v=c.backlight,f=c.cgram,p=c.cgramUpdated,g=c.addr,m=(g+ae+n)%ae,y=g>ae?1:0;return i>2&&m>i&&(m-=i,y+=2),this.cgramUpdated=!1,{cursor:d,blink:h,cursorX:m,cursorY:y,value:a,backlight:v,cgram:f,cgramUpdated:p}}},{key:"value",get:function(){return""}},{key:"readByte",value:function(t){var e=(this.busy?128:0)|127&this.addr,i=t?this.readData(!this.firstByte):e;return this.is8bit?i:this.firstByte?(this.firstByte=!1,240&i):(this.firstByte=!0,(15&i)<<4)}},{key:"readData",value:function(t){if(this.writeCGRam){var e=this.cgram[this.addr],i=(1&e)<<4|(2&e)<<2|4&e|(8&e)>>2|(16&e)>>4;return t&&(this.addr=(this.addr+1)%64),i}var n=this.ddram[this.addr];if(t){var r=this.incrementMode?1:-1;this.addr=(this.addr+re+r)%re}return n}},{key:"feedByte",value:function(t,e){if(!this.is8bit){if(this.firstByte)return this.registerValue=t,void(this.firstByte=!1);t=this.registerValue|t>>4,this.firstByte=!0}e?this.writeData(t):this.executeCommand(t),this.updated=!0}},{key:"writeData",value:function(t){if(this.writeCGRam){var e=(1&t)<<4|(2&t)<<2|4&t|(8&t)>>2|(16&t)>>4;this.cgram[this.addr]=e,this.addr=(this.addr+1)%64,this.cgramUpdated=!0}else{this.ddram[this.addr]=t;var i=this.incrementMode?1:-1;this.addr=(this.addr+re+i)%re,this.shiftMode&&(this.shift=(this.shift+i)%ae)}}},{key:"executeCommand",value:function(t){if(128&t){var e=127&t;this.addr=e<ae?e:e-24,this.addr>=re&&(this.addr=0),this.writeCGRam=!1}else if(64&t)this.addr=63&t,this.writeCGRam=!0;else if(32&t)this.is8bit=!!(16&t);else if(16&t){var i=!!(8&t),n=!!(4&t)?1:-1;this.addr=(this.addr+re+n)%re,i&&(this.shift=(this.shift+n)%ae),this.writeCGRam=!1}else 8&t?(this.displayOn=!!(4&t),this.blinkOn=!!(1&t),this.cursorOn=!!(2&t)):4&t?(this.incrementMode=!!(2&t),this.shiftMode=!!(1&t)):2&t?(this.writeCGRam=!1,this.addr=0,this.shift=0):1&t&&(this.ddram.fill(32),this.incrementMode=!0,this.addr=0,this.shift=0,this.writeCGRam=!1)}},{key:"setBacklight",value:function(t){t!==this.backlight&&(this.backlight=t,this.updated=!0)}},{key:"attachToPins",value:function(t){var e=t.enable,i=t.rw;i.setState(Z.J.PullDown);var n=t.a,r=t.k;if(n&&r){var a=this;st([n,r],(function(){return n.value&&!r.value&&(n.driven||r.driven)}),(function(t){a.setBacklight(t)}))}if(e){var s=this;e.onValueChange((function(e){if(e&&!i.value){var n,r,a,o,u,l,c,d,h=((null===(n=t.d0)||void 0===n?void 0:n.value)?1:0)|((null===(r=t.d1)||void 0===r?void 0:r.value)?2:0)|((null===(a=t.d2)||void 0===a?void 0:a.value)?4:0)|((null===(o=t.d3)||void 0===o?void 0:o.value)?8:0)|((null===(u=t.d4)||void 0===u?void 0:u.value)?16:0)|((null===(l=t.d5)||void 0===l?void 0:l.value)?32:0)|((null===(c=t.d6)||void 0===c?void 0:c.value)?64:0)|((null===(d=t.d7)||void 0===d?void 0:d.value)?128:0);s.feedByte(h,t.rs.value)}if(e&&i.value){var v,f,p,g,m,y,w,k,b=s.readByte(t.rs.value);null===(v=t.d0)||void 0===v||v.setState(1&b?Z.J.High:Z.J.Low),null===(f=t.d1)||void 0===f||f.setState(2&b?Z.J.High:Z.J.Low),null===(p=t.d2)||void 0===p||p.setState(4&b?Z.J.High:Z.J.Low),null===(g=t.d3)||void 0===g||g.setState(8&b?Z.J.High:Z.J.Low),null===(m=t.d4)||void 0===m||m.setState(16&b?Z.J.High:Z.J.Low),null===(y=t.d5)||void 0===y||y.setState(32&b?Z.J.High:Z.J.Low),null===(w=t.d6)||void 0===w||w.setState(64&b?Z.J.High:Z.J.Low),null===(k=t.d7)||void 0===k||k.setState(128&b?Z.J.High:Z.J.Low)}if(!e){var C=[t.d0,t.d1,t.d2,t.d3,t.d4,t.d5,t.d6,t.d7],x=!0,S=!1,_=void 0;try{for(var P,D=C[Symbol.iterator]();!(x=(P=D.next()).done);x=!0){var I=P.value;null===I||void 0===I||I.setState(Z.J.PullDown)}}catch(A){S=!0,_=A}finally{try{x||null==D.return||D.return()}finally{if(S)throw _}}}}))}}}]),t}(),oe=i(4111),ue=i(28668),le=i(26626),ce=function(t){(0,ue.Z)(i,t);var e=(0,le.Z)(i);function i(t,n){var a;return(0,r.Z)(this,i),a=e.call(this),(0,s.Z)((0,oe.Z)(a),"prevEnable",!1),(0,s.Z)((0,oe.Z)(a),"readMode",!1),(0,s.Z)((0,oe.Z)(a),"inputMask",0),(0,s.Z)((0,oe.Z)(a),"inputValue",255),new D.A({scl:t.get("SCL"),sda:t.get("SDA")},n).setHandler((0,oe.Z)(a)),a}return(0,a.Z)(i,[{key:"i2cConnect",value:function(){return!0}},{key:"i2cReadByte",value:function(){return this.readMode?this.inputMask&this.inputValue:this.inputMask}},{key:"i2cWriteByte",value:function(t){var e=240&t,i=!!(1&t),n=!!(2&t),r=!!(4&t),a=!!(8&t);this.inputMask=t,this.readMode=r&&n,this.setBacklight(a);var s=r&&!this.prevEnable;if(s&&!this.readMode&&this.feedByte(e,i),s&&this.readMode){var o=this.readByte(i);this.inputValue=240&o|7}return this.prevEnable=r,!0}},{key:"i2cDisconnect",value:function(){}}]),i}(se),de=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"controller",void 0);var a=parseInt(n.get("i2c-address")||"0",16)||39;"i2c"===n.get("pins")?this.controller=new ce(i,a):(this.controller=new se,this.controller.attachToPins({a:i.attached("A")?i.get("A"):null,k:i.attached("K")?i.get("K"):null,v0:i.attached("V0")?i.get("V0"):null,rs:i.get("RS"),rw:i.get("RW"),enable:i.get("E"),d0:i.get("D0"),d1:i.get("D1"),d2:i.get("D2"),d3:i.get("D3"),d4:i.get("D4"),d5:i.get("D5"),d6:i.get("D6"),d7:i.get("D7")}))}return(0,a.Z)(t,[{key:"update",value:function(){var t,e;return null!==(e=null===(t=this.controller)||void 0===t?void 0:t.update())&&void 0!==e?e:null}},{key:"reset",value:function(){var t;null===(t=this.controller)||void 0===t||t.reset()}}]),t}();(0,s.Z)(de,"pinNames",["A","K","V0","RS","RW","E","D0","D1","D2","D3","D4","D5","D6","D7","SCL","SDA"]);var he=function(t){(0,ue.Z)(i,t);var e=(0,le.Z)(i);function i(t,n,a){var s;return(0,r.Z)(this,i),(s=e.call(this,t,n,a)).controller&&(s.controller.rows=4,s.controller.cols=20),s}return i}(de);(0,s.Z)(he,"pinNames",de.pinNames);var ve=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"leds",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.leds=[],this.value={segments:[]};for(var n=1;n<=10;n++){var a=new Map;a.set("A",i.get("A".concat(n))),a.set("C",i.get("C".concat(n))),this.leds.push(new N(e,a))}}return(0,a.Z)(t,[{key:"update",value:function(){for(var t=!1,e=0;e<this.leds.length;e++){var i,n=null===(i=this.leds[e])||void 0===i?void 0:i.update();n&&(this.value.segments[e]=n.value,t=!0)}return t?{value:this.value}:null}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.leds[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a=n.value;null===a||void 0===a||a.reset()}}catch(s){e=!0,i=s}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}}]),t}();(0,s.Z)(ve,"pinNames",["A1","A2","A3","A4","A5","A6","A7","A8","A9","A10","C1","C2","C3","C4","C5","C6","C7","C8","C9","C10"]);var fe=80,pe=55,ge=75,me=5,ye=function(){function t(e,i,n){var a,o=this;(0,r.Z)(this,t),(0,s.Z)(this,"lastUpdate",void 0),(0,s.Z)(this,"frames",void 0),(0,s.Z)(this,"lastFrame",void 0),(0,s.Z)(this,"power",void 0),(0,s.Z)(this,"lastPower",void 0),(0,s.Z)(this,"pixelCount",void 0),(0,s.Z)(this,"standbyPower",void 0),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.lastUpdate=0,this.frames=0,this.lastFrame=0,this.power=0,this.lastPower=0,this.pixelCount=parseInt(null!==(a=n.get("pixels"))&&void 0!==a?a:"",10)||0,this.standbyPower=this.pixelCount*me,this.reset();var u=i.get("DIN");this.ws2812Decoder=new L(u,e),this.ws2812Decoder.resize(this.pixelCount),this.ws2812Decoder.subscribe((function(t){o.lastPower=o.standbyPower;var i=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,l=255&u,c=u>>8&255,d=u>>16&255;o.lastPower+=(c*fe+d*pe+l*ge)/256}}catch(h){n=!0,r=h}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}o.power=Math.max(o.power,o.lastPower),o.frames++,o.lastFrame=e.cpuMillis}))}return(0,a.Z)(t,[{key:"update",value:function(){this.ws2812Decoder.update();var t=this.clock.cpuMillis-this.lastUpdate;if(t>1e3){var e={fps:this.frames?this.frames/(t/1e3):1e3/(this.clock.cpuMillis-this.lastFrame),milliWatts:this.power};return this.lastUpdate=this.clock.cpuMillis,this.power=this.lastPower,this.frames=0,{value:e}}return null}},{key:"reset",value:function(){this.frames=0,this.lastUpdate=0,this.lastFrame=0,this.lastPower=this.standbyPower,this.power=this.lastPower}}]),t}();(0,s.Z)(ye,"pinNames",["DIN"]);var we,ke=["D0","D1","D2","D3","D4","D5","D6","D7"],Ze="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~";!function(t){t[t.Off=0]="Off",t[t.Level=1]="Level",t[t.Edge=2]="Edge"}(we||(we={}));var be=function(){function t(e,i,n){var a,o,u,l=this,c=function(t){var n=i.get(ke[t]);if(i.attached(ke[t])){var r=l,a=l.channelNames.length;l.pins[t]=n,l.channelNames.push(m[t]||ke[t]),l.triggered&&(w[l.sampleIndex]=0,y[l.sampleIndex++]=a<<1|(n.value?1:0));var s=n===l.triggerPin;n.onValueChange((function(i){(r.triggered||s)&&(r.activeChannels|=1<<t,r.updated=!0,r.sampleIndex<w.length&&(w[r.sampleIndex]=e.cpuNanos,y[r.sampleIndex++]=a<<1|(i?1:0)))}))}};(0,r.Z)(this,t),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"triggerPin",void 0),(0,s.Z)(this,"samples",void 0),(0,s.Z)(this,"filename",void 0),(0,s.Z)(this,"sampleTimes",void 0),(0,s.Z)(this,"sampleIndex",void 0),(0,s.Z)(this,"channelNames",void 0),(0,s.Z)(this,"traceNames",void 0),(0,s.Z)(this,"traces",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"activeChannels",void 0),(0,s.Z)(this,"triggered",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.pins=[],this.sampleIndex=0,this.channelNames=[],this.traceNames=[],this.traces=[],this.updated=!1,this.activeChannels=0,this.triggered=!1;var d,h,v=parseInt(null!==(u=n.get("bufferSize"))&&void 0!==u?u:"0",10)||1e6;this.filename=(null===(a=n.get("filename"))||void 0===a?void 0:a.replace(/[\\/:"*?<>|]/g,""))||"wokwi-logic",this.samples=new Uint8Array(v),this.sampleTimes=new Float64Array(v),this.updated=!0,this.triggerPin=i.get(null!==(d=n.get("triggerPin"))&&void 0!==d?d:"D7");var f,p=function(t){switch(t){case"level":return we.Level;case"edge":return we.Edge;default:return we.Off}}(null!==(h=n.get("triggerMode"))&&void 0!==h?h:"off"),g="low"!==n.get("triggerLevel");this.setupTrigger(p,g);for(var m=null!==(f=null===(o=n.get("channelNames"))||void 0===o?void 0:o.split(",").map((function(t){return t.trim()})))&&void 0!==f?f:[],y=this.samples,w=this.sampleTimes,k=0;k<ke.length;k++)c(k);t.instance=this}return(0,a.Z)(t,[{key:"trace",value:function(t,e){var i=this.traceNames.indexOf(t);i<0&&(i=this.traceNames.length,this.traceNames.push(t)),this.traces[this.sampleIndex]=e,this.samples[this.sampleIndex]=i+32<<1,this.sampleTimes[this.sampleIndex++]=this.clock.cpuNanos}},{key:"dumpPinValues",value:function(){for(var t=this,e=t.samples,i=t.sampleTimes,n=t.clock,r=0;r<this.pins.length;r++){var a=this.pins[r];a&&(i[this.sampleIndex]=n.cpuNanos,e[this.sampleIndex++]=r<<1|(a.value?1:0))}}},{key:"setupTrigger",value:function(t,e){switch(t){case we.Off:this.triggered=!0;break;case we.Level:var i=this;this.triggered=this.triggerPin.value===e,this.triggerPin.onValueChange((function(t){i.triggered=t===e,t&&i.dumpPinValues()}));break;case we.Edge:var n=this;this.triggered=!1,this.triggerPin.onValueChange((function(t){t!==e||n.triggered||(n.triggered=!0,n.dumpPinValues())}))}}},{key:"update",value:function(){var t=this.updated,e=this.activeChannels;return this.activeChannels||(this.updated=!1),this.activeChannels=0,t?{value:{activeChannels:e,samples:this.sampleIndex}}:null}},{key:"finalize",value:function(){var t=this,e=t.sampleIndex,i=t.sampleTimes,n=t.samples,r=t.pins;if(e<i.length){this.sampleTimes[this.sampleIndex]=this.clock.cpuNanos;var a=parseInt(Object.keys(r)[0],10);n[this.sampleIndex++]=a<<1|(r[a].value?1:0)}}},{key:"reset",value:function(){if(this.updated=!0,this.sampleIndex){this.finalize();var t=this.channelNames.length,e=Ze.slice(t,t+this.traceNames.length),i=["$version Generated by Wokwi.com $end","$date ".concat((new Date).toUTCString()," $end"),"$timescale 1ns $end","$scope module logic $end"].concat((0,d.Z)(this.channelNames.map((function(t,e){return"$var wire 1 ".concat(Ze[e]," ").concat(t," $end")}))),(0,d.Z)(this.traceNames.map((function(t,i){return"$var real 64 ".concat(e[i]," ").concat(t," $end")}))),["$upscope $end","$enddefinitions $end"]),n=this,r=n.samples,a=n.sampleTimes,s=n.sampleIndex;s&&0!==a[0]&&i.push("#0");for(var o=0;o<s;o++){var u=1&r[o],l=r[o]>>1;if(i.push("#".concat(a[o].toFixed(0))),l<32){var c=Ze[l];i.push("".concat(u).concat(c))}else{var h=e[l-32];i.push("r".concat(this.traces[o]," ").concat(h))}}i.push("");var v=new Blob([i.join("\n")],{type:"application/octet-stream"}),f=window.URL.createObjectURL(v),p=document.createElement("a");p.href=f,p.download=this.filename+".vcd",p.style.display="none",document.body.appendChild(p),p.click(),p.remove()}this.sampleIndex=0}}]),t}();function Ce(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["A","B"],i="OUT",n=function(){function n(a,o){(0,r.Z)(this,n),(0,s.Z)(this,"clock",void 0),this.clock=a;var u=e.map((function(t){return o.get(t)})),l=o.get(i);st(u,t,(function(t){l.setState(t?Z.J.High:Z.J.Low)}))}return(0,a.Z)(n,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),n}();return(0,s.Z)(n,"pinNames",(0,d.Z)(e).concat([i])),n}(0,s.Z)(be,"pinNames",ke),(0,s.Z)(be,"instance",void 0);var xe=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15];function Se(t){return xe[15&t]<<4|xe[t>>4&15]}var _e=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"ram",void 0),(0,s.Z)(this,"inputBuffer",void 0),(0,s.Z)(this,"chainLength",void 0),(0,s.Z)(this,"inputIndex",0),(0,s.Z)(this,"bitOutIndex",0),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"revColumns",!1);var o=i.get("CLK"),u=i.get("DIN"),l=i.get("DOUT"),c=i.get("CS"),d=i.attached("DOUT"),h=n.get("layout");if(this.revColumns="fc16"===h,this.chainLength=parseInt(n.get("chain")||"",10)||8,this.ram=new Uint8Array(8*this.chainLength),this.inputBuffer=new Uint8Array(2*this.chainLength),c&&o&&u){if(new b({clk:o,mosi:u,ss:c}).onTransmit=function(t){a.inputBuffer[a.inputIndex++%a.inputBuffer.length]=t},d){var v=this;o.onValueChange((function(t){if(!c.value&&!t){var e=v.inputBuffer[v.inputIndex%v.inputBuffer.length]&1<<7-v.bitOutIndex;l.setState(e?Z.J.High:Z.J.Low),v.bitOutIndex=(v.bitOutIndex+1)%8}}))}c.onValueChange((function(t){t?(a.transmissionComplete(),a.updated=!0):(a.inputIndex=0,a.bitOutIndex=1)}))}}return(0,a.Z)(t,[{key:"transmissionComplete",value:function(){for(var t=this.inputBuffer,e=this.chainLength,i=this.inputIndex%t.length,n=Math.min(Math.floor(this.inputIndex/2),e),r=0;r<n;r++){(i-=2)<0&&(i+=t.length);var a=t[i];if(a>=1&&a<=8){var s=t[i+1];this.revColumns&&(s=Se(s)),this.ram[8*(e-1-r)+a-1]=s}}}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{pixels:this.ram}}):null}},{key:"reset",value:function(){this.inputIndex=0}}]),t}();(0,s.Z)(_e,"pinNames",["DIN","DOUT","CS","GND","V+","CLK"]);var Pe=["R1","R2","R3","R4"],De=["C1","C2","C3","C4"],Ie=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"bridges",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.bridges=new Map;for(var n=0;n<De.length;n++)for(var a=0;a<Pe.length;a++){var o=i.get(Pe[a]),u=i.get(De[n]);this.bridges.set("".concat(n,",").concat(a),new ct(u,o))}}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this.bridges.get("".concat(t.column,",").concat(t.row));e&&(e.connected="press"===t.type)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Ie,"pinNames",(0,d.Z)(Pe).concat((0,d.Z)(De)));var Ae=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"pin1",void 0),(0,s.Z)(this,"pin2",void 0),(0,s.Z)(this,"context",void 0),(0,s.Z)(this,"userMedia",void 0),(0,s.Z)(this,"source",void 0),(0,s.Z)(this,"captureNode",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.context=new AudioContext,this.pin1=i.get("1"),this.pin2=i.get("2"),this.initMic().catch((function(t){console.warn("Failed to initialize microphone",t)}))}return(0,a.Z)(t,[{key:"initMic",value:function(){var t=this;return(0,n.Z)(f().mark((function e(){var i,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,null===navigator||void 0===navigator||null===(i=navigator.mediaDevices)||void 0===i?void 0:i.getUserMedia({audio:!0});case 3:if(t.userMedia=e.sent,t.userMedia){e.next=7;break}return console.warn("Failed to initialize microphone input track!"),e.abrupt("return");case 7:t.source=t.context.createMediaStreamSource(t.userMedia),(n=t.context.createScriptProcessor(256,1,1)).addEventListener("audioprocess",(function(e){var i=e.inputBuffer.getChannelData(0),n=e.inputBuffer.duration/e.inputBuffer.length*1e9,r=0,a=function(){var e,s,o=Math.max(0,.5+.5*i[r]);null===(e=t.pin1)||void 0===e||e.node.analogPort.writeNormalized(o),null===(s=t.pin2)||void 0===s||s.node.analogPort.writeNormalized(o),++r<i.length&&t.clock.addEvent(n,a)};a()})),t.source.connect(n),n.connect(t.context.destination),t.captureNode=n;case 13:case"end":return e.stop()}}),e)})))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.pause()}},{key:"pause",value:function(){var t,e;null===(t=this.userMedia)||void 0===t||t.getAudioTracks().map((function(t){return t.stop()})),null===(e=this.captureNode)||void 0===e||e.disconnect()}},{key:"resume",value:function(){}}]),t}();(0,s.Z)(Ae,"pinNames",["1","2"]);var Re=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"onmidimessage",null),(0,s.Z)(this,"message",[]),this.createPlayer(),new W.g(e,i.get("RX")).subscribe((function(t){var e;(e=n.message).push.apply(e,(0,d.Z)(t)),n.checkMessage()}))}return(0,a.Z)(t,[{key:"createPlayer",value:function(){var t=this;return(0,n.Z)(f().mark((function e(){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(5661).then(i.bind(i,95661));case 2:return n=e.sent.instrument,e.next=5,n(new AudioContext,"acoustic_grand_piano");case 5:e.sent.listenToMidi(t);case 7:case"end":return e.stop()}}),e)})))()}},{key:"checkMessage",value:function(){for(;this.message.length>=3;){var t;null===(t=this.onmidimessage)||void 0===t||t.call(this,{data:new Uint8Array(this.message.slice(0,3))}),this.message.splice(3)}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.message=[]}}]),t}();(0,s.Z)(Re,"pinNames",["RX"]);var Be=i(11551),Ee=function(){function t(e,i,n){var a;(0,r.Z)(this,t),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"rows",void 0),(0,s.Z)(this,"cols",void 0),(0,s.Z)(this,"layout",void 0),(0,s.Z)(this,"brightness",void 0),(0,s.Z)(this,"gamma",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.rows=parseInt(n.get("rows")||"0",10)||0,this.cols=parseInt(n.get("cols")||"0",10)||0,this.layout=n.get("matrixLayout")||"";var o,u=parseFloat(null!==(a=n.get("matrixBrightness"))&&void 0!==a?a:"1");this.brightness=u>=.01?u:1,this.gamma=parseFloat(null!==(o=n.get("_temp_gamma"))&&void 0!==o?o:"");var l=this.rows*this.cols,c=i.get("DIN"),d=i.get("DOUT");this.ws2812Decoder=new L(c,e,d),this.ws2812Decoder.resize(l)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ws2812Decoder.update();return t?{value:{pixels:t.slice(0,this.rows*this.cols),rows:this.rows,cols:this.cols,brightness:this.brightness,gamma:this.gamma,layout:this.layout,colorFormat:pt.q.BRG}}:null}},{key:"reset",value:function(){this.ws2812Decoder.reset()}}]),t}();(0,s.Z)(Ee,"pinNames",["DIN","VDD","VSS","DOUT"]);var Ue=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"pixel",void 0),(0,s.Z)(this,"pixels",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.pixel=parseInt(n.get("pixel")||"0",10)||0,this.pixels=parseInt(n.get("pixels")||"1",10)||1;var a=i.get("DIN"),o=i.get("DOUT");this.ws2812Decoder=new L(a,e,o),this.ws2812Decoder.resize(this.pixel+this.pixels)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ws2812Decoder.update();return t?{value:t.slice(this.pixel,this.pixel+this.pixels)}:null}},{key:"reset",value:function(){this.ws2812Decoder.reset()}}]),t}();(0,s.Z)(Ue,"pinNames",["DIN","VDD","VSS","DOUT"]);var Ne=["QA","QB","QC","QD","QE","QF","QG","QH"],Te=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"outputs",void 0),(0,s.Z)(this,"enable",!1),(0,s.Z)(this,"clear",!1),(0,s.Z)(this,"inputValue",0),(0,s.Z)(this,"outputValue",0);var a=i.get("SI"),o=i.get("SQH");i.get("SCK").onValueChange((function(t){if(t){var e,i=null!==(e=a.value)&&void 0!==e&&e;n.inputValue=n.inputValue<<1|(i?1:0)}!t&&o&&(o.state=128&n.inputValue?Z.J.High:Z.J.Low)})),i.get("RCK").onValueChange((function(t){t&&(n.outputValue=n.clear?0:n.inputValue,n.enable&&n.updateOutput())}));var u=i.get("OE");this.enable=!u.value,u.onValueChange((function(t){if(n.enable=!t,t){var e=!0,i=!1,r=void 0;try{for(var a,s=n.outputs[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){a.value.setState(Z.J.HighZ)}}catch(o){i=!0,r=o}finally{try{e||null==s.return||s.return()}finally{if(i)throw r}}}else n.updateOutput()}));var l=i.get("SCLR");this.clear=!!i.attached("SCLR")&&!l.value,l.onValueChange((function(t){n.clear=!t,n.inputValue=0})),this.outputs=Ne.map((function(t){return i.get(t)}))}return(0,a.Z)(t,[{key:"updateOutput",value:function(){var t=this.outputValue,e=!0,i=!1,n=void 0;try{for(var r,a=this.outputs[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.setState(1&t?Z.J.HighZ:Z.J.Low),t>>=1}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Te,"pinNames",(0,d.Z)(Ne).concat(["GND","SQH","SCLR","SCK","RCK","OE","SI","VCC"]));var Oe=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"out",void 0),(0,s.Z)(this,"beta",void 0),(0,s.Z)(this,"temperature",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.value=null,this.temperature=24,this.out=i.get("OUT");var a=parseFloat(n.get("temperature")||"");this.temperature=isNaN(a)?24:a;var o=parseFloat(n.get("beta")||"");this.beta=!isNaN(o)&&o?o:3950,this.out.node.analogPort.writeNormalized(this.analogValue)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=t.temperature;this.temperature=e,this.out.node.analogPort.writeNormalized(this.analogValue)}},{key:"analogValue",get:function(){var t=273.15,e=this.temperature+t,i=1e4*Math.exp(this.beta*(1/e-1/298.15));return i/(i+1e4)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Oe,"pinNames",["OUT"]);var Me=i(42191),Ve=["P0","P1","P2","P3","P4","P5","P6","P7"],Le=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"firstWriteByte",void 0),(0,s.Z)(this,"ioPins",void 0),(0,s.Z)(this,"intPin",void 0),(0,s.Z)(this,"inputMask",void 0),(0,s.Z)(this,"prevValue",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.firstWriteByte=!1,this.inputMask=0,this.prevValue=0;var a=i.get("A0"),o=i.get("A1"),u=i.get("A2"),l=new D.A({scl:i.get("SCL"),sda:i.get("SDA")});(0,Me.u)(l,32,[a,o,u]),this.ioPins=Ve.map((function(t){return i.get(t)})),this.intPin=i.get("INT"),this.reset();var c=!0,d=!1,h=void 0;try{for(var v,f=this.ioPins[Symbol.iterator]();!(c=(v=f.next()).done);c=!0){var p=v.value,g=this;p.onValueChange((function(){(g.readValue()^g.prevValue)&g.inputMask&&(g.intPin.state=Z.J.Low)}))}}catch(m){d=!0,h=m}finally{try{c||null==f.return||f.return()}finally{if(d)throw h}}l.onConnect=function(){return n.firstWriteByte=!0,!0},l.onReadByte=function(){return n.intPin.state=Z.J.HighZ,n.readValue()},l.onWriteByte=function(t){if(!n.firstWriteByte)return!1;n.inputMask=t;for(var e=0;e<n.ioPins.length;e++)n.ioPins[e].state=t&1<<e?Z.J.PullUp:Z.J.Low;return n.firstWriteByte=!1,n.intPin.state=Z.J.HighZ,!0}}return(0,a.Z)(t,[{key:"readValue",value:function(){for(var t=0,e=0;e<this.ioPins.length;e++)t|=this.ioPins[e].value?1<<e:0;return t}},{key:"update",value:function(){return null}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.ioPins[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.state=Z.J.PullUp}}catch(a){e=!0,i=a}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}this.inputMask=255,this.prevValue=this.readValue(),this.intPin.state=Z.J.HighZ}}]),t}();(0,s.Z)(Le,"pinNames",["A0","A1","A2","GND","INT"].concat((0,d.Z)(Ve),["SCL","SDA","VCC"]));var Fe=i(41812),Je=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ledController",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={led:0};var n=new Map,a=i.get("TP5"),o=i.get("GND");n.set("A",a),n.set("C",o),this.ledController=new N(this.clock,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ledController.update();return t&&(this.value.led=t.value,this.updated=!0),this.updated?{value:(0,u.Z)({},this.value)}:null}},{key:"reset",value:function(){this.ledController.reset(),this.value.led=0,this.updated=!0}}]),t}();(0,s.Z)(Je,"pinNames",["TP5","GND"]);var Ke=function(){function t(e,i,n){var a,o;(0,r.Z)(this,t),(0,s.Z)(this,"outPin",void 0),(0,s.Z)(this,"retrigger",void 0),(0,s.Z)(this,"delayTime",void 0),(0,s.Z)(this,"inhibitTime",void 0),(0,s.Z)(this,"active",void 0),(0,s.Z)(this,"motionTimeout",void 0),(0,s.Z)(this,"inhibitTimeout",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.active=!1,this.motionTimeout=0,this.inhibitTimeout=0,this.outPin=i.get("OUT"),this.outPin.setState(Z.J.Low),this.retrigger="0"!==n.get("retrigger"),this.delayTime=parseFloat(null!==(a=n.get("delayTime"))&&void 0!==a?a:"5")||5,this.inhibitTime=parseFloat(null!==(o=n.get("inhibitTime"))&&void 0!==o?o:"1.2")||1.2}return(0,a.Z)(t,[{key:"onEvent",value:function(t){if("motion"===t.type){var e=this;if(this.active&&!this.retrigger)return;if(!this.active&&this.clock.cpuMillis<this.inhibitTimeout)return;this.active=!0,this.motionTimeout=this.clock.cpuNanos+1e9*this.delayTime,this.inhibitTimeout=this.clock.cpuMillis+1e3*(this.delayTime+this.inhibitTime),this.outPin.setState(Z.J.High),this.clock.addEvent(1e9*this.delayTime+10,(function(){e.clock.cpuNanos>e.motionTimeout&&(e.outPin.setState(Z.J.Low),e.active=!1)}))}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Ke,"pinNames",["OUT"]);var We=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"sig",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.value=null,this.sig=i.get("SIG")}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=t.value;this.sig.node.analogPort.writeNormalized(e/1023)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(We,"pinNames",["SIG"]);var He=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e,i.get("GND").setState(Z.J.Low),i.get("VCC").setState(Z.J.High)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(He,"pinNames",["GND","VCC"]);var qe=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"bridge",void 0);var a=i.get("1"),o=i.get("2"),u="0"!==n.get("bounce");this.bridge=vt(e,a,o,u)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){this.bridge.connected="press"===t.type}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(qe,"pinNames",["1","2"]);var Ge=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"no1Bridge",void 0),(0,s.Z)(this,"nc1Bridge",void 0),(0,s.Z)(this,"no2Bridge",void 0),(0,s.Z)(this,"nc2Bridge",void 0),(0,s.Z)(this,"currentState",!1),(0,s.Z)(this,"nextState",!1);var o=i.get("COIL1"),u=i.get("COIL2"),l=i.get("P1"),c=i.get("P2"),d="1"===n.get("bounce");this.no1Bridge=vt(e,l,i.get("NO1"),d),this.nc1Bridge=vt(e,l,i.get("NC1"),d),this.no2Bridge=vt(e,c,i.get("NO2"),d),this.nc2Bridge=vt(e,c,i.get("NC2"),d);var h=e.createEvent((function(){a.currentState=a.nextState,a.updatePoles()})),v=function(){var t=o.driven&&u.driven&&o.value!=u.value,e=t?5e6:15e6;a.nextState=t,t!==a.currentState&&h.schedule(e)};o.onStateChange(v),u.onStateChange(v),this.updatePoles()}return(0,a.Z)(t,[{key:"updatePoles",value:function(){var t=this.currentState;this.no1Bridge.connected=t,this.no2Bridge.connected=t,this.nc1Bridge.connected=!t,this.nc2Bridge.connected=!t}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.currentState=!1,this.nextState=!1,this.updatePoles()}}]),t}();function ze(t){switch(t.state){case Z.J.High:return Z.J.PullUp;case Z.J.Low:return Z.J.PullDown;default:return Z.J.HighZ}}(0,s.Z)(Ge,"pinNames",["COIL1","COIL2","P1","NO1","NC1","P2","NO2","NC2"]);var Xe=function(){function t(e,i){(0,r.Z)(this,t);var n=i.get("1"),a=i.get("2");n.setState(ze(a)),a.setState(ze(n)),n.onStateChange((function(){a.setState(ze(n))})),a.onStateChange((function(){n.setState(ze(a))}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Xe,"pinNames",["1","2"]);var je=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"r",void 0),(0,s.Z)(this,"g",void 0),(0,s.Z)(this,"b",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"attrs",void 0),this.clock=e,this.attrs=n,this.value={r:0,g:0,b:0};var a="cathode"===n.get("common"),o=i.get("COM");this.r=this.createLED(i.get("R"),o,a),this.g=this.createLED(i.get("G"),o,a),this.b=this.createLED(i.get("B"),o,a)}return(0,a.Z)(t,[{key:"createLED",value:function(t,e,i){var n=new Map;n.set("A",i?t:e),n.set("C",i?e:t);var r=new Map,a=this.attrs.get("fps");return a&&r.set("fps",a),new N(this.clock,n,r)}},{key:"update",value:function(){var t=this.r.update(),e=this.g.update(),i=this.b.update();return t&&(this.value.r=t.value),e&&(this.value.g=e.value),i&&(this.value.b=i.value),t||e||i?{value:this.value}:null}},{key:"reset",value:function(){this.r.reset(),this.g.reset(),this.b.reset()}}]),t}();(0,s.Z)(je,"pinNames",["COM","R","G","B"]);var Qe=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"dialing",void 0),(0,s.Z)(this,"pulsing",void 0),(0,s.Z)(this,"pulses",void 0),(0,s.Z)(this,"dial",void 0),(0,s.Z)(this,"pulse",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.dialing=!1,this.pulsing=!1,this.pulses=0,this.value="",this.dial=i.get("DIAL"),this.pulse=i.get("PULSE")}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.dial,e=this.pulse;return this.dialing&&(this.pulses?this.pulsing?(e.setState(Z.J.HighZ),this.pulsing=!1,this.pulses--):(e.setState(Z.J.Low),this.pulsing=!0):(t.setState(Z.J.HighZ),this.dialing=!1)),null}},{key:"reset",value:function(){this.dialing=!1,this.pulsing=!1}},{key:"onEvent",value:function(t){var e=t.digit;this.dial.setState(Z.J.Low),this.pulses=e>0?e:10,this.dialing=!0,this.pulsing=!1}}]),t}();(0,s.Z)(Qe,"pinNames",["GND","DIAL","PULSE"]);var $e=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];function Ye(t){for(var e=0,i=0;i<t.length;i++)e=$e[255&(e>>8^t[i])]^e<<8;return 65535&e}var ti,ei,ii,ni,ri,ai=512;!function(t){t[t.Ready=0]="Ready",t[t.Command=1]="Command",t[t.Write=2]="Write",t[t.WriteData=3]="WriteData"}(ti||(ti={})),function(t){t[t.GO_IDLE_STATE=0]="GO_IDLE_STATE",t[t.SEND_OP_COND=1]="SEND_OP_COND",t[t.SEND_IF_COND=8]="SEND_IF_COND",t[t.SEND_CSD=9]="SEND_CSD",t[t.SEND_CID=10]="SEND_CID",t[t.STOP_TRANSMISSION=12]="STOP_TRANSMISSION",t[t.SEND_STATUS=13]="SEND_STATUS",t[t.SET_BLOCKLEN=16]="SET_BLOCKLEN",t[t.READ_SINGLE_BLOCK=17]="READ_SINGLE_BLOCK",t[t.READ_MULTIPLE_BLOCK=18]="READ_MULTIPLE_BLOCK",t[t.SET_BLOCK_COUNT=23]="SET_BLOCK_COUNT",t[t.WRITE_BLOCK=24]="WRITE_BLOCK",t[t.WRITE_MULTIPLE_BLOCK=25]="WRITE_MULTIPLE_BLOCK",t[t.APP_CMD=55]="APP_CMD",t[t.READ_OCR=58]="READ_OCR",t[t.CRC_ON_OFF=59]="CRC_ON_OFF",t[t.INVALID=255]="INVALID"}(ei||(ei={})),function(t){t[t.SET_WR_BLOCK_ERASE_COUNT=23]="SET_WR_BLOCK_ERASE_COUNT",t[t.APP_SEND_OP_COND=41]="APP_SEND_OP_COND",t[t.APP_CLR_CARD_DETECT=42]="APP_CLR_CARD_DETECT",t[t.APP_SEND_SCR=51]="APP_SEND_SCR"}(ii||(ii={})),function(t){t[t.Idle=1]="Idle",t[t.CRCError=8]="CRCError"}(ni||(ni={})),function(t){t[t.OutOfRange=128]="OutOfRange"}(ri||(ri={}));var si=254,oi=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"currentCommand",void 0),(0,s.Z)(this,"commandBuffer",void 0),(0,s.Z)(this,"commandBufferIndex",void 0),(0,s.Z)(this,"responseBuffer",void 0),(0,s.Z)(this,"responseBufferIndex",void 0),(0,s.Z)(this,"responseBufferCount",void 0),(0,s.Z)(this,"appCommand",void 0),(0,s.Z)(this,"idle",void 0),(0,s.Z)(this,"writeAddress",void 0),(0,s.Z)(this,"writeBuffer",void 0),(0,s.Z)(this,"writeBufferIndex",void 0),(0,s.Z)(this,"crcEnabled",void 0),(0,s.Z)(this,"r2Value",void 0),(0,s.Z)(this,"processByte",void 0),(0,s.Z)(this,"spi",void 0),(0,s.Z)(this,"storage",void 0),this.spi=e,this.storage=i,this.state=ti.Ready,this.currentCommand=ei.INVALID,this.commandBuffer=new Uint8Array(5),this.commandBufferIndex=0,this.responseBuffer=new Uint8Array(1024),this.responseBufferIndex=0,this.responseBufferCount=0,this.appCommand=!1,this.idle=!0,this.writeAddress=0,this.writeBuffer=new Uint8Array(514),this.writeBufferIndex=0,this.crcEnabled=!1,this.r2Value=0,this.processByte=function(t){switch(n.state){case ti.Ready:64===(192&t)&&(n.currentCommand=63&t,n.commandBufferIndex=0,n.state=ti.Command);break;case ti.Command:n.commandBuffer[n.commandBufferIndex++]=t,n.commandBufferIndex===n.commandBuffer.length&&(n.state=ti.Ready,n.processCommand());break;case ti.Write:t===si?(n.state=ti.WriteData,n.writeBufferIndex=0):255!==t&&(n.state=ti.Ready);break;case ti.WriteData:if(n.writeBuffer[n.writeBufferIndex++]=t,n.writeBufferIndex===n.writeBuffer.length){var e=n.writeBuffer.subarray(0,ai),i=n.writeBuffer[512]<<8|n.writeBuffer[513];n.state=ti.Ready,n.r2Value=0,n.crcEnabled&&i!==Ye(e)?n.respond([11]):n.writeAddress>=n.storage.blockCount?(n.r2Value=ri.OutOfRange,n.respond([13])):(n.storage.writeBlock(n.writeAddress,e),n.respond([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255]))}}n.responseBufferIndex<n.responseBufferCount?(n.spi.sendByte(n.responseBuffer[n.responseBufferIndex]),n.responseBufferIndex++):n.spi.sendByte(255)},e.onTransmit=this.processByte}return(0,a.Z)(t,[{key:"R1Flags",get:function(){return this.idle?ni.Idle:0}},{key:"uintParam",get:function(){return(this.commandBuffer[0]<<24|this.commandBuffer[1]<<16|this.commandBuffer[2]<<8|this.commandBuffer[3])>>>0}},{key:"crcCheck",value:function(){var t=this.commandBuffer,e=function(t){for(var e=0,i=0;i<t.length;i++)for(var n=t[i],r=0;r<8;r++)128&n^128&(e<<=1)&&(e^=9),n<<=1;return 127&e}([64|this.currentCommand,t[0],t[1],t[2],t[3]]);return t[4]===(e<<1|1)}},{key:"respond",value:function(t){this.responseBuffer.set(t),this.responseBufferIndex=0,this.responseBufferCount=t.length}},{key:"processCommand",value:function(){if(!this.crcEnabled||this.crcCheck()){if(this.appCommand)return this.appCommand=!1,void this.processAppCommand();switch(this.currentCommand){case ei.GO_IDLE_STATE:if(this.idle=!0,!this.crcCheck())return void this.respond([255,this.R1Flags|ni.CRCError]);this.respond([255,this.R1Flags]);break;case ei.SEND_IF_COND:if(!this.crcCheck())return void this.respond([255,this.R1Flags|ni.CRCError,0,0,0,0]);var t=this.commandBuffer[3];this.respond([255,this.R1Flags,0,0,1,t]);break;case ei.READ_OCR:this.respond([255,this.R1Flags,192,255,128,0]);break;case ei.SEND_CSD:this.respond([255,this.R1Flags,si].concat((0,d.Z)(this.csd)));break;case ei.SEND_CID:this.respond([255,this.R1Flags,si].concat((0,d.Z)(this.cid)));break;case ei.SEND_STATUS:this.respond([255,this.R1Flags,this.r2Value]);break;case ei.APP_CMD:this.appCommand=!0,this.respond([255,this.R1Flags]);break;case ei.CRC_ON_OFF:this.crcEnabled=!!(1&this.commandBuffer[3]),this.respond([255,this.R1Flags]);break;case ei.STOP_TRANSMISSION:this.respond([255,this.R1Flags]);break;case ei.READ_SINGLE_BLOCK:case ei.READ_MULTIPLE_BLOCK:var e=this.uintParam;if(e>=this.storage.blockCount)return void this.respond([255,this.R1Flags,128]);this.respond([255,this.R1Flags,255,255,255,255,si]);var i=this.storage.readBlock(e),n=Ye(i);this.responseBuffer.set(i,this.responseBufferCount),this.responseBufferCount+=512,this.responseBuffer[this.responseBufferCount++]=n>>8,this.responseBuffer[this.responseBufferCount++]=255&n;break;case ei.WRITE_BLOCK:this.writeAddress=this.uintParam,this.respond([255,this.R1Flags]),this.state=ti.Write;break;default:console.warn("Unimplemented SD Command: 0x".concat(this.currentCommand.toString(16)))}}else this.respond([255,this.R1Flags|ni.CRCError])}},{key:"processAppCommand",value:function(){switch(this.currentCommand){case ii.APP_SEND_OP_COND:this.idle=!1,this.respond([255,this.R1Flags]);break;case ii.APP_CLR_CARD_DETECT:this.respond([255,this.R1Flags]);break;case ii.APP_SEND_SCR:this.respond([255,this.R1Flags,si].concat((0,d.Z)(this.scr)));break;default:console.warn("Unimplemented SD APP Command: 0x".concat(this.currentCommand.toString(16)))}}},{key:"csd",get:function(){var t=Math.ceil(this.storage.blockCount/1024)-1,e=new Uint8Array(18);return e[0]=64,e[1]=14,e[2]=0,e[3]=90,e[4]=91,e[5]=9,e[6]=0,e[7]=t>>16&255,e[8]=t>>8&255,e[9]=255&t,e[10]=64,e[11]=128,e[12]=10,e[13]=64,e[14]=0,e[15]=0,e[16]=137,e[17]=49,e}},{key:"cid",get:function(){var t=new Uint8Array(18);return t[0]=66,t[1]=67,t[2]=77,t[3]=87,t[4]=79,t[5]=75,t[6]=87,t[7]=73,t[8]=16,t[9]=254,t[10]=202,t[11]=254,t[12]=202,t[13]=1,t[14]=185,t[15]=0,t[16]=82,t[17]=162,t}},{key:"scr",get:function(){return new Uint8Array([0,0,0,0,0,0,0,0,0,0])}}]),t}(),ui=16384,li=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"data",new Uint8Array(8388608)),(0,s.Z)(this,"sdcardProtocol",void 0),(0,s.Z)(this,"blockCount",ui);var n=new b({mosi:i.get("DI"),miso:i.get("DO"),clk:i.get("SCK"),ss:i.get("CS")},0,!0);this.sdcardProtocol=new oi(n,this)}return(0,a.Z)(t,[{key:"init",value:function(e){var i=e.files,r=this;return(0,n.Z)(f().mark((function e(){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(n=t.files)||void 0===n?void 0:n.length)){e.next=6;break}return e.next=4,r.initFS(t.files);case 4:e.next=8;break;case 6:return e.next=8,r.initFS(i);case 8:case"end":return e.stop()}}),e)})))()}},{key:"initFS",value:function(t){var e=this;return(0,n.Z)(f().mark((function n(){var r;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([i.e(4102),i.e(9829)]).then(i.bind(i,59829));case 2:return r=n.sent.makeFatFS,n.next=5,r({flash:e.data,numBlocks:ui,blockSize:ai,noFat12:!0},t);case 5:case"end":return n.stop()}}),n)})))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}},{key:"readBlock",value:function(t){return this.data.subarray(t*ai,(t+1)*ai)}},{key:"writeBlock",value:function(t,e){this.data.set(e,t*ai)}}]),t}();(0,s.Z)(li,"pinNames",["CS","SCK","DI","DO","CD"]),(0,s.Z)(li,"files",void 0);var ci=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"currentPromise",null),(0,s.Z)(this,"currentController",null),e.subscribe((function(t){var e,n,r;null===(e=i.currentController)||void 0===e||e.enqueue(t),null===(r=(n=i).currentPromise)||void 0===r||r.call(n),i.currentPromise=null}))}return(0,a.Z)(t,[{key:"pull",value:function(t){var e=this;return new Promise((function(i){e.currentController=t,e.currentPromise=i}))}},{key:"cancel",value:function(){var t;this.currentController=null,null===(t=this.currentPromise)||void 0===t||t.call(this),this.currentPromise=null}}]),t}(),di=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"queue",void 0),(0,s.Z)(this,"sendNextByte",void 0),(0,s.Z)(this,"encoder",void 0),this.encoder=e,this.queue=[],this.sendNextByte=function(){var t=i.queue.shift();null!=t&&i.encoder.transmit(t)},e.onTxComplete=this.sendNextByte}return(0,a.Z)(t,[{key:"write",value:function(t){var e;(e=this.queue).push.apply(e,(0,d.Z)(t)),this.encoder.isBusy||this.sendNextByte()}}]),t}(),hi=function(){function t(e,i,n){var a;(0,r.Z)(this,t),(0,s.Z)(this,"abort",new AbortController),(0,s.Z)(this,"cleanup",null),(0,s.Z)(this,"encoder",void 0),(0,s.Z)(this,"decoder",void 0);var o=parseInt(null!==(a=n.get("baud"))&&void 0!==a?a:"",10)||9600;this.encoder=new H.x(e,i.get("TX"),o),this.decoder=new W.g(e,i.get("RX"),o),this.initSerial(o).catch(console.error)}return(0,a.Z)(t,[{key:"initSerial",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var r,a,s,o;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("undefined"!==typeof navigator.serial){i.next=2;break}throw new Error("Serial API not supported in this browser");case 2:return i.next=4,navigator.serial.requestPort({});case 4:if((r=i.sent).addEventListener("disconnect",(function(){e.cleanup=null})),r.readable){i.next=9;break}return i.next=9,r.open({baudRate:t});case 9:r.writable&&(s=null===(a=r.readable)||void 0===a?void 0:a.pipeTo(new WritableStream(new di(e.encoder)),{signal:e.abort.signal}).catch((function(){})),o=new ReadableStream(new ci(e.decoder)).pipeTo(r.writable,{signal:e.abort.signal}).catch((function(){})),e.cleanup=(0,n.Z)(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s;case 2:return t.next=4,o;case 4:return t.next=6,r.close();case 6:case"end":return t.stop()}}),t)}))));case 10:case"end":return i.stop()}}),i)})))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){var t=this;return(0,n.Z)(f().mark((function e(){var i,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.abort.abort(),null===(n=(i=t).cleanup)||void 0===n||n.call(i).catch(console.error),t.cleanup=null;case 4:case"end":return e.stop()}}),e)})))()}}]),t}();(0,s.Z)(hi,"pinNames",["RX","TX","GND"]);var vi=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"angle",90),(0,s.Z)(this,"updated",!0),(0,s.Z)(this,"min",544),(0,s.Z)(this,"max",2400),(0,s.Z)(this,"margin",88),i.get("PWM").onValueChange((function(t,e){var i=e.nanos;if(!t){var r=n.min,a=n.max,s=n.margin,o=i/1e3;if(o<r-s||o>a+s)return;var u=((0,K.u)(o,r,a)-r)/(a-r);n.angle=Math.round(180*u),n.updated=!0}}))}return(0,a.Z)(t,[{key:"update",value:function(){return this.updated?(this.updated=!1,{value:this.angle}):null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(vi,"pinNames",["PWM"]);var fi=["A","B","C","D","E","F","G","DP"],pi=["DIG1","DIG2","DIG3","DIG4"],gi=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"leds",void 0),(0,s.Z)(this,"colonLed",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.leds=[],this.value={segments:[],colon:0};var a=fi.map((function(t){return i.get(t)})),o=pi.map((function(t){return i.attached(t)?i.get(t):null})),u="cathode"===n.get("common"),l=u?"C":"A",c=u?"A":"C";o[0]||(o[0]=i.get("COM"));for(var d=0;d<o.length;d++){var h=o[d];if(h)for(var v=0;v<a.length;v++){var f=a[v],p=new Map;p.set(l,h),p.set(c,f),this.leds[d*a.length+v]=new N(e,p,n)}}var g=i.get("CLN"),m=i.get("COM"),y=new Map;y.set(l,m),y.set(c,g),this.colonLed=new N(e,y,n)}return(0,a.Z)(t,[{key:"update",value:function(){for(var t=!1,e=0;e<this.leds.length;e++){var i,n=null===(i=this.leds[e])||void 0===i?void 0:i.update();n&&(this.value.segments[e]=n.value,t=!0)}var r=this.colonLed.update();return r&&(this.value.colon=r.value,t=!0),t?{value:this.value}:null}},{key:"reset",value:function(){var t,e=!0,i=!1,n=void 0;try{for(var r,a=this.leds[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;null===s||void 0===s||s.reset()}}catch(o){i=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}null===(t=this.colonLed)||void 0===t||t.reset()}}]),t}();(0,s.Z)(gi,"pinNames",(0,d.Z)(fi).concat((0,d.Z)(pi),["COM","CLN"]));var mi=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"bridge1",void 0),(0,s.Z)(this,"bridge2",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var a,o=i.get("1"),u=i.get("2"),l=i.get("3"),c=1===parseInt(null!==(a=n.get("value"))&&void 0!==a?a:"0",10),d="0"!==n.get("bounce");this.bridge1=vt(e,o,u,d),this.bridge1.connected=!c,this.bridge2=vt(e,u,l,d),this.bridge2.connected=c}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this.bridge1,i=this.bridge2,n=t.value?e:i,r=t.value?i:e;n.connected=!1;var a=(0,o.Z)(n,ht)?n.bounceDuration:0;this.clock.addEvent(a+42e4,(function(){r.connected=!0}))}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(mi,"pinNames",["1","2","3"]);var yi=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.get("DIN"),a=i.get("DOUT");this.ws2812Decoder=new L(n,e,a),this.ws2812Decoder.resize(256)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ws2812Decoder.update();return t?{value:t.slice(0,256)}:null}},{key:"reset",value:function(){var t;null===(t=this.ws2812Decoder)||void 0===t||t.reset()}}]),t}();(0,s.Z)(yi,"pinNames",["DIN","VDD","VSS","DOUT"]);var wi,ki=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"decoder",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.value={ledPower:1,ledRed:0,ledGreen:0,ledBlue:.1},this.decoder=new C({clock:i.get("$APA_CLK"),data:i.get("$APA_DATA"),ss:i.get("$APA_PWR")})}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.decoder.update();if(t){var e=t[0],i=(e>>>24)/255,n=e>>16&255,r=e>>8&255,a=255&e;return this.value.ledRed=Math.pow(a/256*i,.5),this.value.ledGreen=Math.pow(r/256*i,.5),this.value.ledBlue=Math.pow(n/256*i,.5),{value:this.value}}return null}},{key:"reset",value:function(t){this.value.ledRed=0,this.value.ledGreen=0,this.value.ledBlue=0,t&&(this.value.ledPower=0)}}]),t}();(0,s.Z)(ki,"pinNames",["$APA_PWR","$APA_CLK","$APA_DATA","GND"]),function(t){t[t.Idle=0]="Idle",t[t.Active=1]="Active",t[t.Ack=2]="Ack"}(wi||(wi={}));var Zi=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"bytes",new Uint8Array(4)),(0,s.Z)(this,"segments",new Uint8Array(32)),(0,s.Z)(this,"state",wi.Idle),(0,s.Z)(this,"clockIndex",0),(0,s.Z)(this,"incomingByte",0),(0,s.Z)(this,"isCommand",!0),(0,s.Z)(this,"addrAuto",!1),(0,s.Z)(this,"addr",0),(0,s.Z)(this,"on",!1),(0,s.Z)(this,"brightness",0);var a=i.get("CLK"),o=i.get("DIO");a.setState(Z.J.PullUp),o.setState(Z.J.PullUp),o.onValueChange((function(t){a.value&&!t&&(n.state=wi.Active,n.clockIndex=0,n.incomingByte=0),a.value&&t&&n.state!==wi.Ack&&(n.state=wi.Idle,n.isCommand=!0)})),a.onValueChange((function(t){if(t&&n.state===wi.Active)return n.incomingByte>>=1,n.incomingByte|=o.value?128:0,n.clockIndex++,void(8===n.clockIndex&&(n.isCommand?n.processCommand(n.incomingByte):n.processData(n.incomingByte),n.isCommand=!1,n.state=wi.Ack,n.clockIndex=0,n.incomingByte=0));n.state==wi.Ack&&(o.setState(t?Z.J.PullUp:Z.J.PullDown),t&&(n.state=wi.Active))}))}return(0,a.Z)(t,[{key:"processCommand",value:function(t){if(128!==(192&t))if(192!==(192&t))switch(t){case 64:this.addrAuto=!0;break;case 68:this.addrAuto=!1}else this.addr=15&t;else{var e=!!(8&t),i=7&t;e===this.on&&i===this.brightness||(this.on=e,this.brightness=i,this.updated=!0)}}},{key:"processData",value:function(t){this.addr<4&&this.bytes[this.addr]!==t&&(this.bytes[this.addr]=t,this.updated=!0),this.addrAuto&&(this.addr=(this.addr+=1)%15)}},{key:"update",value:function(){if(this.updated){this.updated=!1;for(var t=!1,e=0;e<4;e++){for(var i=0;i<7;i++)this.segments[8*e+i]=this.bytes[e]&1<<i?1:0;128&this.bytes[e]&&(t=!0)}return this.on||(this.segments.fill(0),t=!1),{value:{segments:this.segments,colon:t,brightness:this.normalizedBrightness}}}return null}},{key:"normalizedBrightness",get:function(){switch(this.brightness){case 0:return.5;case 1:return.7;default:return 1}}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Zi,"pinNames",["CLK","DIO"]);var bi=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.get("IN"),a=i.get("EN"),o=i.get("OUT");st([n,a],(function(){return a.value?n.value?Z.J.High:Z.J.Low:Z.J.HighZ}),(function(t){return o.setState(t)}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(bi,"pinNames",["IN","EN","OUT"]);var Ci=768,xi=4278190080,Si=64e3,_i=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"lineStart",0),(0,s.Z)(this,"oddField",!1),(0,s.Z)(this,"y",0),(0,s.Z)(this,"lastX",0),(0,s.Z)(this,"pixels",new Uint32Array(442368)),(0,s.Z)(this,"lastSync",0),(0,s.Z)(this,"lastVSync",0),(0,s.Z)(this,"nextColor",xi);var a=i.get("IN");i.get("SYNC").onValueChange((function(t){if(t){var i=e.cpuNanos-n.lastSync;if(i>3200&&i<5800){n.y>=0&&n.pixels.fill(n.nextColor,n.y*Ci+n.lastX,(n.y+1)*Ci);var r=e.cpuNanos-n.lastVSync,a=n.oddField?0:1;n.y=2*Math.round(r/Si-22)+a,n.lineStart=e.cpuNanos+4700+5200,n.lastX=0}if(i>17e3&&i<62e3)e.cpuNanos-n.lastVSync>64e4&&(n.lastX=0,n.oddField=!n.oddField,n.lastVSync=e.cpuNanos)}n.lastSync=e.cpuNanos})),this.pixels.fill(xi),a.onValueChange((function(t){var i=e.cpuNanos-n.lineStart;if(i>0&&n.y>=0){var r=Math.min(i/51900*Ci*1.0909,Ci),a=n.y*Ci;n.pixels.fill(n.nextColor,a+n.lastX,a+r),n.lastX=r}n.nextColor=t?4294967295:xi}))}return(0,a.Z)(t,[{key:"update",value:function(){return{value:{pixels:this.pixels}}}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(_i,"pinNames",["IN","SYNC","GND"]);var Pi={"wokwi-analog-joystick":ft,"wokwi-dht22":Tt,"wokwi-led":N,"wokwi-neopixel":Ue,"wokwi-led-ring":Ue,"wokwi-buzzer":Pt,"wokwi-led-matrix":Ee,"wokwi-lcd1602":de,"wokwi-lcd2004":he,"wokwi-neopixel-meter":ye,"wokwi-arduino-uno":mt,"wokwi-arduino-mega":mt,"wokwi-arduino-nano":mt,"wokwi-esp32-devkit-v1":Ft,"wokwi-franzininho":Wt,"wokwi-mpu6050":Be._,"wokwi-midi-player":Re,"wokwi-ir-receiver":te,"wokwi-ir-remote":ee,"wokwi-il9163":$t,"wokwi-ili9341":U,"wokwi-pi-pico":Je,"wokwi-pir-motion-sensor":Ke,"wokwi-pushbutton":qe,"wokwi-microsd-card":li,"wokwi-slide-switch":mi,"wokwi-servo":vi,"wokwi-ssd1306":V,"wokwi-max7219-matrix":_e,"wokwi-microphone":Ae,"wokwi-neopixel-matrix":Ee,"wokwi-neopixel-canvas":Ee,"wokwi-neopixel-strip":Ue,"wokwi-neopixel-serial":Ue,"wokwi-ntc-temperature-sensor":Oe,"wokwi-potentiometer":We,"wokwi-slide-potentiometer":We,"wokwi-hc-sr04":Ht,"wokwi-ds1307":Lt,"wokwi-membrane-keypad":Ie,"wokwi-resistor":Xe,"wokwi-rotary-dialer":Qe,"wokwi-7segment":gi,"wokwi-74hc165":qt,"wokwi-74hc595":Gt,"wokwi-nlsf595":Te,"wokwi-tv":_i,"wokwi-logic-analyzer":be,"wokwi-splendida":yi,"wokwi-photoresistor-sensor":Fe.l,"wokwi-ky-040":ne,"wokwi-rgb-led":je,"wokwi-serial-port":hi,"wokwi-tinypico":ki,"wokwi-hub75-matrix":Xt.al,"wokwi-apa102-matrix":gt,"wokwi-led-bar-graph":ve,"wokwi-dip-switch-8":Ot,"wokwi-pcf8574":Le,"wokwi-hx711":jt.j,"wokwi-ks2e-m-dc5":Ge,"wokwi-stepper-motor":Ct,"wokwi-a4988":lt,"wokwi-esp-01":Q,"wokwi-gnd":He,"wokwi-vcc":He,"wokwi-gate-not":Ce((function(t){return!(0,c.Z)(t,1)[0].value}),["IN"]),"wokwi-gate-buffer":Ce((function(t){return(0,c.Z)(t,1)[0].value}),["IN"]),"wokwi-gate-and-2":Ce((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return i.value&&n.value})),"wokwi-gate-or-2":Ce((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return i.value||n.value})),"wokwi-gate-xor-2":Ce((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return i.value!=n.value})),"wokwi-gate-nand-2":Ce((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return!(i.value&&n.value)})),"wokwi-mux-2":Ce((function(t){var e=(0,c.Z)(t,3),i=e[0],n=e[1];return e[2].value?n.value:i.value}),["A","B","SEL"]),"wokwi-tristate-buffer":bi,"wokwi-flip-flop-d":Jt,"wokwi-flip-flop-sr":Kt,"wokwi-flip-flop-dsr":Jt,"wokwi-clock-generator":It,"wokwi-tm1637-7segment":Zi,"wokwi-biaxial-stepper":xt,"wokwi-relay-module":Rt},Di=["esp32-devkit-v1","esp-01","franzininho-wifi","ili9341-cap-touch","ssd1306","pi-pico","notecarrier-a","esp32-devkit-c-v4","esp32-c3-devkitm-1","esp32-c3-rust-1","esp32-s2-devkitm-1","esp32-s3-devkitc-1","mch2022-badge","st-nucleo-l432kc","stm32-bluepill"],Ii=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"boards",{}),(0,s.Z)(this,"loading",{}),(0,p.ky)(this)}return(0,a.Z)(t,[{key:"loadFromUrl",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var n,r,a,s,o,u,l,c,d;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return n="".concat("https://wokwi.github.io/wokwi-boards/boards","/").concat(t),r="".concat(n,"/board.svg"),i.next=4,fetch("".concat(n,"/board.json?v=8"));case 4:return i.next=6,i.sent.text();case 6:a=i.sent,s="board-".concat(t),o=rt(s,a,r),u=o.board,l=o.svgURL,c=o.adapter,d=o.controller,e.boards[t]={board:u,svgURL:l},at.j[s]=c,Pi[s]=d;case 12:case"end":return i.stop()}}),i)})))()}},{key:"loadUserBoard",value:function(t,e){var i=this;return(0,n.Z)(f().mark((function n(){var r,a,s,o,u,l;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=rt(r="wokwi-custom-board",t,e),s=a.board,o=a.svgURL,u=a.adapter,l=a.controller,i.boards[r]={board:s,svgURL:o},at.j[r]=u,Pi[r]=l;case 5:case"end":return n.stop()}}),n)})))()}},{key:"loadBoards",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var n,r,a,s,o,u,l;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:for(n=[],r=!0,a=!1,s=void 0,i.prev=2,o=t[Symbol.iterator]();!(r=(u=o.next()).done);r=!0)(l=u.value)in e.boards||n.push(e.loadFromUrl(l));i.next=10;break;case 6:i.prev=6,i.t0=i.catch(2),a=!0,s=i.t0;case 10:i.prev=10,i.prev=11,r||null==o.return||o.return();case 13:if(i.prev=13,!a){i.next=16;break}throw s;case 16:return i.finish(13);case 17:return i.finish(10);case 18:return i.next=20,Promise.all(n);case 20:case"end":return i.stop()}}),i,null,[[2,6,10,18],[11,,13,17]])})))()}},{key:"get",value:function(t){var e=this.boards[t];if(!e&&!this.loading[t]&&Di.includes(t)){var i=this;this.loading[t]=!0,this.loadFromUrl(t).then((function(){i.loading[t]=!1}))}return e}},{key:"loaded",get:function(){return!Object.values(this.loading).some((function(t){return t}))}}]),t}(),Ai=i(91712),Ri=i(21831),Bi=i(74372),Ei=i(32122),Ui=i(84104),Ni="https://wokwi.github.io/wokwi-circuitpython-libraries",Ti="".concat(Ni,"/packages/7.x-mpy");function Oi(t,e){for(var i=[],n=new DataView(e),r=new TextDecoder,a=0;a<e.byteLength;){if(2003529559!==n.getUint32(a,!0)||810697065!==n.getUint32(a+4,!0))return console.error("Error extracting library ".concat(t,": Bad magic!")),i;a+=8;var s=n.getUint16(a,!0);a+=4;var o=n.getUint32(a,!0);a+=4;var u=r.decode(new Uint8Array(e,a,s));a+=s;var l=new Uint8Array(e,a,o);a+=o,i.push({name:"".concat("lib/").concat(u),content:l})}return i}function Mi(t){return Vi.apply(this,arguments)}function Vi(){return(Vi=(0,n.Z)(f().mark((function t(e){var i,n,r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.map((function(t){return fetch("".concat(Ti,"/").concat(t,".mpylib")).then((function(t){return t.arrayBuffer()})).then((function(e){return Oi(t,e)}))})),t.next=4,Promise.all(n);case 4:return r=t.sent,t.abrupt("return",(i=[]).concat.apply(i,(0,d.Z)(r)));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Li(t){return Fi.apply(this,arguments)}function Fi(){return Fi=(0,n.Z)(f().mark((function t(e){var i,n,r,a,s,o,u,l,c,d,h,v;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=new Set(e.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length&&!t.startsWith("#")})))).size){t.next=3;break}return t.abrupt("return",[]);case 3:return t.next=5,fetch("".concat(Ni,"/index.json"));case 5:return t.next=7,t.sent.json();case 7:n=t.sent.libs,r=Array.from(i);case 9:if(!(r.length>0)){t.next=34;break}if(a=r.shift()||"",s=n.find((function(t){return t.name===a}))){t.next=14;break}throw new Error("Library not found in index: ".concat(a));case 14:for(u=!0,l=!1,c=void 0,t.prev=16,d=(null!==(o=null===s||void 0===s?void 0:s.deps)&&void 0!==o?o:[])[Symbol.iterator]();!(u=(h=d.next()).done);u=!0)v=h.value,i.has(v)||i.add(v);t.next=24;break;case 20:t.prev=20,t.t0=t.catch(16),l=!0,c=t.t0;case 24:t.prev=24,t.prev=25,u||null==d.return||d.return();case 27:if(t.prev=27,!l){t.next=30;break}throw c;case 30:return t.finish(27);case 31:return t.finish(24);case 32:t.next=9;break;case 34:return t.abrupt("return",Mi(Array.from(i)));case 35:case"end":return t.stop()}}),t,null,[[16,20,24,32],[25,,27,31]])}))),Fi.apply(this,arguments)}var Ji=i(26783),Ki=i(95863),Wi=i(56498),Hi=i(53124),qi=i(49006),Gi=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"onChange",void 0),this.name=e,this.onChange=i}return(0,a.Z)(t,[{key:"attach",value:function(t){t.state=Z.J.PullUp,t.onValueChange(this.onChange)}}]),t}(),zi=i(99941),Xi=i(26017);var ji=i(99569),Qi=i(3776),$i=new WeakMap,Yi=new WeakMap,tn=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"master",void 0),(0,_.Z)(this,$i,{writable:!0,value:void 0}),(0,_.Z)(this,Yi,{writable:!0,value:void 0}),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"twi",void 0),(0,s.Z)(this,"avrPins",void 0),this.clock=e,this.twi=i,this.avrPins=n,(0,P.Z)(this,$i,!1),(0,P.Z)(this,Yi,{scl:new Z.U(new ji.Y(this.clock),"$dummy:$scl"),sda:new Z.U(new ji.Y(this.clock),"$dummy:$sda")}),this.master=new Qi.n(e,(0,S.Z)(this,Yi)),i.eventHandler=this}return(0,a.Z)(t,[{key:"gate",value:function(t){this.avrPins.scl&&(this.avrPins.scl.gated=t),this.avrPins.sda&&(this.avrPins.sda.gated=t)}},{key:"start",value:function(){var t=this;if(!(0,S.Z)(this,$i)){var e,i,n=null===(e=this.avrPins.scl)||void 0===e?void 0:e.netPin,r=null===(i=this.avrPins.sda)||void 0===i?void 0:i.netPin;n&&((0,S.Z)(this,Yi).scl=n),r&&((0,S.Z)(this,Yi).sda=r),(0,P.Z)(this,$i,!0)}this.master.frequency=this.twi.sclFrequency,this.gate(!0),this.master.start((function(){t.twi.completeStart()}))}},{key:"stop",value:function(){var t=this;this.master.stop((function(){t.gate(!1),t.twi.completeStop()}))}},{key:"connectToSlave",value:function(t,e){var i=this;this.master.connect(t,e,(function(t){i.twi.completeConnect(t)}))}},{key:"writeByte",value:function(t){var e=this;this.master.write(t,(function(t){e.twi.completeWrite(t)}))}},{key:"readByte",value:function(t){var e=this;this.master.read(t,(function(t){e.twi.completeRead(t)}))}}]),t}(),en=i(29182);function nn(t){return t.parityEnabled?t.parityOdd?en.A.Odd:en.A.Even:en.A.None}var rn=new WeakMap,an=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"net",void 0),(0,s.Z)(this,"signals",void 0),(0,_.Z)(this,rn,{writable:!0,value:void 0}),(0,s.Z)(this,"usartIndex",void 0),(0,s.Z)(this,"gated",void 0),(0,s.Z)(this,"runner",void 0),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"config",void 0),this.runner=e,this.name=i,this.config=n,this.net=this.config.net,this.signals=this.config.signals,this.usartIndex=0,this.gated=!1}return(0,a.Z)(t,[{key:"attach",value:function(t){var e=this,i=this.config,n=this.runner,r=i.port,a=i.pin,s=i.signals;(0,P.Z)(this,rn,t),r.addListener((function(){e.gated||(t.state=function(t){switch(t){case Ki.tS.High:return Z.J.High;case Ki.tS.Low:return Z.J.Low;case Ki.tS.Input:return Z.J.HighZ;case Ki.tS.InputPullUp:return Z.J.PullUp}}(r.pinState(a)))})),r.setPin(a,t.value),t.onValueChange((function(t){r.setPin(a,t)}));var o=!0,u=!1,l=void 0;try{for(var c,d=this,h=function(e,i){var r=i.value;if("usart"===r.type&&"RX"===r.signal){var a=d,s=new W.g(d.runner,t);d.usartIndex=r.bus;var o=n.usart[r.bus],u=o.onConfigurationChange;o.onConfigurationChange=function(){s.baudRate=o.baudRate,s.bits=o.bitsPerChar,s.parity=nn(o),s.stopBits=o.stopBits,a.gated=o.rxEnable,o.rxEnable&&(t.state=Z.J.PullUp),null===u||void 0===u||u()},s.subscribe((function(t){o.writeByte(t[0],!0)}))}if("usart"===r.type&&"TX"===r.signal){var l=d,c=new H.x(d.runner,t);t.state=Z.J.HighZ;var h=!1;d.usartIndex=r.bus;var v=n.usart[r.bus],f=v.onConfigurationChange;v.onConfigurationChange=function(){c.baudRate=v.baudRate,c.bits=v.bitsPerChar,c.parity=nn(v),c.stopBits=v.stopBits,l.gated=v.txEnable,v.txEnable&&!h&&(t.state=Z.J.PullUp),h=v.txEnable,null===f||void 0===f||f()},v.onByteTransmit=function(t){c.transmit(t)}}},v=(null!==s&&void 0!==s?s:[])[Symbol.iterator]();!(o=(c=v.next()).done);o=!0)h(0,c)}catch(p){u=!0,l=p}finally{try{o||null==v.return||v.return()}finally{if(u)throw l}}var f=n.analogPins.indexOf(this.name);f>=0&&(n.adcPins[f]=t.node.analogPort)}},{key:"netPin",get:function(){return(0,S.Z)(this,rn)}}]),t}(),sn=i(16905),on=new WeakMap,un=new WeakMap,ln=function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"master",void 0),(0,_.Z)(this,on,{writable:!0,value:void 0}),(0,_.Z)(this,un,{writable:!0,value:void 0}),(0,s.Z)(this,"onTransfer",void 0),(0,s.Z)(this,"transferComplete",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"spi",void 0),(0,s.Z)(this,"avrPins",void 0),this.clock=e,this.spi=i,this.avrPins=n,(0,P.Z)(this,on,!1),(0,P.Z)(this,un,{mosi:new Z.U(new ji.Y(this.clock),"$dummy:$mosi"),miso:new Z.U(new ji.Y(this.clock),"$dummy:$miso"),clk:new Z.U(new ji.Y(this.clock),"$dummy:$clk")}),this.onTransfer=function(t){if(!(0,S.Z)(a,on)){var e,i,n,r=null===(e=a.avrPins.mosi)||void 0===e?void 0:e.netPin,s=null===(i=a.avrPins.miso)||void 0===i?void 0:i.netPin,o=null===(n=a.avrPins.sck)||void 0===n?void 0:n.netPin;r&&((0,S.Z)(a,un).mosi=r),s&&((0,S.Z)(a,un).miso=s),o&&((0,S.Z)(a,un).clk=o)}var u=1e9/a.spi.spiFrequency/2;return a.master.mode=a.spi.spiMode,a.master.transmit(t,a.transferComplete,u),0},this.transferComplete=function(t){a.spi.completeTransfer(t)},this.master=new sn.v(e,(0,S.Z)(this,un)),i.onByte=this.onTransfer},cn={CLKPR:70},dn={PIN:54,DDR:55,PORT:56,pinChange:{PCIE:5,PCICR:91,PCIFR:90,PCMSK:53,pinChangeInterrupt:2,mask:63,offset:0},externalInterrupts:[null,null,{EICRA:85,EICRB:0,EIMSK:91,EIFR:90,index:6,interrupt:1}]},hn={bits:8,captureInterrupt:0,TCCRA:74,TCCRB:83,TCCRC:0,TCNT:82,OCRA:73,OCRB:72,OCRC:0,ICR:0,TIFR:88,TIMSK:89,ovfInterrupt:5,compAInterrupt:10,compBInterrupt:11,compCInterrupt:0,compPortA:dn.PORT,compPinA:0,compPortB:dn.PORT,compPinB:1,compPortC:0,compPinC:0,externalClockPort:dn.PORT,externalClockPin:2,dividers:Ki.Jh.dividers,TOV:2,OCFA:16,OCFB:8,OCFC:0,TOIE:2,OCIEA:16,OCIEB:8,OCIEC:0},vn={eepromReadyInterrupt:6,EECR:60,EEDR:61,EEARL:62,EEARH:63,eraseCycles:14400,writeCycles:14400},fn={watchdogInterrupt:12,MCUSR:84,WDTCSR:33},pn=i(64295),gn={ADCSRA:38,ADCSRB:35,ADMUX:39,ADCL:36,ADCH:37,DIDR0:52,adcInterrupt:8,muxInputMask:15,numChannels:4,muxChannels:{0:{type:Ki.hp.SingleEnded,channel:0},1:{type:Ki.hp.SingleEnded,channel:1},2:{type:Ki.hp.SingleEnded,channel:2},3:{type:Ki.hp.SingleEnded,channel:3},4:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:2,gain:1},5:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:2,gain:20},6:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:3,gain:1},7:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:3,gain:20},8:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:0,gain:1},9:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:0,gain:20},10:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:1,gain:1},11:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:1,gain:20},12:{type:Ki.hp.Constant,voltage:1.1},13:{type:Ki.hp.Constant,voltage:0},14:{type:Ki.hp.Constant,voltage:0},15:{type:Ki.hp.Temperature}},adcReferences:[Ki.yv.AVCC,Ki.yv.AREF,Ki.yv.Internal1V1,Ki.yv.Reserved,Ki.yv.AVCC,Ki.yv.AREF,Ki.yv.Internal2V56,Ki.yv.Internal2V56]},mn=(0,l.Z)((0,u.Z)({},Ki.RH),{adcInterrupt:58,muxInputMask:63,numChannels:16,muxChannels:{0:{type:Ki.hp.SingleEnded,channel:0},1:{type:Ki.hp.SingleEnded,channel:1},2:{type:Ki.hp.SingleEnded,channel:2},3:{type:Ki.hp.SingleEnded,channel:3},4:{type:Ki.hp.SingleEnded,channel:4},5:{type:Ki.hp.SingleEnded,channel:5},6:{type:Ki.hp.SingleEnded,channel:6},7:{type:Ki.hp.SingleEnded,channel:7},8:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:0,gain:10},9:{type:Ki.hp.Differential,positiveChannel:1,negativeChannel:0,gain:10},10:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:0,gain:200},11:{type:Ki.hp.Differential,positiveChannel:1,negativeChannel:0,gain:200},12:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:2,gain:10},13:{type:Ki.hp.Differential,positiveChannel:3,negativeChannel:2,gain:10},14:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:2,gain:200},15:{type:Ki.hp.Differential,positiveChannel:3,negativeChannel:2,gain:200},16:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:1,gain:1},17:{type:Ki.hp.Differential,positiveChannel:1,negativeChannel:1,gain:1},18:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:1,gain:1},19:{type:Ki.hp.Differential,positiveChannel:3,negativeChannel:1,gain:1},20:{type:Ki.hp.Differential,positiveChannel:4,negativeChannel:1,gain:1},21:{type:Ki.hp.Differential,positiveChannel:5,negativeChannel:1,gain:1},22:{type:Ki.hp.Differential,positiveChannel:6,negativeChannel:1,gain:1},23:{type:Ki.hp.Differential,positiveChannel:7,negativeChannel:1,gain:1},24:{type:Ki.hp.Differential,positiveChannel:0,negativeChannel:2,gain:1},25:{type:Ki.hp.Differential,positiveChannel:1,negativeChannel:2,gain:1},26:{type:Ki.hp.Differential,positiveChannel:2,negativeChannel:2,gain:1},27:{type:Ki.hp.Differential,positiveChannel:3,negativeChannel:2,gain:1},28:{type:Ki.hp.Differential,positiveChannel:4,negativeChannel:2,gain:1},29:{type:Ki.hp.Differential,positiveChannel:5,negativeChannel:2,gain:1},30:{type:Ki.hp.Constant,voltage:1.1},31:{type:Ki.hp.Constant,voltage:0},32:{type:Ki.hp.SingleEnded,channel:8},33:{type:Ki.hp.SingleEnded,channel:9},34:{type:Ki.hp.SingleEnded,channel:10},35:{type:Ki.hp.SingleEnded,channel:11},36:{type:Ki.hp.SingleEnded,channel:12},37:{type:Ki.hp.SingleEnded,channel:13},38:{type:Ki.hp.SingleEnded,channel:14},39:{type:Ki.hp.SingleEnded,channel:15},40:{type:Ki.hp.Differential,positiveChannel:8,negativeChannel:8,gain:10},41:{type:Ki.hp.Differential,positiveChannel:9,negativeChannel:8,gain:10},42:{type:Ki.hp.Differential,positiveChannel:8,negativeChannel:8,gain:200},43:{type:Ki.hp.Differential,positiveChannel:9,negativeChannel:8,gain:200},44:{type:Ki.hp.Differential,positiveChannel:10,negativeChannel:10,gain:10},45:{type:Ki.hp.Differential,positiveChannel:11,negativeChannel:10,gain:10},46:{type:Ki.hp.Differential,positiveChannel:10,negativeChannel:10,gain:200},47:{type:Ki.hp.Differential,positiveChannel:11,negativeChannel:10,gain:200},48:{type:Ki.hp.Differential,positiveChannel:8,negativeChannel:9,gain:1},49:{type:Ki.hp.Differential,positiveChannel:9,negativeChannel:9,gain:1},50:{type:Ki.hp.Differential,positiveChannel:10,negativeChannel:9,gain:1},51:{type:Ki.hp.Differential,positiveChannel:11,negativeChannel:9,gain:1},52:{type:Ki.hp.Differential,positiveChannel:12,negativeChannel:9,gain:1},53:{type:Ki.hp.Differential,positiveChannel:13,negativeChannel:9,gain:1},54:{type:Ki.hp.Differential,positiveChannel:14,negativeChannel:9,gain:1},55:{type:Ki.hp.Differential,positiveChannel:15,negativeChannel:9,gain:1},56:{type:Ki.hp.Differential,positiveChannel:8,negativeChannel:10,gain:1},57:{type:Ki.hp.Differential,positiveChannel:9,negativeChannel:10,gain:1},58:{type:Ki.hp.Differential,positiveChannel:10,negativeChannel:10,gain:1},59:{type:Ki.hp.Differential,positiveChannel:11,negativeChannel:10,gain:1},60:{type:Ki.hp.Differential,positiveChannel:12,negativeChannel:10,gain:1},61:{type:Ki.hp.Differential,positiveChannel:13,negativeChannel:10,gain:1}},adcReferences:[Ki.yv.AREF,Ki.yv.AVCC,Ki.yv.Internal1V1,Ki.yv.Internal2V56]}),yn={bits:16,dividers:Ki.OB.dividers,TOV:1,OCFA:2,OCFB:4,OCFC:8,TOIE:1,OCIEA:2,OCIEB:4,OCIEC:8},wn={ATmega328:{flash:32768,ram:2048,eeprom:1024,registerSpace:256,clockConfig:Ki.eP,eepromConfig:Ki.ts,watchdogConfig:Ki.s2,timers:[Ki.Jh,Ki.OB,Ki.Wv],usart:[Ki.kY],spi0Config:Ki.o9,twi0Config:Ki.mu,usi:!1,adcConfig:Ki.RH},ATmega2560:{flash:262144,ram:8192,eeprom:4096,registerSpace:512,clockConfig:Ki.eP,eepromConfig:(0,l.Z)((0,u.Z)({},Ki.ts),{eepromReadyInterrupt:60}),watchdogConfig:(0,l.Z)((0,u.Z)({},Ki.s2),{watchdogInterrupt:24}),timers:[(0,l.Z)((0,u.Z)({},Ki.Jh),{compAInterrupt:42,compBInterrupt:44,ovfInterrupt:46,compPortA:Ki.m4.PORT,compPinA:7,compPortB:Ki.KT.PORT,compPinB:5,externalClockPort:Ki.cS.PORT,externalClockPin:7}),(0,l.Z)((0,u.Z)({},Ki.OB,yn),{captureInterrupt:32,compAInterrupt:34,compBInterrupt:36,compCInterrupt:38,ovfInterrupt:40,OCRC:140,compPortA:Ki.m4.PORT,compPinA:5,compPortB:Ki.m4.PORT,compPinB:6,compPortC:Ki.m4.PORT,compPinC:7,externalClockPort:Ki.cS.PORT,externalClockPin:6}),(0,l.Z)((0,u.Z)({},Ki.Wv),{compAInterrupt:26,compBInterrupt:28,ovfInterrupt:30,compPortA:Ki.m4.PORT,compPinA:4,compPortB:Ki.lb.PORT,compPinB:6}),(0,l.Z)((0,u.Z)({},yn),{captureInterrupt:62,compAInterrupt:64,compBInterrupt:66,compCInterrupt:68,ovfInterrupt:70,TIFR:56,OCRA:152,OCRB:154,OCRC:156,ICR:150,TCNT:148,TCCRA:144,TCCRB:145,TCCRC:146,TIMSK:113,compPortA:Ki.bO.PORT,compPinA:3,compPortB:Ki.bO.PORT,compPinB:4,compPortC:Ki.bO.PORT,compPinC:5,externalClockPort:Ki.bO.PORT,externalClockPin:6}),(0,l.Z)((0,u.Z)({},yn),{captureInterrupt:82,compAInterrupt:84,compBInterrupt:86,compCInterrupt:88,ovfInterrupt:90,TIFR:57,OCRA:168,OCRB:170,OCRC:172,ICR:166,TCNT:164,TCCRA:160,TCCRB:161,TCCRC:162,TIMSK:114,compPortA:Ki.lb.PORT,compPinA:3,compPortB:Ki.lb.PORT,compPinB:4,compPortC:Ki.lb.PORT,compPinC:5,externalClockPort:Ki.lb.PORT,externalClockPin:7}),(0,l.Z)((0,u.Z)({},yn),{captureInterrupt:92,compAInterrupt:94,compBInterrupt:96,compCInterrupt:98,ovfInterrupt:100,TIFR:58,OCRA:296,OCRB:298,OCRC:300,ICR:294,TCNT:292,TCCRA:288,TCCRB:289,TCCRC:290,TIMSK:115,compPortA:Ki._R.PORT,compPinA:3,compPortB:Ki._R.PORT,compPinB:4,compPortC:Ki._R.PORT,compPinC:5,externalClockPort:Ki._R.PORT,externalClockPin:2})],spi0Config:(0,l.Z)((0,u.Z)({},Ki.o9),{spiInterrupt:48}),usart:[(0,l.Z)((0,u.Z)({},Ki.kY),{rxCompleteInterrupt:50,dataRegisterEmptyInterrupt:52,txCompleteInterrupt:54}),{rxCompleteInterrupt:72,dataRegisterEmptyInterrupt:74,txCompleteInterrupt:76,UCSRA:200,UCSRB:201,UCSRC:202,UBRRL:204,UBRRH:205,UDR:206},{rxCompleteInterrupt:102,dataRegisterEmptyInterrupt:104,txCompleteInterrupt:106,UCSRA:208,UCSRB:209,UCSRC:210,UBRRL:212,UBRRH:213,UDR:214},{rxCompleteInterrupt:108,dataRegisterEmptyInterrupt:110,txCompleteInterrupt:112,UCSRA:304,UCSRB:305,UCSRC:306,UBRRL:308,UBRRH:309,UDR:310}],twi0Config:(0,l.Z)((0,u.Z)({},Ki.mu),{twiInterrupt:78}),usi:!1,adcConfig:mn},ATtiny25:{flash:2048,ram:128,eeprom:128,registerSpace:96,clockConfig:cn,eepromConfig:vn,watchdogConfig:fn,timers:[hn],usart:[],usi:!0,adcConfig:gn},ATtiny45:{flash:4096,ram:256,eeprom:256,registerSpace:96,clockConfig:cn,eepromConfig:vn,watchdogConfig:fn,timers:[hn],usart:[],usi:!0,adcConfig:gn},ATtiny85:{flash:8192,ram:512,eeprom:512,registerSpace:96,clockConfig:cn,eepromConfig:vn,watchdogConfig:fn,usart:[],usi:!0,timers:[hn],adcConfig:gn}},kn={name:"Arduino UNO R3",analogPins:["A0","A1","A2","A3","A4","A5","A6","A7"],mcu:wn.ATmega328,freqMHZ:16e6,createPins:function(t){var e=new Ki.wq(t,Ki.m4),i=new Ki.wq(t,Ki._d),n=new Ki.wq(t,Ki.cS);return{0:{port:n,pin:0,signals:[(0,pn.A_)("RX")]},1:{port:n,pin:1,signals:[(0,pn.A_)("TX")]},2:{port:n,pin:2},3:{port:n,pin:3},4:{port:n,pin:4},5:{port:n,pin:5},6:{port:n,pin:6},7:{port:n,pin:7},8:{port:e,pin:0},9:{port:e,pin:1},10:{port:e,pin:2,signals:[(0,pn.Q5)("SS")]},11:{port:e,pin:3,signals:[(0,pn.Q5)("MOSI")]},12:{port:e,pin:4,signals:[(0,pn.Q5)("MISO")]},13:{port:e,pin:5,signals:[(0,pn.Q5)("SCK")]},A0:{port:i,pin:0},A1:{port:i,pin:1},A2:{port:i,pin:2},A3:{port:i,pin:3},A4:{port:i,pin:4,signals:[(0,pn.ss)("SDA")]},A5:{port:i,pin:5,signals:[(0,pn.ss)("SCL")]}}}};function Zn(t){return 36864===(65039&t)||37376===(65039&t)||37902===(65038&t)||37900===(65038&t)}function bn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i+n+(1&t.data[95]),a=255&r;t.data[(496&e)>>4]=a;var s=192&t.data[95];s|=a?0:2,s|=128&a?4:0,s|=(a^n)&(i^a)&128?8:0,s|=s>>2&1^s>>3&1?16:0,s|=256&r?1:0,s|=1&(i&n|n&~a|~a&i)?32:0,t.data[95]=s,t.cycles++,t.pc++}function Cn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i+n&255;t.data[(496&e)>>4]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(r^n)&(r^i)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=i+n&256?1:0,a|=1&(i&n|n&~r|~r&i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function xn(t,e){var i=2*((48&e)>>4)+24,n=t.dataView.getUint16(i,!0),r=n+(15&e|(192&e)>>2)&65535;t.dataView.setUint16(i,r,!0);var a=224&t.data[95];a|=r?0:2,a|=32768&r?4:0,a|=~n&r&32768?8:0,a|=a>>2&1^a>>3&1?16:0,a|=~r&n&32768?1:0,t.data[95]=a,t.cycles++,t.cycles++,t.pc++}function Sn(t,e){var i=t.data[(496&e)>>4]&t.data[15&e|(512&e)>>5];t.data[(496&e)>>4]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function _n(t,e){var i=t.data[16+((240&e)>>4)]&(15&e|(3840&e)>>4);t.data[16+((240&e)>>4)]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function Pn(t,e){var i=t.data[(496&e)>>4],n=i>>>1|128&i;t.data[(496&e)>>4]=n;var r=224&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=1&i,r|=r>>2&1^1&r?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function Dn(t,e){t.data[95]&=~(1<<((112&e)>>4)),t.cycles++,t.pc++}function In(t,e){var i=7&e,n=(496&e)>>4;t.data[n]=~(1<<i)&t.data[n]|(t.data[95]>>6&1)<<i,t.cycles++,t.pc++}function An(t,e){t.data[95]&1<<(7&e)||(t.pc=t.pc+(((504&e)>>3)-(512&e?64:0)),t.cycles++),t.cycles++,t.pc++}function Rn(t,e){t.data[95]&1<<(7&e)&&(t.pc=t.pc+(((504&e)>>3)-(512&e?64:0)),t.cycles++),t.cycles++,t.pc++}function Bn(t,e){t.data[95]|=1<<((112&e)>>4),t.cycles++,t.pc++}function En(t,e){var i=t.data[(496&e)>>4],n=7&e;t.data[95]=191&t.data[95]|(i>>n&1?64:0),t.cycles++,t.pc++}function Un(t,e){var i=t.progMem[t.pc+1]|(1&e)<<16|(496&e)<<13,n=t.pc+2,r=t.dataView.getUint16(93,!0),a=t.pc22Bits;t.data[r]=255&n,t.data[r-1]=n>>8&255,a&&(t.data[r-2]=n>>16&255),t.dataView.setUint16(93,r-(a?3:2),!0),t.pc=i-1,t.cycles+=a?4:3,t.cycles++,t.pc++}function Nn(t,e){var i=248&e,n=7&e,r=t.readData(32+(i>>3)),a=1<<n;t.writeData(32+(i>>3),r&~a,a),t.cycles++,t.pc++}function Tn(t,e){var i=(496&e)>>4,n=255-t.data[i];t.data[i]=n;var r=225&t.data[95]|1;r|=n?0:2,r|=128&n?4:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function On(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i-n,a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=0!==((i^n)&(i^r)&128)?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function Mn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=t.data[95],a=i-n-(1&r);r=192&r|(!a&&r>>1&1?2:0)|(n+(1&r)>i?1:0),r|=128&a?4:0,r|=(i^n)&(i^a)&128?8:0,r|=r>>2&1^r>>3&1?16:0,r|=1&(~i&n|n&a|a&~i)?32:0,t.data[95]=r,t.cycles++,t.pc++}function Vn(t,e){var i=t.data[16+((240&e)>>4)],n=15&e|(3840&e)>>4,r=i-n,a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(i^n)&(i^r)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function Ln(t,e){if(t.data[(496&e)>>4]===t.data[15&e|(512&e)>>5]){var i=Zn(t.progMem[t.pc+1])?2:1;t.pc+=i,t.cycles+=i}t.cycles++,t.pc++}function Fn(t,e){var i=t.data[(496&e)>>4],n=i-1;t.data[(496&e)>>4]=n;var r=225&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=128===i?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function Jn(t,e){var i=t.pc+1,n=t.dataView.getUint16(93,!0),r=t.data[92];t.data[n]=255&i,t.data[n-1]=i>>8&255,t.data[n-2]=i>>16&255,t.dataView.setUint16(93,n-3,!0),t.pc=(r<<16|t.dataView.getUint16(30,!0))-1,t.cycles+=3,t.cycles++,t.pc++}function Kn(t,e){var i=t.data[92];t.pc=(i<<16|t.dataView.getUint16(30,!0))-1,t.cycles++,t.cycles++,t.pc++}function Wn(t,e){var i=t.data[91];t.data[0]=t.progBytes[i<<16|t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function Hn(t,e){var i=t.data[91];t.data[(496&e)>>4]=t.progBytes[i<<16|t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function qn(t,e){var i=t.data[91],n=t.dataView.getUint16(30,!0);t.data[(496&e)>>4]=t.progBytes[i<<16|n],t.dataView.setUint16(30,n+1,!0),65535===n&&(t.data[91]=(i+1)%(t.progBytes.length>>16)),t.cycles+=2,t.cycles++,t.pc++}function Gn(t,e){var i=t.data[(496&e)>>4]^t.data[15&e|(512&e)>>5];t.data[(496&e)>>4]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function zn(t,e){var i=t.data[16+((112&e)>>4)],n=t.data[16+(7&e)],r=i*n<<1;t.dataView.setUint16(0,r,!0),t.data[95]=252&t.data[95]|(65535&r?0:2)|(i*n&32768?1:0),t.cycles++,t.cycles++,t.pc++}function Xn(t,e){var i=t.dataView.getInt8(16+((112&e)>>4)),n=t.dataView.getInt8(16+(7&e)),r=i*n<<1;t.dataView.setInt16(0,r,!0),t.data[95]=252&t.data[95]|(65535&r?0:2)|(i*n&32768?1:0),t.cycles++,t.cycles++,t.pc++}function jn(t,e){var i=t.dataView.getInt8(16+((112&e)>>4)),n=t.data[16+(7&e)],r=i*n<<1;t.dataView.setInt16(0,r,!0),t.data[95]=252&t.data[95]|(65535&r?2:0)|(i*n&32768?1:0),t.cycles++,t.cycles++,t.pc++}function Qn(t,e){var i=t.pc+1,n=t.dataView.getUint16(93,!0),r=t.pc22Bits;t.data[n]=255&i,t.data[n-1]=i>>8&255,r&&(t.data[n-2]=i>>16&255),t.dataView.setUint16(93,n-(r?3:2),!0),t.pc=t.dataView.getUint16(30,!0)-1,t.cycles+=r?3:2,t.cycles++,t.pc++}function $n(t,e){t.pc=t.dataView.getUint16(30,!0)-1,t.cycles++,t.cycles++,t.pc++}function Yn(t,e){var i=t.readData(32+(15&e|(1536&e)>>5));t.data[(496&e)>>4]=i,t.cycles++,t.pc++}function tr(t,e){var i=t.data[(496&e)>>4],n=i+1&255;t.data[(496&e)>>4]=n;var r=225&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=127===i?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function er(t,e){t.pc=(t.progMem[t.pc+1]|(1&e)<<16|(496&e)<<13)-1,t.cycles+=2,t.cycles++,t.pc++}function ir(t,e){var i=(496&e)>>4,n=t.data[i],r=t.readData(t.dataView.getUint16(30,!0));t.writeData(t.dataView.getUint16(30,!0),r&255-n),t.data[i]=r,t.cycles++,t.pc++}function nr(t,e){var i=(496&e)>>4,n=t.data[i],r=t.readData(t.dataView.getUint16(30,!0));t.writeData(t.dataView.getUint16(30,!0),r|n),t.data[i]=r,t.cycles++,t.pc++}function rr(t,e){var i=t.data[(496&e)>>4],n=t.readData(t.dataView.getUint16(30,!0));t.writeData(t.dataView.getUint16(30,!0),i^n),t.data[(496&e)>>4]=n,t.cycles++,t.pc++}function ar(t,e){t.data[16+((240&e)>>4)]=15&e|(3840&e)>>4,t.cycles++,t.pc++}function sr(t,e){t.cycles++;var i=t.readData(t.progMem[t.pc+1]);t.data[(496&e)>>4]=i,t.pc++,t.cycles++,t.pc++}function or(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(26,!0)),t.cycles++,t.pc++}function ur(t,e){var i=t.dataView.getUint16(26,!0);t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.dataView.setUint16(26,i+1,!0),t.cycles++,t.pc++}function lr(t,e){var i=t.dataView.getUint16(26,!0)-1;t.dataView.setUint16(26,i,!0),t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.cycles++,t.pc++}function cr(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(28,!0)),t.cycles++,t.pc++}function dr(t,e){var i=t.dataView.getUint16(28,!0);t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.dataView.setUint16(28,i+1,!0),t.cycles++,t.pc++}function hr(t,e){var i=t.dataView.getUint16(28,!0)-1;t.dataView.setUint16(28,i,!0),t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.cycles++,t.pc++}function vr(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(28,!0)+(7&e|(3072&e)>>7|(8192&e)>>8)),t.cycles++,t.pc++}function fr(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(30,!0)),t.cycles++,t.pc++}function pr(t,e){var i=t.dataView.getUint16(30,!0);t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.dataView.setUint16(30,i+1,!0),t.cycles++,t.pc++}function gr(t,e){var i=t.dataView.getUint16(30,!0)-1;t.dataView.setUint16(30,i,!0),t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.cycles++,t.pc++}function mr(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(30,!0)+(7&e|(3072&e)>>7|(8192&e)>>8)),t.cycles++,t.pc++}function yr(t,e){t.data[0]=t.progBytes[t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function wr(t,e){t.data[(496&e)>>4]=t.progBytes[t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function kr(t,e){var i=t.dataView.getUint16(30,!0);t.data[(496&e)>>4]=t.progBytes[i],t.dataView.setUint16(30,i+1,!0),t.cycles+=2,t.cycles++,t.pc++}function Zr(t,e){var i=t.data[(496&e)>>4],n=i>>>1;t.data[(496&e)>>4]=n;var r=224&t.data[95];r|=n?0:2,r|=1&i,r|=r>>2&1^1&r?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function br(t,e){t.data[(496&e)>>4]=t.data[15&e|(512&e)>>5],t.cycles++,t.pc++}function Cr(t,e){var i=2*(15&e),n=2*((240&e)>>4);t.data[n]=t.data[i],t.data[n+1]=t.data[i+1],t.cycles++,t.pc++}function xr(t,e){var i=t.data[(496&e)>>4]*t.data[15&e|(512&e)>>5];t.dataView.setUint16(0,i,!0),t.data[95]=252&t.data[95]|(65535&i?0:2)|(32768&i?1:0),t.cycles++,t.cycles++,t.pc++}function Sr(t,e){var i=t.dataView.getInt8(16+((240&e)>>4))*t.dataView.getInt8(16+(15&e));t.dataView.setInt16(0,i,!0),t.data[95]=252&t.data[95]|(65535&i?0:2)|(32768&i?1:0),t.cycles++,t.cycles++,t.pc++}function _r(t,e){var i=t.dataView.getInt8(16+((112&e)>>4))*t.data[16+(7&e)];t.dataView.setInt16(0,i,!0),t.data[95]=252&t.data[95]|(65535&i?0:2)|(32768&i?1:0),t.cycles++,t.cycles++,t.pc++}function Pr(t,e){var i=(496&e)>>4,n=t.data[i],r=0-n;t.data[i]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=128===r?8:0,a|=a>>2&1^a>>3&1?16:0,a|=r?1:0,a|=1&(r|n)?32:0,t.data[95]=a,t.cycles++,t.pc++}function Dr(t,e){t.cycles++,t.pc++}function Ir(t,e){var i=t.data[(496&e)>>4]|t.data[15&e|(512&e)>>5];t.data[(496&e)>>4]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function Ar(t,e){var i=t.data[16+((240&e)>>4)]|15&e|(3840&e)>>4;t.data[16+((240&e)>>4)]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function Rr(t,e){t.writeData(32+(15&e|(1536&e)>>5),t.data[(496&e)>>4]),t.cycles++,t.pc++}function Br(t,e){var i=t.dataView.getUint16(93,!0)+1;t.dataView.setUint16(93,i,!0),t.data[(496&e)>>4]=t.data[i],t.cycles++,t.cycles++,t.pc++}function Er(t,e){var i=t.dataView.getUint16(93,!0);t.data[i]=t.data[(496&e)>>4],t.dataView.setUint16(93,i-1,!0),t.cycles++,t.cycles++,t.pc++}function Ur(t,e){var i=(2047&e)-(2048&e?2048:0),n=t.pc+1,r=t.dataView.getUint16(93,!0),a=t.pc22Bits;t.data[r]=255&n,t.data[r-1]=n>>8&255,a&&(t.data[r-2]=n>>16&255),t.dataView.setUint16(93,r-(a?3:2),!0),t.pc+=i,t.cycles+=a?3:2,t.cycles++,t.pc++}function Nr(t,e){var i=t.pc22Bits,n=t.dataView.getUint16(93,!0)+(i?3:2);t.dataView.setUint16(93,n,!0),t.pc=(t.data[n-1]<<8)+t.data[n]-1,i&&(t.pc|=t.data[n-2]<<16),t.cycles+=i?4:3,t.cycles++,t.pc++}function Tr(t,e){var i=t.pc22Bits,n=t.dataView.getUint16(93,!0)+(i?3:2);t.dataView.setUint16(93,n,!0),t.pc=(t.data[n-1]<<8)+t.data[n]-1,i&&(t.pc|=t.data[n-2]<<16),t.cycles+=i?4:3,t.data[95]|=128,t.cycles++,t.pc++}function Or(t,e){t.pc=t.pc+((2047&e)-(2048&e?2048:0)),t.cycles++,t.cycles++,t.pc++}function Mr(t,e){var i=t.data[(496&e)>>4],n=i>>>1|(1&t.data[95])<<7;t.data[(496&e)>>4]=n;var r=224&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=1&i?1:0,r|=r>>2&1^1&r?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function Vr(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=t.data[95],a=i-n-(1&r);t.data[(496&e)>>4]=a,r=192&r|(!a&&r>>1&1?2:0)|(n+(1&r)>i?1:0),r|=128&a?4:0,r|=(i^n)&(i^a)&128?8:0,r|=r>>2&1^r>>3&1?16:0,r|=1&(~i&n|n&a|a&~i)?32:0,t.data[95]=r,t.cycles++,t.pc++}function Lr(t,e){var i=t.data[16+((240&e)>>4)],n=15&e|(3840&e)>>4,r=t.data[95],a=i-n-(1&r);t.data[16+((240&e)>>4)]=a,r=192&r|(!a&&r>>1&1?2:0)|(n+(1&r)>i?1:0),r|=128&a?4:0,r|=(i^n)&(i^a)&128?8:0,r|=r>>2&1^r>>3&1?16:0,r|=1&(~i&n|n&a|a&~i)?32:0,t.data[95]=r,t.cycles++,t.pc++}function Fr(t,e){var i=32+((248&e)>>3),n=1<<(7&e);t.writeData(i,t.readData(i)|n,n),t.cycles++,t.cycles++,t.pc++}function Jr(t,e){if(!(t.readData(32+((248&e)>>3))&1<<(7&e))){var i=Zn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Kr(t,e){if(t.readData(32+((248&e)>>3))&1<<(7&e)){var i=Zn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Wr(t,e){var i=2*((48&e)>>4)+24,n=t.dataView.getUint16(i,!0),r=15&e|(192&e)>>2,a=n-r;t.dataView.setUint16(i,a,!0);var s=192&t.data[95];s|=a?0:2,s|=32768&a?4:0,s|=n&~a&32768?8:0,s|=s>>2&1^s>>3&1?16:0,s|=r>n?1:0,s|=1&(~n&r|r&a|a&~n)?32:0,t.data[95]=s,t.cycles++,t.cycles++,t.pc++}function Hr(t,e){if(!(t.data[(496&e)>>4]&1<<(7&e))){var i=Zn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function qr(t,e){if(t.data[(496&e)>>4]&1<<(7&e)){var i=Zn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Gr(t,e){t.cycles++,t.pc++}function zr(t,e){t.cycles++,t.pc++}function Xr(t,e){t.cycles++,t.pc++}function jr(t,e){var i=t.data[(496&e)>>4],n=t.progMem[t.pc+1];t.writeData(n,i),t.pc++,t.cycles++,t.cycles++,t.pc++}function Qr(t,e){t.writeData(t.dataView.getUint16(26,!0),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function $r(t,e){var i=t.dataView.getUint16(26,!0);t.writeData(i,t.data[(496&e)>>4]),t.dataView.setUint16(26,i+1,!0),t.cycles++,t.cycles++,t.pc++}function Yr(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(26,!0)-1;t.dataView.setUint16(26,n,!0),t.writeData(n,i),t.cycles++,t.cycles++,t.pc++}function ta(t,e){t.writeData(t.dataView.getUint16(28,!0),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function ea(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(28,!0);t.writeData(n,i),t.dataView.setUint16(28,n+1,!0),t.cycles++,t.cycles++,t.pc++}function ia(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(28,!0)-1;t.dataView.setUint16(28,n,!0),t.writeData(n,i),t.cycles++,t.cycles++,t.pc++}function na(t,e){t.writeData(t.dataView.getUint16(28,!0)+(7&e|(3072&e)>>7|(8192&e)>>8),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function ra(t,e){t.writeData(t.dataView.getUint16(30,!0),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function aa(t,e){var i=t.dataView.getUint16(30,!0);t.writeData(i,t.data[(496&e)>>4]),t.dataView.setUint16(30,i+1,!0),t.cycles++,t.cycles++,t.pc++}function sa(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(30,!0)-1;t.dataView.setUint16(30,n,!0),t.writeData(n,i),t.cycles++,t.cycles++,t.pc++}function oa(t,e){t.writeData(t.dataView.getUint16(30,!0)+(7&e|(3072&e)>>7|(8192&e)>>8),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function ua(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i-n;t.data[(496&e)>>4]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(i^n)&(i^r)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function la(t,e){var i=t.data[16+((240&e)>>4)],n=15&e|(3840&e)>>4,r=i-n;t.data[16+((240&e)>>4)]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(i^n)&(i^r)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function ca(t,e){var i=(496&e)>>4,n=t.data[i];t.data[i]=(15&n)<<4|(240&n)>>>4,t.cycles++,t.pc++}function da(t,e){t.onWatchdogReset(),t.cycles++,t.pc++}function ha(t,e){var i=(496&e)>>4,n=t.data[i],r=t.data[t.dataView.getUint16(30,!0)];t.data[t.dataView.getUint16(30,!0)]=n,t.data[i]=r,t.cycles++,t.pc++}var va=[{pattern:"0001 11rd dddd rrrr",fn:bn,idx:1},{pattern:"0000 11rd dddd rrrr",fn:Cn,idx:2},{pattern:"1001 0110 KKdd KKKK",fn:xn,idx:3},{pattern:"0010 00rd dddd rrrr",fn:Sn,idx:4},{pattern:"0111 KKKK dddd KKKK",fn:_n,idx:5},{pattern:"1001 010d dddd 0101",fn:Pn,idx:6},{pattern:"1001 0100 1sss 1000",fn:Dn,idx:7},{pattern:"1111 100d dddd 0bbb",fn:In,idx:8},{pattern:"1111 01kk kkkk ksss",fn:An,idx:9},{pattern:"1111 00kk kkkk ksss",fn:Rn,idx:10},{pattern:"1001 0100 0sss 1000",fn:Bn,idx:11},{pattern:"1111 101d dddd 0bbb",fn:En,idx:12},{pattern:"1001 010k kkkk 111k kkkk kkkk kkkk kkkk",fn:Un,idx:13},{pattern:"1001 1000 AAAA Abbb",fn:Nn,idx:14},{pattern:"1001 010d dddd 0000",fn:Tn,idx:15},{pattern:"0001 01rd dddd rrrr",fn:On,idx:16},{pattern:"0000 01rd dddd rrrr",fn:Mn,idx:17},{pattern:"0011 KKKK dddd KKKK",fn:Vn,idx:18},{pattern:"0001 00rd dddd rrrr",fn:Ln,idx:19},{pattern:"1001 010d dddd 1010",fn:Fn,idx:20},{pattern:"1001 0101 0001 1001",fn:Jn,idx:21},{pattern:"1001 0100 0001 1001",fn:Kn,idx:22},{pattern:"1001 0101 1101 1000",fn:Wn,idx:23},{pattern:"1001 000d dddd 0110",fn:Hn,idx:24},{pattern:"1001 000d dddd 0111",fn:qn,idx:25},{pattern:"0010 01rd dddd rrrr",fn:Gn,idx:26},{pattern:"0000 0011 0ddd 1rrr",fn:zn,idx:27},{pattern:"0000 0011 1ddd 0rrr",fn:Xn,idx:28},{pattern:"0000 0011 1ddd 1rrr",fn:jn,idx:29},{pattern:"1001 0101 0000 1001",fn:Qn,idx:30},{pattern:"1001 0100 0000 1001",fn:$n,idx:31},{pattern:"1011 0AAd dddd AAAA",fn:Yn,idx:32},{pattern:"1001 010d dddd 0011",fn:tr,idx:33},{pattern:"1001 010k kkkk 110k kkkk kkkk kkkk kkkk",fn:er,idx:34},{pattern:"1001 001r rrrr 0110",fn:ir,idx:35},{pattern:"1001 001r rrrr 0101",fn:nr,idx:36},{pattern:"1001 001r rrrr 0111",fn:rr,idx:37},{pattern:"1110 KKKK dddd KKKK",fn:ar,idx:38},{pattern:"1001 000d dddd 0000 kkkk kkkk kkkk kkkk",fn:sr,idx:39},{pattern:"1001 000d dddd 1100",fn:or,idx:40},{pattern:"1001 000d dddd 1101",fn:ur,idx:41},{pattern:"1001 000d dddd 1110",fn:lr,idx:42},{pattern:"1000 000d dddd 1000",fn:cr,idx:43},{pattern:"1001 000d dddd 1001",fn:dr,idx:44},{pattern:"1001 000d dddd 1010",fn:hr,idx:45},{pattern:"10q0 qq0d dddd 1qqq",fn:vr,idx:46},{pattern:"1000 000d dddd 0000",fn:fr,idx:47},{pattern:"1001 000d dddd 0001",fn:pr,idx:48},{pattern:"1001 000d dddd 0010",fn:gr,idx:49},{pattern:"10q0 qq0d dddd 0qqq",fn:mr,idx:50},{pattern:"1001 0101 1100 1000",fn:yr,idx:51},{pattern:"1001 000d dddd 0100",fn:wr,idx:52},{pattern:"1001 000d dddd 0101",fn:kr,idx:53},{pattern:"1001 010d dddd 0110",fn:Zr,idx:54},{pattern:"0010 11rd dddd rrrr",fn:br,idx:55},{pattern:"0000 0001 dddd rrrr",fn:Cr,idx:56},{pattern:"1001 11rd dddd rrrr",fn:xr,idx:57},{pattern:"0000 0010 dddd rrrr",fn:Sr,idx:58},{pattern:"0000 0011 0ddd 0rrr",fn:_r,idx:59},{pattern:"1001 010d dddd 0001",fn:Pr,idx:60},{pattern:"0000 0000 0000 0000",fn:Dr,idx:61},{pattern:"0010 10rd dddd rrrr",fn:Ir,idx:62},{pattern:"0110 KKKK dddd KKKK",fn:Ar,idx:63},{pattern:"1011 1AAr rrrr AAAA",fn:Rr,idx:64},{pattern:"1001 000d dddd 1111",fn:Br,idx:65},{pattern:"1001 001d dddd 1111",fn:Er,idx:66},{pattern:"1101 kkkk kkkk kkkk",fn:Ur,idx:67},{pattern:"1001 0101 0000 1000",fn:Nr,idx:68},{pattern:"1001 0101 0001 1000",fn:Tr,idx:69},{pattern:"1100 kkkk kkkk kkkk",fn:Or,idx:70},{pattern:"1001 010d dddd 0111",fn:Mr,idx:71},{pattern:"0000 10rd dddd rrrr",fn:Vr,idx:72},{pattern:"0100 KKKK dddd KKKK",fn:Lr,idx:73},{pattern:"1001 1010 AAAA Abbb",fn:Fr,idx:74},{pattern:"1001 1001 AAAA Abbb",fn:Jr,idx:75},{pattern:"1001 1011 AAAA Abbb",fn:Kr,idx:76},{pattern:"1001 0111 KKdd KKKK",fn:Wr,idx:77},{pattern:"1111 110r rrrr 0bbb",fn:Hr,idx:78},{pattern:"1111 111r rrrr 0bbb",fn:qr,idx:79},{pattern:"1001 0101 1000 1000",fn:Gr,idx:80},{pattern:"1001 0101 1110 1000",fn:zr,idx:81},{pattern:"1001 0101 1111 1000",fn:Xr,idx:82},{pattern:"1001 001d dddd 0000 kkkk kkkk kkkk kkkk",fn:jr,idx:83},{pattern:"1001 001r rrrr 1100",fn:Qr,idx:84},{pattern:"1001 001r rrrr 1101",fn:$r,idx:85},{pattern:"1001 001r rrrr 1110",fn:Yr,idx:86},{pattern:"1000 001r rrrr 1000",fn:ta,idx:87},{pattern:"1001 001r rrrr 1001",fn:ea,idx:88},{pattern:"1001 001r rrrr 1010",fn:ia,idx:89},{pattern:"10q0 qq1r rrrr 1qqq",fn:na,idx:90},{pattern:"1000 001r rrrr 0000",fn:ra,idx:91},{pattern:"1001 001r rrrr 0001",fn:aa,idx:92},{pattern:"1001 001r rrrr 0010",fn:sa,idx:93},{pattern:"10q0 qq1r rrrr 0qqq",fn:oa,idx:94},{pattern:"0001 10rd dddd rrrr",fn:ua,idx:95},{pattern:"0101 KKKK dddd KKKK",fn:la,idx:96},{pattern:"1001 010d dddd 0010",fn:ca,idx:97},{pattern:"1001 0101 1010 1000",fn:da,idx:98},{pattern:"1001 001r rrrr 0100",fn:ha,idx:99}];var fa=f().mark(pa);function pa(t){var e,i,n,r,a,s,o,u,l,c,d,h,v,p,g,m;return f().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:for(e=1,i=!0,n=!1,r=void 0,f.prev=2,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)"0"!==(o=s.value)&&"1"!==o&&(e*=2);f.next=10;break;case 6:f.prev=6,f.t0=f.catch(2),n=!0,r=f.t0;case 10:f.prev=10,f.prev=11,i||null==a.return||a.return();case 13:if(f.prev=13,!n){f.next=16;break}throw r;case 16:return f.finish(13);case 17:return f.finish(10);case 18:u=0;case 19:if(!(u<e)){f.next=44;break}for(l=0,c=0,d=!0,h=!1,v=void 0,f.prev=23,p=t[Symbol.iterator]();!(d=(g=p.next()).done);d=!0)m=g.value,c*=2,"1"===m?c++:"0"!==m&&(c+=u&1<<l?1:0,l++);f.next=31;break;case 27:f.prev=27,f.t1=f.catch(23),h=!0,v=f.t1;case 31:f.prev=31,f.prev=32,d||null==p.return||p.return();case 34:if(f.prev=34,!h){f.next=37;break}throw v;case 37:return f.finish(34);case 38:return f.finish(31);case 39:return f.next=41,c;case 41:u++,f.next=19;break;case 44:case"end":return f.stop()}}),fa,null,[[2,6,10,18],[11,,13,17],[23,27,31,39],[32,,34,38]])}var ga=new WeakMap;function ma(t){var e=ga.get(t)||0;e<10&&console.warn("Invalid opcode ".concat(t.progMem[t.pc].toString(16)," at 0x").concat((2*t.pc).toString(16))),10===++e&&console.warn("Too many warnings; reporting disabled"),ga.set(t,e),t.cycles++,t.pc++}for(var ya={},wa=0;wa<65536;wa++)ya[wa]=ma;var ka=!0,Za=!1,ba=void 0;try{for(var Ca,xa=va[Symbol.iterator]();!(ka=(Ca=xa.next()).done);ka=!0){var Sa=Ca.value,_a=Sa.pattern,Pa=Sa.fn,Da=!0,Ia=!1,Aa=void 0;try{for(var Ra,Ba=pa(_a.replace(/ /g,"").substr(0,16))[Symbol.iterator]();!(Da=(Ra=Ba.next()).done);Da=!0){var Ea=Ra.value;ya[Ea]=Pa}}catch(Ns){Ia=!0,Aa=Ns}finally{try{Da||null==Ba.return||Ba.return()}finally{if(Ia)throw Aa}}}}catch(Ns){Za=!0,ba=Ns}finally{try{ka||null==xa.return||xa.return()}finally{if(Za)throw ba}}var Ua=i(96387),Na=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"onEnable",void 0),(0,s.Z)(this,"onByte",(function(){})),(0,s.Z)(this,"fifo",new Ua.Q),(0,s.Z)(this,"tdcr",0),e.writeHooks[59]=function(t){var e,n;(i.tdcr=3&t,1&t)&&(null===(n=(e=i).onEnable)||void 0===n||n.call(e))},e.readHooks[59]=function(){return Math.min(i.fifo.available,15)<<4|i.tdcr},e.writeHooks[58]=function(t){i.onByte(t)},e.readHooks[58]=function(){var t,e;return 2&i.tdcr?null!==(t=i.fifo.peek())&&void 0!==t?t:0:null!==(e=i.fifo.next())&&void 0!==e?e:0}}return(0,a.Z)(t,[{key:"write",value:function(t){this.fifo.write(t)}}]),t}(),Ta=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"listeners",void 0),(0,s.Z)(this,"tinyDebug",void 0),this.tinyDebug=e,this.listeners=new Set,e.onByte=function(t){var e=new Uint8Array([t]),n=!0,r=!1,a=void 0;try{for(var s,o=i.listeners[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){(0,s.value)(e)}}catch(Ns){r=!0,a=Ns}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}}return(0,a.Z)(t,[{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"write",value:function(t){this.tinyDebug.write(t)}}]),t}(),Oa=38296,Ma=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"sclFrequency",1e5)}return(0,a.Z)(t,[{key:"completeStart",value:function(){}},{key:"completeStop",value:function(){}},{key:"completeConnect",value:function(){}},{key:"completeWrite",value:function(){}},{key:"completeRead",value:function(){}}]),t}(),Va=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ki.rj(i.mcu.eeprom),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=this;(0,r.Z)(this,t),(0,s.Z)(this,"program",void 0),(0,s.Z)(this,"cpu",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"usart",void 0),(0,s.Z)(this,"twi",void 0),(0,s.Z)(this,"usi",void 0),(0,s.Z)(this,"eeprom",void 0),(0,s.Z)(this,"watchdog",void 0),(0,s.Z)(this,"i2c",void 0),(0,s.Z)(this,"spiMaster",void 0),(0,s.Z)(this,"timers",void 0),(0,s.Z)(this,"gpio",void 0),(0,s.Z)(this,"MHZ",void 0),(0,s.Z)(this,"pcMask",void 0),(0,s.Z)(this,"adcPins",void 0),(0,s.Z)(this,"scheduler",void 0),(0,s.Z)(this,"stopped",void 0),(0,s.Z)(this,"resetActive",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"pausePoints",void 0),(0,s.Z)(this,"hasPausePoints",void 0),(0,s.Z)(this,"analogPins",void 0),(0,s.Z)(this,"dumpRegistersOnBreak",void 0),(0,s.Z)(this,"defaultUartPins",void 0),(0,s.Z)(this,"serialInterface",void 0),(0,s.Z)(this,"onBreak",void 0),(0,s.Z)(this,"execute",void 0),(0,s.Z)(this,"board",void 0),(0,s.Z)(this,"eepromBackend",void 0),this.board=i,this.eepromBackend=n,this.program=new Uint16Array(this.board.mcu.flash/2),this.usart=[],this.timers=[],this.pcMask=this.program.length-1,this.adcPins=[null,null,null,null,null,null,null,null],this.stopped=!0,this.resetActive=!1,this.pausePoints={},this.hasPausePoints=!1,this.analogPins=this.board.analogPins,this.dumpRegistersOnBreak=!0,this.defaultUartPins={rx:"1",tx:"0"},this.execute=function(t){for(var e=o.cpu,i=o.hasPausePoints,n=o.pcMask,r=o.clock.frequency*(t/1e3),a=e.cycles+r;e.cycles<a;){var s,u,l=e.progMem[e.pc];if(o.resetActive?e.cycles++:ya[l](e,l),e.pc&=n,l===Oa)if(null===(u=(s=o).onBreak)||void 0===u?void 0:u.call(s))break;if(i){var c=o.pausePoints[e.pc];c&&c()}e.tick()}return!o.stopped};var u=i.mcu,l=u.clockConfig,c=u.eepromConfig,h=u.usart,v=u.spi0Config,f=u.twi0Config,p=u.timers,g=u.adcConfig,m=u.watchdogConfig,y=u.usi,w=a.firmwareBinary;this.program.fill(65535);var k=new Uint8Array(this.program.buffer);if(w){var b=new Uint8Array(w),C=!0,x=!1,S=void 0;try{for(var _,P=new Ji.aX(b).program[Symbol.iterator]();!(C=(_=P.next()).done);C=!0){var D=_.value;D.type===Ji.oB.LOAD&&D.paddr+D.filesz<k.length&&k.set(b.subarray(D.offset,D.offset+D.filesz),D.paddr)}}catch(Ns){x=!0,S=Ns}finally{try{C||null==P.return||P.return()}finally{if(x)throw S}}}else(0,Hi.i)(e,k);this.cpu=new Ki.Z9(this.program,(a.ramSize||i.mcu.ram)+i.mcu.registerSpace),this.MHZ=a.frequency||i.freqMHZ,this.clock=new Ki.y_(this.cpu,this.MHZ,l);var I=!0,A=!1,R=void 0;try{for(var B,E=p[Symbol.iterator]();!(I=(B=E.next()).done);I=!0){var U=B.value;this.timers.push(new Ki.OI(this.cpu,U))}}catch(Ns){A=!0,R=Ns}finally{try{I||null==E.return||E.return()}finally{if(A)throw R}}this.usart=h.map((function(t){return new Ki.cv(o.cpu,t,o.MHZ)})),this.twi=f?new Ki.YR(this.cpu,f,this.MHZ):new Ma,this.eeprom=new Ki.qN(this.cpu,n,c),this.watchdog=new Ki.JK(this.cpu,m,this.clock);var N=v?new Ki.cX(this.cpu,v,this.MHZ):null,T=i.createPins(this.cpu),O=Object.keys(T).map((function(t){return new an(o,t,T[t])}));this.pins=[new qi.E("GND",Z.J.Low),new qi.E("5V",Z.J.High),new qi.E("VIN",Z.J.High),new qi.E("3.3V",Z.J.High),new qi.E("VCC",Z.J.High),new Gi("RESET",(function(t){if(o.resetActive=!t,!t){var e=o.cpu.nextClockEvent;o.cpu.reset(),o.cpu.nextClockEvent=e;var i=!0,n=!1,r=void 0;try{for(var a,s=o.cpu.gpioPorts[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;o.cpu.writeData(u.portConfig.DDR,0),o.cpu.writeData(u.portConfig.PORT,0)}}catch(Ns){n=!0,r=Ns}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}))].concat((0,d.Z)(O)),this.gpio=Array.from(new Set(Object.values(T).map((function(t){return t.port})))),this.usi=y?new Ki.ap(this.cpu,this.gpio[0],dn.PIN,0,2):null,y&&(this.serialInterface=new Ta(new Na(this.cpu)));var M=function(t,e){return O.find((function(i){var n;return null===(n=i.signals)||void 0===n?void 0:n.some((function(i){return i.type===t&&"signal"in i&&i.signal===e}))}))};this.i2c=new tn(this,this.twi,{scl:M("i2c","SCL"),sda:M("i2c","SDA")}),this.spiMaster=N?new ln(this,N,{mosi:M("spi","MOSI"),miso:M("spi","MISO"),sck:M("spi","SCK")}):null;var V=new Ki.Go(this.cpu,g);V.onADCRead=function(t){var e=0;switch(t.type){case Ki.hp.Constant:e=t.voltage;break;case Ki.hp.SingleEnded:var i,n;e=null!==(n=null===(i=o.adcPins[t.channel])||void 0===i?void 0:i.read())&&void 0!==n?n:0;break;case Ki.hp.Differential:var r,a;e=t.gain*(((null===(r=o.adcPins[t.positiveChannel])||void 0===r?void 0:r.read())||0)-((null===(a=o.adcPins[t.negativeChannel])||void 0===a?void 0:a.read())||0));break;case Ki.hp.Temperature:e=.378125}var s=e/V.referenceVoltage*1024,u=Math.min(Math.max(Math.floor(s),0),1023);o.cpu.addClockEvent((function(){return V.completeADCRead(u)}),V.sampleCycles)},ya[38296]=function(t){o.dumpRegistersOnBreak&&o.dumpRegisters(),t.pc++};var L=a.ramSize;L&&L>0&&L!==i.mcu.ram&&this.attachSPListener(i.mcu.ram+i.mcu.registerSpace-1,L+i.mcu.registerSpace-1),this.scheduler=new zi.B(this.execute)}return(0,a.Z)(t,[{key:"flash",get:function(){return this.cpu.progBytes}},{key:"singleStep",value:function(){var t=this.cpu;!function(t){var e=t.progMem[t.pc];ya[e](t,e),t.pc&=t.progMem.length-1}(t),t.tick()}},{key:"runToBreak",value:function(t){for(var e=this.cpu,i=this.pcMask,n=0;n<t;n++){var r=e.progMem[e.pc];if(ya[r](e,r),e.pc&=i,r===Oa)return;e.tick()}}},{key:"start",value:function(){this.stopped&&(this.scheduler.start(),this.stopped=!1)}},{key:"stop",value:function(){this.scheduler.stop(),this.stopped=!0}},{key:"cpuMillis",get:function(){return Math.floor(this.clock.timeMillis)}},{key:"cpuNanos",get:function(){return Math.floor(this.clock.timeNanos)}},{key:"running",get:function(){return!this.stopped}},{key:"setPausePoint",value:function(t,e){e?this.pausePoints[t/2]=e:delete this.pausePoints[t/2],this.hasPausePoints=Object.keys(this.pausePoints).length>0}},{key:"addEvent",value:function(t,e){this.cpu.addClockEvent(e,t/1e9*this.MHZ)}},{key:"clearEvent",value:function(t){this.cpu.clearClockEvent(t)}},{key:"createEvent",value:function(t){var e=this;return{schedule:function(i){e.clearEvent(t),e.addEvent(i,t)},unschedule:function(){e.clearEvent(t)}}}},{key:"gdbMessage",value:function(t,e){return function(t,e){var i=t.cpu,n=t.eeprom,r=t.forceUpdate;if(e.startsWith("qSupported"))return(0,Xi.KC)("PacketSize=1000");if(e.startsWith("qAttached"))return(0,Xi.KC)("0");if(e.startsWith("qfThreadInfo"))return(0,Xi.KC)("m1");if(e.startsWith("qsThreadInfo"))return(0,Xi.KC)("l");if("?"===e)return(0,Xi.KC)("S05");if("qC"===e)return(0,Xi.KC)("QC01");if(e.startsWith("H"))return(0,Xi.KC)("OK");if("g"===e){var a=new Uint8Array(39),s=new DataView(a.buffer);if(i){for(var o=0;o<32;o++)a[o]=i.data[o]||0;a[32]=i.SREG||0,s.setUint16(33,i.SP,!0),s.setUint32(35,2*i.pc,!0)}return(0,Xi.KC)((0,Xi.NC)(a))}if(e.startsWith("G")){var u=(0,Xi.H_)(e.substr(1)),l=new DataView(u.buffer);if(i&&u.length>=39){for(var d=0;d<32;d++)i.data[d]=u[d];return i.data[95]=u[32],i.SP=l.getUint16(33,!0),i.pc=l.getUint32(35,!0)/2,(0,Xi.KC)("OK")}return(0,Xi.KC)("E00")}if(e.startsWith("m")){var h=(0,c.Z)(e.substr(1).split(","),2),v=h[0],f=h[1],p=parseInt(v,16),g=parseInt(f,16);if(!g||g>=65536)return(0,Xi.KC)("E05");var m=new Uint8Array(g);if(p>=8454144){m.fill(255);for(var y=65535&p,w=0;w<y+g;w++)m[w]=n.readMemory(y+w)}else if(p>=8388608){var k=1048575&p;if(m.fill(0),i)if(k<256)for(var Z=0;Z<g;Z++)m[Z]=i.readData(k+Z);else m.set(i.data.slice(k,k+g))}else m.fill(255),i&&m.set(i.progBytes.slice(p,p+g));return(0,Xi.KC)((0,Xi.NC)(m))}if(e.startsWith("M")){var b=(0,c.Z)(e.substr(1).split(/[,:]/),3),C=b[0],x=b[1],S=b[2],_=parseInt(C,16),P=parseInt(x,16),D=(0,Xi.H_)(S).slice(0,P);if(i){if(_>=8454144)for(var I=65535&_,A=0;A<P;A++)n.eraseMemory(I+A),n.writeMemory(I+A,D[A]);else if(_>=8388608){var R=1048575&_,B=Math.min(D.length,i.data.length-R);if(B>0)if(R<256){for(var E=0;E<B;E++)i.writeData(R+E,D[E]);null===r||void 0===r||r()}else i.data.set(D.slice(0,B),R)}else{var U=Math.min(D.length,i.progBytes.length-_);U>0&&i.progBytes.set(D.slice(0,U),_)}return(0,Xi.KC)("OK")}return(0,Xi.KC)("E05")}return(0,Xi.KC)("")}({cpu:this.cpu,eeprom:this.eepromBackend,forceUpdate:e},t)}},{key:"rewindInstruction",value:function(){this.cpu.pc--}},{key:"attachSPListener",value:function(t,e){var i=this.cpu;i.writeHooks[93]=function(n){var r=i.data[94]<<8|n;return delete i.writeHooks[93],r===t&&(i.SP=e),!1}}},{key:"dumpRegisters",value:function(){var t,e=this.cpu,i=Array.from(e.data.slice(0,32)).map(Wi.sA);console.group("MCU register dump:");for(var n=0;n<32;n+=8){for(var r,a="",s=[],o=0;o<8;o++){var u=n+o;a+="%cr".concat(u,"%c: ").concat(u<10?" ":"","%s   "),s.push("color: blue"),s.push("color: initial"),s.push(i[u])}(r=console).log.apply(r,[a].concat((0,d.Z)(s)))}console.log("%cPC%c: %s  %cSP%c: %s  %cX%c: %s   %cY%c: %s   %cZ%c: %s   %cSREG%c: %s (%cI%cT%cH%cS%cV%cN%cZ%cC%c)","color: purple","color: initial",(0,Wi.Tf)(2*e.pc),"color: green","color: initial",(0,Wi.Tf)(e.SP),"color: brown","color: initial",(0,Wi.Tf)(e.data16[13]),"color: brown","color: initial",(0,Wi.Tf)(e.data16[14]),"color: brown","color: initial",(0,Wi.Tf)(e.data16[15]),"color: purple","color: initial",(t=e.SREG,[7,6,5,4,3,2,1,0].map((function(e){return t&1<<e?"1":"0"})).join("")),128&e.SREG?"font-weight:bold;color:green":"color: #ccc",64&e.SREG?"font-weight:bold;color:green":"color: #ccc",32&e.SREG?"font-weight:bold;color:green":"color: #ccc",16&e.SREG?"font-weight:bold;color:green":"color: #ccc",8&e.SREG?"font-weight:bold;color:green":"color: #ccc",4&e.SREG?"font-weight:bold;color:green":"color: #ccc",2&e.SREG?"font-weight:bold;color:green":"color: #ccc",1&e.SREG?"font-weight:bold;color:green":"color: #ccc","color:initial"),console.groupEnd()}}]),t}(),La={EICRA:105,EICRB:106,EIMSK:61,EIFR:60,index:0,interrupt:2},Fa=(0,l.Z)((0,u.Z)({},La),{index:1,interrupt:4}),Ja=(0,l.Z)((0,u.Z)({},La),{index:2,interrupt:6}),Ka=(0,l.Z)((0,u.Z)({},La),{index:3,interrupt:8}),Wa=(0,l.Z)((0,u.Z)({},La),{index:4,interrupt:10}),Ha=(0,l.Z)((0,u.Z)({},La),{index:5,interrupt:12}),qa=(0,l.Z)((0,u.Z)({},La),{index:6,interrupt:14}),Ga=(0,l.Z)((0,u.Z)({},La),{index:7,interrupt:16}),za={PCIE:1,PCICR:104,PCIFR:59,PCMSK:108,pinChangeInterrupt:20},Xa=(0,l.Z)((0,u.Z)({},Ki.m4),{pinChange:{PCIE:0,PCICR:104,PCIFR:59,PCMSK:107,pinChangeInterrupt:18,mask:255,offset:0},pinChangeIndices:[0,1,2,3,4,5,6,7],externalInterrupts:[]}),ja=(0,l.Z)((0,u.Z)({},Ki.cS),{externalInterrupts:[La,Fa,Ja,Ka]}),Qa=(0,l.Z)((0,u.Z)({},Ki.bO),{pinChange:(0,l.Z)((0,u.Z)({},za),{mask:1,offset:0}),externalInterrupts:[null,null,null,null,Wa,Ha,qa,Ga]}),$a=(0,l.Z)((0,u.Z)({},Ki.Oo),{pinChange:(0,l.Z)((0,u.Z)({},za),{mask:127,offset:1}),externalInterrupts:[]}),Ya=(0,l.Z)((0,u.Z)({},Ki.pW),{pinChange:{PCIE:2,PCICR:104,PCIFR:59,PCMSK:109,pinChangeInterrupt:22,mask:255,offset:0},pinChangeIndices:[0,1,2,3,4,5,6,7],externalInterrupts:[]}),ts={name:"Arduino MEGA 2560",analogPins:["A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","A10","A11","A12","A13","A14","A15"],mcu:wn.ATmega2560,freqMHZ:16e6,createPins:function(t){var e=new Ki.wq(t,Ki.eY),i=new Ki.wq(t,Xa),n=new Ki.wq(t,Ki._d),r=new Ki.wq(t,ja),a=new Ki.wq(t,Qa),s=new Ki.wq(t,Ki.tx),o=new Ki.wq(t,Ki.KT),u=new Ki.wq(t,Ki.lb),l=new Ki.wq(t,$a),c=new Ki.wq(t,Ya),d=new Ki.wq(t,Ki._R);return{0:{port:a,pin:0,signals:[(0,pn.A_)("RX",0)]},1:{port:a,pin:1,signals:[(0,pn.A_)("TX",0)]},2:{port:a,pin:4},3:{port:a,pin:5},4:{port:o,pin:5},5:{port:a,pin:3},6:{port:u,pin:3},7:{port:u,pin:4},8:{port:u,pin:5},9:{port:u,pin:6},10:{port:i,pin:4},11:{port:i,pin:5},12:{port:i,pin:6},13:{port:i,pin:7},14:{port:l,pin:1,signals:[(0,pn.A_)("TX",3)]},15:{port:l,pin:0,signals:[(0,pn.A_)("RX",3)]},16:{port:u,pin:1,signals:[(0,pn.A_)("TX",2)]},17:{port:u,pin:0,signals:[(0,pn.A_)("RX",2)]},18:{port:r,pin:3,signals:[(0,pn.A_)("TX",1)]},19:{port:r,pin:2,signals:[(0,pn.A_)("RX",1)]},20:{port:r,pin:1,signals:[(0,pn.ss)("SDA")]},21:{port:r,pin:0,signals:[(0,pn.ss)("SCL")]},22:{port:e,pin:0},23:{port:e,pin:1},24:{port:e,pin:2},25:{port:e,pin:3},26:{port:e,pin:4},27:{port:e,pin:5},28:{port:e,pin:6},29:{port:e,pin:7},30:{port:n,pin:7},31:{port:n,pin:6},32:{port:n,pin:5},33:{port:n,pin:4},34:{port:n,pin:3},35:{port:n,pin:2},36:{port:n,pin:1},37:{port:n,pin:0},38:{port:r,pin:7},39:{port:o,pin:2},40:{port:o,pin:1},41:{port:o,pin:0},42:{port:d,pin:7},43:{port:d,pin:6},44:{port:d,pin:5},45:{port:d,pin:4},46:{port:d,pin:3},47:{port:d,pin:2},48:{port:d,pin:1},49:{port:d,pin:0},50:{port:i,pin:3,signals:[(0,pn.Q5)("MISO")]},51:{port:i,pin:2,signals:[(0,pn.Q5)("MOSI")]},52:{port:i,pin:1,signals:[(0,pn.Q5)("SCK")]},53:{port:i,pin:0,signals:[(0,pn.Q5)("SS")]},A0:{port:s,pin:0},A1:{port:s,pin:1},A2:{port:s,pin:2},A3:{port:s,pin:3},A4:{port:s,pin:4},A5:{port:s,pin:5},A6:{port:s,pin:6},A7:{port:s,pin:7},A8:{port:c,pin:0},A9:{port:c,pin:1},A10:{port:c,pin:2},A11:{port:c,pin:3},A12:{port:c,pin:4},A13:{port:c,pin:5},A14:{port:c,pin:6},A15:{port:c,pin:7},SDA:{port:r,pin:1,signals:[(0,pn.ss)("SDA")],net:"20"},SCL:{port:r,pin:0,signals:[(0,pn.ss)("SCL")],net:"21"}}}},es=(0,l.Z)((0,u.Z)({},kn),{name:"Arduino Nano",createPins:function(t){var e=kn.createPins(t);return e.A6=(0,l.Z)((0,u.Z)({},e.A5),{pin:6}),e.A7=(0,l.Z)((0,u.Z)({},e.A5),{pin:7}),e}}),is={name:"ATtiny85",analogPins:["PB5","PB2","PB4","PB3"],mcu:wn.ATtiny85,freqMHZ:8e6,createPins:function(t){var e=new Ki.wq(t,dn);return{PB0:{port:e,pin:0,signals:[(0,pn.ss)("SDA")]},PB1:{port:e,pin:1},PB2:{port:e,pin:2,signals:[(0,pn.ss)("SCL")]},PB3:{port:e,pin:3},PB4:{port:e,pin:4},PB5:{port:e,pin:5}}}},ns={"wokwi-arduino-mega":ts,"wokwi-arduino-uno":kn,"wokwi-arduino-nano":es,"wokwi-attiny85":is,"wokwi-franzininho":is};function rs(t){var e;return null!==(e=ns[t])&&void 0!==e?e:kn}var as=function(){function t(){(0,r.Z)(this,t)}return(0,a.Z)(t,[{key:"subscribe",value:function(){return function(){return 0}}}]),t}(),ss=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"buffer",[]),(0,s.Z)(this,"listeners",new Set),e.subscribe((function(t){var e;(e=i.buffer).push.apply(e,(0,d.Z)(t))}))}return(0,a.Z)(t,[{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"update",value:function(){if(this.buffer.length){var t=new Uint8Array(this.buffer),e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(t)}}catch(Ns){i=!0,n=Ns}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}this.buffer=[]}}}]),t}(),os=i(77432);function us(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65536,n=new Uint8Array(t.buffer),r=Math.min(n.indexOf(0,e),e+i+1),a=n.subarray(e,r);return(new TextDecoder).decode(a)}var ls=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"vars",void 0),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"defaultValue",void 0),this.vars=e,this.name=i,this.defaultValue=n}return(0,a.Z)(t,[{key:"readFloat",value:function(){var t;return null!==(t=this.vars.readFloat(this.name))&&void 0!==t?t:this.defaultValue}}]),t}(),cs=function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"dirty",void 0),(0,s.Z)(this,"data",void 0),this.data=e,this.dirty=!1},ds=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this;(0,r.Z)(this,t),(0,s.Z)(this,"_mode",void 0),(0,s.Z)(this,"_value",void 0),(0,s.Z)(this,"_edge",void 0),(0,s.Z)(this,"_dacValue",void 0),(0,s.Z)(this,"callback",void 0),(0,s.Z)(this,"listener",void 0),(0,s.Z)(this,"pin",void 0),this.pin=e,this._mode=0,this._value=!1,this._edge=0,this._dacValue=NaN,this.callback=function(){},this.listener=function(t){(t&&1&n._edge||!t&&2&n._edge)&&n.callback(t?1:0)},this.mode=i}return(0,a.Z)(t,[{key:"mode",get:function(){return this._mode},set:function(t){17!==t&&16!==t||(this._value=17===t,t=1),4!==t||isNaN(this._dacValue)||this.pin.node.analogPort.write(this._dacValue),this._mode=t,this.pin.state=this.outputState}},{key:"analogMode",get:function(){return 4===this.mode}},{key:"value",get:function(){return this._value},set:function(t){this._value=t,this.pin.state=this.outputState}},{key:"edge",get:function(){return this._edge},set:function(t){t&&this.pin.onValueChange(this.listener),this._edge=t}},{key:"dacWrite",value:function(t){this._dacValue=t,this.analogMode&&this.pin.node.analogPort.write(this._dacValue)}},{key:"outputState",get:function(){switch(this._mode){case 0:return Z.J.HighZ;case 2:return Z.J.PullUp;case 3:return Z.J.PullDown;default:return this._value?Z.J.High:Z.J.Low}}}]),t}(),hs=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"bufferPtr",void 0),(0,s.Z)(this,"bufferLen",void 0),(0,s.Z)(this,"bufferIndex",void 0),(0,s.Z)(this,"memory",void 0),(0,s.Z)(this,"spi",void 0),(0,s.Z)(this,"spiConfig",void 0),this.memory=e,this.spi=i,this.spiConfig=n,this.bufferPtr=0,this.bufferLen=0,this.bufferIndex=0,i.onTransmit=function(t){return a.next(t)}}return(0,a.Z)(t,[{key:"start",value:function(t,e){this.bufferPtr=t,this.bufferLen=e,this.bufferIndex=0,this.spi.sendByte(new Uint8Array(this.memory.buffer)[t]),this.spi.paused?this.spi.paused=!1:this.spi.enable()}},{key:"stop",value:function(){this.spi.disable(),this.spiConfig.doneCallback(this.spiConfig.userData,this.bufferPtr,this.bufferIndex)}},{key:"next",value:function(t){var e=this.bufferPtr,i=new Uint8Array(this.memory.buffer);i[e+this.bufferIndex]=t,this.bufferIndex++,this.bufferIndex===this.bufferLen?(this.spi.paused=!0,this.spiConfig.doneCallback(this.spiConfig.userData,this.bufferPtr,this.bufferIndex)):this.spi.sendByte(i[e+this.bufferIndex])}}]),t}(),vs=function(){function t(e,i){var n,a,o,u;(0,r.Z)(this,t),(0,s.Z)(this,"currentChip",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"instance",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"attrs",void 0),(0,s.Z)(this,"vars",void 0),(0,s.Z)(this,"buffer",void 0),(0,s.Z)(this,"attrList",void 0),(0,s.Z)(this,"pinList",void 0),(0,s.Z)(this,"timers",void 0),(0,s.Z)(this,"timerRepeat",void 0),(0,s.Z)(this,"uartDevices",void 0),(0,s.Z)(this,"spiDevices",void 0),(0,s.Z)(this,"buffers",void 0),(0,s.Z)(this,"framebufferWidth",void 0),(0,s.Z)(this,"framebufferHeight",void 0),(0,s.Z)(this,"memory",void 0),this.memory=e,this.currentChip=0,this.attrs=new Map,this.buffer=new cs(new Uint8Array(0)),this.attrList=[],this.pinList=[],this.timers=[],this.timerRepeat=[],this.uartDevices=[],this.spiDevices=[],this.buffers=[],this.framebufferWidth=Math.floor(null!==(o=null===(n=i.display)||void 0===n?void 0:n.width)&&void 0!==o?o:0),this.framebufferHeight=Math.floor(null!==(u=null===(a=i.display)||void 0===a?void 0:a.height)&&void 0!==u?u:0)}return(0,a.Z)(t,[{key:"callbackPtr",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0},n=this.instance,r=null===n||void 0===n?void 0:n.exports.__indirect_function_table;return t&&(0,o.Z)(r,WebAssembly.Table)&&null!==(e=r.get(t))&&void 0!==e?e:i}},{key:"i2cInit",value:function(t){var e=new X.B(new Uint8Array(this.memory().buffer,t)),i=e.readUint32(),n=e.readUint32(),r=e.readUint32(),a=e.readUint32(),s=this.callbackPtr(e.readUint32(),(function(){return 0})),o=this.callbackPtr(e.readUint32(),(function(){return 0})),u=this.callbackPtr(e.readUint32()),l=this.callbackPtr(e.readUint32()),c=new D.A({scl:this.pinList[r].pin,sda:this.pinList[a].pin},n);c.onConnect=function(t,e){return s(i,t,!e)},c.onReadByte=function(){return o(i)},c.onWriteByte=function(t){return u(i,t)},c.onDisconnect=function(){return l(i)}}},{key:"uartInit",value:function(t){var e=new X.B(new Uint8Array(this.memory().buffer,t)),i=e.readUint32(),n=e.readUint32(),r=e.readUint32(),a=e.readUint32(),s=this.callbackPtr(e.readUint32(),(function(){return 0})),o=this.callbackPtr(e.readUint32(),(function(){return 0}));if(this.clock){var u={};if(n>=0)new W.g(this.clock,this.pinList[n].pin,a).subscribe((function(t){var e=!0,n=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var u=a.value;s(i,u)}}catch(Ns){n=!0,r=Ns}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}));return r>=0&&(u.encoder=new H.x(this.clock,this.pinList[r].pin,a),u.encoder.onTxComplete=function(){o(i)}),this.uartDevices.push(u),this.uartDevices.length-1}console.warn("uartInit() called at invalid time")}},{key:"uartWrite",value:function(t,e,i){var n=this.uartDevices[t];if(!n||!n.encoder)return console.warn("uart_write_buf() called with invalid uart_dev_t pointer: 0x".concat((0,Wi.MS)(t))),!1;if(i<1)return console.warn("uart_write_buf() called with invalid buffer size"),!1;if(n.encoder.isBusy)return!1;var r=new Uint8Array(this.memory().buffer).slice(e,e+i);return n.encoder.write(r),!0}},{key:"spiInit",value:function(t){var e=new X.B(new Uint8Array(this.memory().buffer,t)),i={userData:e.readUint32(),sck:e.readInt32(),mosi:e.readInt32(),miso:e.readInt32(),mode:e.readUint32(),doneCallback:this.callbackPtr(e.readUint32(),(function(){return 0}))},n=this.spiDevices,r=i.sck,a=i.mosi,s=i.miso,o=new b({clk:this.pinList[r].pin,mosi:a>=0?this.pinList[a].pin:void 0,miso:s>=0?this.pinList[s].pin:void 0}),u=n.length;return n.push(new hs(this.memory(),o,i)),u}},{key:"spiStart",value:function(t,e,i){return t<0||t>=this.spiDevices.length?(console.warn("spi_start() called with invalid SPI interface: ".concat(t)),-1):(this.spiDevices[t].start(e,i),0)}},{key:"spiStop",value:function(t){return t<0||t>=this.spiDevices.length?(console.warn("spi_stop() called with invalid SPI interface: ".concat(t)),-1):(this.spiDevices[t].stop(),0)}},{key:"pinInit",value:function(t,e){var i,n=this.pinList,r=us(this.memory(),t,256),a=null===(i=this.pins)||void 0===i?void 0:i.get(r);return a?(n.push(new ds(a,e)),n.length-1):-1}},{key:"pinMode",value:function(t,e){t>=this.pinList.length?console.warn("pin_mode() called with invalid pin: ".concat(t)):this.pinList[t].mode=e}},{key:"pinRead",value:function(t){return t>=this.pinList.length?(console.warn("pin_read() called with invalid pin: ".concat(t)),0):this.pinList[t].pin.value?1:0}},{key:"pinWrite",value:function(t,e){t>=this.pinList.length?console.warn("pin_write() called with invalid pin: ".concat(t)):this.pinList[t].value=0!==e}},{key:"pinWatch",value:function(t,e){var i=new X.B(new Uint8Array(this.memory().buffer,e)),n={userData:i.readUint32(),edge:i.readUint32(),pinChange:this.callbackPtr(i.readUint32(),(function(){return 0}))};if(!(t>=this.pinList.length)){var r=this.pinList[t];return!r.edge&&(r.edge=n.edge,r.callback=function(e){n.pinChange(n.userData,t,e)},!0)}console.warn("pin_watch() called with invalid pin: ".concat(t))}},{key:"pinWatchStop",value:function(t){t>=this.pinList.length?console.warn("pin_watch() called with invalid pin: ".concat(t)):this.pinList[t].edge=0}},{key:"pinADCRead",value:function(t){if(t>=this.pinList.length)return console.warn("pin_adc_read() called with invalid pin: ".concat(t)),NaN;var e=this.pinList[t];return e.analogMode?e.pin.node.analogPort.read():(console.warn("pin_adc_read() called for pin ".concat(t,", which is not in ANALOG mode. Returning NaN.")),NaN)}},{key:"pinDACWrite",value:function(t,e){if(!(t>=this.pinList.length))return this.pinList[t].dacWrite(e);console.warn("pin_dac_write() called with invalid pin: ".concat(t))}},{key:"attrInit",value:function(t,e){var i=this.attrList,n=us(this.memory(),t,256),r=this.attrs.get(n),a=r?parseFloat(r):e;return this.vars?(this.vars.initFloat(n,isNaN(a)?e:a),i.push(new ls(this.vars,n,e)),i.length-1):-1}},{key:"attrRead",value:function(t){var e=this.attrList;return t<e.length?e[t].readFloat():(console.warn("attr_read() called with invalid value: ".concat(t)),0)}},{key:"attrInitFloat",value:function(t,e){return this.attrInit(t,e)}},{key:"attrReadFloat",value:function(t){return this.attrRead(t)}},{key:"getSimNanos",value:function(){var t,e;return null!==(e=null===(t=this.clock)||void 0===t?void 0:t.cpuNanos)&&void 0!==e?e:0}},{key:"timerInit",value:function(t){var e,i=this,n=new X.B(new Uint8Array(this.memory().buffer,t)),r={userData:n.readUint32(),callback:this.callbackPtr(n.readUint32(),(function(){return 0}))},a=this.timers.length,s=null===(e=this.clock)||void 0===e?void 0:e.createEvent((function(){r.callback(r.userData);var t=i.timerRepeat[a];t&&(null===s||void 0===s||s.schedule(t))}));return s?(this.timers.push(s),this.timerRepeat.push(0),a):-1}},{key:"timerStart",value:function(t,e,i){this.timerStartNanos(t,1e3*e,i)}},{key:"timerStartNanos",value:function(t,e,i){var n;null===(n=this.timers[t])||void 0===n||n.schedule(e),this.timerRepeat[t]=i?e:0}},{key:"timerStop",value:function(t){var e;null===(e=this.timers[t])||void 0===e||e.unschedule()}},{key:"framebufferInit",value:function(t,e){var i=this.framebufferWidth,n=this.framebufferHeight;this.buffers.push(this.buffer);var r=new DataView(this.memory().buffer);r.setUint32(t,i,!0),r.setUint32(e,n,!0)}},{key:"bufferRead",value:function(t,e,i,n){var r=this.buffers[t].data;r?e+n>r.length||e<0||n<1?console.warn("buffer_read() out of bounds: offset=".concat(e,", data_len=").concat(n,", size=").concat(r.length)):new Uint8Array(this.memory().buffer).set(r.slice(e,e+n),i):console.warn("buffer_read() called with invalid buffer: ".concat(t))}},{key:"bufferWrite",value:function(t,e,i,n){var r=this.buffers[t];r?e+n>r.data.length||e<0||n<1?console.warn("buffer_write() out of bounds: offset=".concat(e,", data_len=").concat(n,", buffer_size=").concat(r.data.length)):(r.data.set(new Uint8Array(this.memory().buffer,i,n),e),r.dirty=!0):console.warn("buffer_write called with invalid buffer: ".concat(t))}}]),t}(),fs='\n#include <stdint.h>\n#include <stdbool.h>\n\n#ifndef WOKWI_API_H\n#define WOKWI_API_H\n\nenum pin_value {\n  LOW = 0,\n  HIGH = 1\n};\n\nenum pin_mode {\n  INPUT = 0,\n  OUTPUT = 1,\n  INPUT_PULLUP = 2,\n  INPUT_PULLDOWN = 3,\n  ANALOG = 4,\n\n  OUTPUT_LOW = 16,\n  OUTPUT_HIGH = 17,\n};\n\nenum edge {\n  RISING = 1,\n  FALLING = 2,\n  BOTH = 3,\n};\n\nint __attribute__((export_name("__wokwi_api_version_1"))) __wokwi_api_version_1(void) { return 1; }\n\n#ifdef __cplusplus\nextern "C" {\n#endif\n\ntypedef int32_t pin_t;\n#define NO_PIN ((pin_t)-1)\n\ntypedef struct {\n  void *user_data;\n  uint32_t edge;\n  void (*pin_change)(void *user_data, pin_t pin, uint32_t value);\n} pin_watch_config_t;\n\nextern __attribute__((export_name("chipInit"))) void chip_init(void);\n\nextern __attribute__((import_name("pinInit"))) pin_t pin_init(const char *name, uint32_t mode);\n\nextern __attribute__((import_name("pinRead"))) uint32_t pin_read(pin_t pin);\nextern __attribute__((import_name("pinWrite"))) void pin_write(pin_t pin, uint32_t value);\nextern __attribute__((import_name("pinWatch"))) bool pin_watch(pin_t pin, const pin_watch_config_t *config);\nextern __attribute__((import_name("pinWatchStop"))) void pin_watch_stop(pin_t pin);\nextern __attribute__((import_name("pinMode"))) void pin_mode(pin_t pin, uint32_t value);\nextern __attribute__((import_name("pinADCRead"))) float pin_adc_read(pin_t pin);\nextern __attribute__((import_name("pinDACWrite"))) float pin_dac_write(pin_t pin, float voltage);\n\nextern __attribute__((import_name("attrInit"))) uint32_t attr_init(const char *name, uint32_t default_value);\nextern __attribute__((import_name("attrInit"))) uint32_t attr_init_float(const char *name, float default_value);\nextern __attribute__((import_name("attrRead"))) uint32_t attr_read(uint32_t attr_id);\nextern __attribute__((import_name("attrReadFloat"))) float attr_read_float(uint32_t attr_id);\n\ntypedef struct {\n  void *user_data;\n  uint32_t address;\n  pin_t scl;\n  pin_t sda;\n  bool (*connect)(void *user_data, uint32_t address, bool connect);\n  uint8_t (*read)(void *user_data);\n  bool (*write)(void *user_data, uint8_t data);\n  void (*disconnect)(void *user_data);\n  uint32_t reserved[8];\n} i2c_config_t;\n\ntypedef uint32_t i2c_dev_t;\n\nextern __attribute__((import_name("i2cInit"))) i2c_dev_t i2c_init(const i2c_config_t *config);\n\ntypedef struct {\n  void *user_data;\n  pin_t rx;\n  pin_t tx;\n  uint32_t baud_rate;\n  void (*rx_data)(void *user_data, uint8_t byte);\n  void (*write_done)(void *user_data);\n  uint32_t reserved[8];\n} uart_config_t;\n\ntypedef uint32_t uart_dev_t;\n\nextern __attribute__((import_name("uartInit"))) uart_dev_t uart_init(const uart_config_t *config);\nextern __attribute__((import_name("uartWrite"))) bool uart_write(uart_dev_t uart, uint8_t *buffer, uint32_t count);\n\ntypedef struct {\n  void *user_data;\n  pin_t sck;\n  pin_t mosi;\n  pin_t miso;\n  uint32_t mode;\n  void (*done)(void *user_data, uint8_t *buffer, uint32_t count);\n  uint32_t reserved[8];\n} spi_config_t;\ntypedef uint32_t spi_dev_t;\n\nextern __attribute__((import_name("spiInit"))) spi_dev_t spi_init(const spi_config_t *spi_config);\nextern __attribute__((import_name("spiStart"))) void spi_start(const spi_dev_t spi, uint8_t *buffer, uint32_t count);\nextern __attribute__((import_name("spiStop"))) void spi_stop(const spi_dev_t spi);\n\ntypedef struct {\n  void *user_data;\n  void (*callback)(void *user_data);\n  uint32_t reserved[8];\n} timer_config_t;\n\ntypedef uint32_t timer_t;\n\nextern __attribute__((import_name("timerInit"))) timer_t timer_init(const timer_config_t *config);\nextern __attribute__((import_name("timerStart"))) void timer_start(const timer_t timer, uint32_t micros, bool repeat);\nextern __attribute__((import_name("timerStartNanos"))) void timer_start_ns_d(const timer_t timer, double nanos, bool repeat);\nstatic void timer_start_ns(const timer_t timer, uint64_t nanos, bool repeat) {\n  timer_start_ns_d(timer, (double)nanos, repeat);\n}\nextern __attribute__((import_name("timerStop"))) void timer_stop(const timer_t timer);\n\nextern __attribute__((import_name("getSimNanos"))) double get_sim_nanos_d(void);\n\nstatic uint64_t get_sim_nanos(void) {\n  return (uint64_t)get_sim_nanos_d();\n}\n\ntypedef uint32_t buffer_t;\nextern __attribute__((import_name("framebufferInit"))) buffer_t framebuffer_init(uint32_t *pixel_width, uint32_t *pixel_height);\nextern __attribute__((import_name("bufferRead"))) void buffer_read(buffer_t buffer, uint32_t offset, uint8_t *data, uint8_t data_len);\nextern __attribute__((import_name("bufferWrite"))) void buffer_write(buffer_t buffer, uint32_t offset, uint8_t *data, uint8_t data_len);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif /* WOKWI_API_H */\n',ps={c:{sourceName:"app.c",sourcePath:"/src/app.c",builder:"clang-wasm",extension:"c",wokwiH:!0},rust:{sourceName:"lib.rs",sourcePath:"/project/lib.rs",builder:"rust-wasm",extension:"rs",wokwiH:!1},verilog:{sourceName:"wokwi.v",sourcePath:"src/wokwi.v",builder:"verilog-cxxrtl",extension:"v",wokwiH:!0}};function gs(t,e,i,n,r){return ms.apply(this,arguments)}function ms(){return ms=(0,n.Z)(f().mark((function t(e,i,n,u,l){var c,h,v,p,g,m,y,w,k,Z,b,C;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[".concat(e,"] \ud83d\udc1e Compiling custom chip...")),(0,o.Z)(i,Uint8Array)&&(i=(new TextDecoder).decode(i)),v=ps[u],t.next=7,(0,Bi.b)([{name:v.sourceName,content:i}].concat((0,d.Z)(v.wokwiH?[{name:"wokwi-api.h",content:fs}]:[])),{builder:v.builder,buildType:"interactive"});case 7:if((p=t.sent).hex&&!(null===(c=p.stderr)||void 0===c?void 0:c.startsWith("Error: Command failed: clang"))){t.next=14;break}return g=e.substring(5)+".chip.".concat(v.extension),m=p.stderr.split("\n").slice(1).join("\n").split(v.sourcePath).join("/sketch/"+g),null===l||void 0===l||l(m),console.error("Build failed:",m),t.abrupt("return");case 14:return y=(0,os.Xs)(p.hex),console.log("[".concat(e,"] \ud83c\udf55 Loading custom chip...")),t.next=18,WebAssembly.compile(y);case 18:return w=t.sent,k=new WebAssembly.Memory({initial:2}),Z=new vs((function(){return k}),n),t.next=23,WebAssembly.instantiate(w,{env:{memory:k,pinInit:Z.pinInit.bind(Z),pinMode:Z.pinMode.bind(Z),pinRead:Z.pinRead.bind(Z),pinWrite:Z.pinWrite.bind(Z),pinWatch:Z.pinWatch.bind(Z),pinWatchStop:Z.pinWatchStop.bind(Z),pinADCRead:Z.pinADCRead.bind(Z),pinDACWrite:Z.pinDACWrite.bind(Z),i2cInit:Z.i2cInit.bind(Z),uartInit:Z.uartInit.bind(Z),uartWrite:Z.uartWrite.bind(Z),spiInit:Z.spiInit.bind(Z),spiStart:Z.spiStart.bind(Z),spiStop:Z.spiStop.bind(Z),attrInit:Z.attrInit.bind(Z),attrRead:Z.attrRead.bind(Z),attrInitFloat:Z.attrInitFloat.bind(Z),attrReadFloat:Z.attrReadFloat.bind(Z),getSimNanos:Z.getSimNanos.bind(Z),timerInit:Z.timerInit.bind(Z),timerStart:Z.timerStart.bind(Z),timerStartNanos:Z.timerStartNanos.bind(Z),timerStop:Z.timerStop.bind(Z),framebufferInit:Z.framebufferInit.bind(Z),bufferRead:Z.bufferRead.bind(Z),bufferWrite:Z.bufferWrite.bind(Z),debugPrint:function(t){var i=us(k,t);console.log("[".concat(e,"] %c%s"),"color: green",i.replace(/\r?\n$/,""))},emscripten_notify_memory_growth:function(){}},wasi_snapshot_preview1:{fd_write:function(t,i,n,r){for(var a=[],s=0,o=new DataView(k.buffer),u=0;u<n;u++){var l,c=o.getUint32(i+8*u,!0),h=o.getUint32(i+8*u+4,!0);s+=h,(l=a).push.apply(l,(0,d.Z)(new Uint8Array(o.buffer,c,h)))}o.setUint32(r,s,!0),console.log("[".concat(e,"] %c%s"),"color: green",(new TextDecoder).decode(new Uint8Array(a)).replace(/\r?\n$/,""))},fd_close:function(){},fd_seek:function(){},fd_fdstat_get:function(t,e){if(1===t||1===t){var i=new DataView(k.buffer);return i.setUint8(e,2),i.setUint32(e+8,0,!0),0}return-1},proc_exit:function(){}}});case 23:return(b=t.sent).exports.memory&&(0,o.Z)(b.exports.memory,WebAssembly.Memory)&&(k=b.exports.memory),Z.instance=b,t.abrupt("return",(h=function(){function t(i,n,a,o){(0,r.Z)(this,t),(0,s.Z)(this,"buffer",new cs(new Uint8Array(Z.framebufferWidth*Z.framebufferHeight*4))),Z.clock=i,Z.pins=n,Z.attrs=a,Z.vars=o,Z.buffer=this.buffer;try{var u;null===(u=b.exports.chipInit)||void 0===u||u(),console.log("[".concat(e,"] \ud83c\udf1f Custom chip instance created!"))}catch(Ns){console.error("[".concat(e,"] Custom chip instance creation failed:"),Ns)}}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.buffer;return t.dirty?(t.dirty=!1,{value:{pixels:t.data}}):null}},{key:"reset",value:function(){}}]),t}(),(0,s.Z)(h,"pinNames",null!==(C=n.pins)&&void 0!==C?C:[]),h));case 28:case"end":return t.stop()}}),t)}))),ms.apply(this,arguments)}var ys=i(67044),ws=i(60286),ks=function(){function t(){(0,r.Z)(this,t)}return(0,a.Z)(t,[{key:"write",value:function(){}}]),t}(),Zs=i(41725),bs=function(){function t(e,i,n,a){(0,r.Z)(this,t),(0,s.Z)(this,"partId",void 0),(0,s.Z)(this,"pinNames",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"clock",void 0),this.partId=e,this.pinNames=i,this.pins=n,this.clock=a}return(0,a.Z)(t,[{key:"get",value:function(t){this.pinNames.includes(t)||console.warn('Part "'.concat(this.partId,'" requested undefined pin: "').concat(t,'"'));var e=(0,Zs.r4)(this.partId,t),i=this.pins.get(e);return i||new Z.U(new ji.Y(this.clock),e)}},{key:"getIfAttached",value:function(t){return this.attached(t)?this.get(t):null}},{key:"attached",value:function(t){var e=(0,Zs.r4)(this.partId,t);return this.pinNames.includes(t)&&this.pins.has(e)}}]),t}(),Cs=i(57954),xs=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"nodes",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.nodes=new Map,this.pins=new Map}return(0,a.Z)(t,[{key:"clear",value:function(){this.nodes.clear(),this.pins.clear()}},{key:"getOrCreatePin",value:function(t){var e=this.pins.get(t);if(!e){var i=new ji.Y(this.clock);this.nodes.set(t,i),e=new Z.U(i,t),this.pins.set(t,e)}return e}}]),t}(),Ss="$mcu",_s=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"controllers",void 0),(0,s.Z)(this,"mcuId",void 0),(0,s.Z)(this,"rx",void 0),(0,s.Z)(this,"tx",void 0),(0,s.Z)(this,"netlist",void 0),(0,s.Z)(this,"mcuPinToBoardPin",void 0),(0,s.Z)(this,"mcu",void 0),(0,s.Z)(this,"chipControllers",void 0),this.mcu=e,this.chipControllers=i,this.controllers=[],this.mcuId=Ss,this.rx=new as,this.tx=new ks,this.netlist=new xs(this.mcu),this.mcuPinToBoardPin=new Map}return(0,a.Z)(t,[{key:"attach",value:function(t){var e;this.netlist.clear();var i,n=(0,d.Z)(t.connections),r=null!==(i=null===(e=t.findMCU())||void 0===e?void 0:e.id)&&void 0!==i?i:Ss,a=!0,s=!1,o=void 0;try{for(var u,l=this.mcu.pins[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;c.net&&c.net!==c.name&&n.push(ws.aG.create(["".concat(r,":").concat(c.name),"".concat(r,":").concat(c.net),""]))}}catch(Ns){s=!0,o=Ns}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}var h=t.board.pins,v=!0,f=!1,g=void 0;try{for(var m,y=(null!==h&&void 0!==h?h:[])[Symbol.iterator]();!(v=(m=y.next()).done);v=!0){var w=m.value;"string"!==typeof w.target||w.target.includes(":")||n.push(ws.aG.create(["".concat(r,":").concat(w.name),"".concat(r,":_mcu$").concat(w.target),""]))}}catch(Ns){f=!0,g=Ns}finally{try{v||null==y.return||y.return()}finally{if(f)throw g}}var k=(0,Zs.XP)(n),b=!0,C=!1,x=void 0;try{for(var S,_=new Set(k.values())[Symbol.iterator]();!(b=(S=_.next()).done);b=!0){var P=S.value.pins,D=new ji.Y(this.mcu),I=!0,A=!1,R=void 0;try{for(var B,E=P[Symbol.iterator]();!(I=(B=E.next()).done);I=!0){var U=B.value;this.netlist.nodes.set(U,D),this.netlist.pins.set(U,new Z.U(D,U))}}catch(Ns){A=!0,R=Ns}finally{try{I||null==E.return||E.return()}finally{if(A)throw R}}}}catch(Ns){C=!0,x=Ns}finally{try{b||null==_.return||_.return()}finally{if(C)throw x}}this.mcuPinToBoardPin.clear();var N=!0,T=!1,O=void 0;try{for(var M,V=this,L=function(t,e){var i=e.value,n=V.netlist.getOrCreatePin((0,Zs.r4)(r,i.name));if("target"in i){var a=V.mcu.pins.find((function(t){return t.name===i.target}));if(a)a.attach(n),V.mcuPinToBoardPin.set(a.name,i.name);else if("string"!==typeof i.target&&"power"===i.target.type){new qi.E(i.name,i.target.voltage?Z.J.High:Z.J.Low).attach(n)}}else i.attach(n)},F=(h||this.mcu.pins)[Symbol.iterator]();!(N=(M=F.next()).done);N=!0)L(0,M)}catch(Ns){T=!0,O=Ns}finally{try{N||null==F.return||F.return()}finally{if(T)throw O}}var J=this.chipControllers,K=this.netlist.pins,W=!0,H=!1,q=void 0;try{for(var G,z=this,X=function(t,e){var i,n=e.value,r=null!==(i=Pi[n.type])&&void 0!==i?i:J[n.type];if(r){var a={initFloat:function(t,e){n.setFloatVar(t,(0,Cs.R)(n.attrs.get(t),e))},readFloat:function(t){return n.readFloatVar(t,0)},autorun:p.EH},s=new r(z.mcu,new bs(n.id,r.pinNames,K,z.mcu),n.attrs,a);z.controllers.push([n,s])}},j=t.parts[Symbol.iterator]();!(W=(G=j.next()).done);W=!0)X(0,G)}catch(Ns){H=!0,q=Ns}finally{try{W||null==j.return||j.return()}finally{if(H)throw q}}this.mcuId=r,this.createSerialMonitor()}},{key:"initSimulation",value:function(t,e){var i=this;return(0,n.Z)(f().mark((function n(){var r;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=i.controllers.map((function(i){var n,r=(0,c.Z)(i,2)[1];return null===(n=r.init)||void 0===n?void 0:n.call(r,{files:t,wifi:e})})),n.next=3,Promise.all(r);case 3:case"end":return n.stop()}}),n)})))()}},{key:"createSerialMonitor",value:function(){var t,e,i,n=this.mcu,r=this.mcuPinToBoardPin,a=this.netlist.pins,s=this.mcu.defaultUartPins,u=new bs("$serialMonitor",["RX","TX"],a,n),l=u.getIfAttached("RX"),c=u.getIfAttached("TX"),d=function(e){return null!==(t=e&&r.get(e))&&void 0!==t?t:e},h=null!==(e=d(null===s||void 0===s?void 0:s.rx))&&void 0!==e?e:"$_RX",v=null!==(i=d(null===s||void 0===s?void 0:s.tx))&&void 0!==i?i:"$_TX",f=new bs(this.mcuId,[h,v],a,n);l?this.rx=new W.g(n,l):n.serialInterface?this.rx=n.serialInterface:this.rx=new W.g(n,f.get(h)),(0,o.Z)(this.rx,W.g)&&(this.rx.autoBaudRate=!0),c?this.tx=new H.x(n,c):n.serialInterface?this.tx=n.serialInterface:this.tx=new H.x(n,f.get(v)),(0,o.Z)(this.tx,H.x)&&(this.tx.autoBaudRate=!0)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[],i=!0,n=!1,r=void 0;try{for(var a,s=this.controllers[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=(0,c.Z)(a.value,2),u=o[0],l=o[1],d=l.update(t);d&&e.push({id:u.id,update:d})}}catch(Ns){n=!0,r=Ns}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}return e}},{key:"dispatchEvent",value:function(t,e){var i=!0,n=!1,r=void 0;try{for(var a,s=this.controllers[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o,u=(0,c.Z)(a.value,2),l=u[0],d=u[1];if(l.id===t)null===(o=d.onEvent)||void 0===o||o.call(d,e)}}catch(Ns){n=!0,r=Ns}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"pause",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.controllers[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a,s=(0,c.Z)(n.value,2)[1];null===(a=s.pause)||void 0===a||a.call(s)}}catch(Ns){e=!0,i=Ns}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"resume",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.controllers[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a,s=(0,c.Z)(n.value,2)[1];null===(a=s.resume)||void 0===a||a.call(s)}}catch(Ns){e=!0,i=Ns}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"reset",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,c.Z)(r.value,2)[1].reset(t)}}catch(Ns){i=!0,n=Ns}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"findPin",value:function(t){return this.netlist.pins.get(t)}},{key:"serialRx",get:function(){return this.rx}},{key:"serialTx",get:function(){return this.tx}}]),t}(),Ps=i(3615);function Ds(t,e){for(var i=t.toString();i.length<e;)i="0"+i;return i}function Is(t){var e=Math.floor(1e3*t)%1e3,i=Math.floor(t%60),n=Math.floor(t/60);return"".concat(Ds(n,2),":").concat(Ds(i,2),".").concat(Ds(e,3))}var As,Rs=i(21706);function Bs(t){return Es.apply(this,arguments)}function Es(){return Es=(0,n.Z)(f().mark((function t(e){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0,null]);case 7:return t.prev=7,t.t1=t.catch(0),t.abrupt("return",[null,t.t1]);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),Es.apply(this,arguments)}!function(t){t[t.Stopped=0]="Stopped",t[t.Running=1]="Running",t[t.Paused=2]="Paused"}(As||(As={}));var Us=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"abortController",void 0),(0,s.Z)(this,"simulationController",void 0),(0,s.Z)(this,"lastOptions",void 0),(0,s.Z)(this,"bufferedSerialRx",void 0),(0,s.Z)(this,"boardRegistry",void 0),(0,s.Z)(this,"mcu",void 0),(0,s.Z)(this,"building",void 0),(0,s.Z)(this,"paused",void 0),(0,s.Z)(this,"restarting",void 0),(0,s.Z)(this,"breakpoint",void 0),(0,s.Z)(this,"debugging",void 0),(0,s.Z)(this,"buildResult",void 0),(0,s.Z)(this,"showPioDebugger",void 0),(0,s.Z)(this,"showSDCardDownload",void 0),(0,s.Z)(this,"sdCardDownloadSkipped",void 0),(0,s.Z)(this,"lastUpdate",void 0),(0,s.Z)(this,"lastUpdatedNanos",void 0),(0,s.Z)(this,"wifiManager",void 0),(0,s.Z)(this,"partValues",void 0),(0,s.Z)(this,"overrideHex",void 0),(0,s.Z)(this,"localLibraryDirectory",void 0),(0,s.Z)(this,"speedElement",void 0),(0,s.Z)(this,"timeElement",void 0),(0,s.Z)(this,"onBuildFailure",void 0),(0,s.Z)(this,"serial",void 0),this.serial=e,this.abortController=null,this.simulationController=null,this.lastOptions=null,this.bufferedSerialRx=null,this.boardRegistry=new Ii,this.mcu=null,this.building=!1,this.paused=!1,this.restarting=!1,this.breakpoint=!1,this.debugging=!1,this.buildResult=null,this.showPioDebugger=!1,this.showSDCardDownload=!1,this.sdCardDownloadSkipped=!1,this.lastUpdate={},this.lastUpdatedNanos=-1,this.partValues={},this.speedElement=null,this.timeElement=null,this.onBuildFailure=function(t){console.log(t),alert("Build failed!")},(0,p.rC)(this);var i=this;window.addEventListener("visibilitychange",(function(){var t,e;i.paused||(document.hidden?null===(t=i.simulationController)||void 0===t||t.pause():null===(e=i.simulationController)||void 0===e||e.resume())}))}return(0,a.Z)(t,[{key:"running",get:function(){return!!this.mcu}},{key:"status",get:function(){return this.running?this.paused?As.Paused:As.Running:As.Stopped}},{key:"reportGCCErrors",value:function(t,e){if(this.lastOptions){var i=(0,g.G_)(this.lastOptions.files);(0,g.oL)(i)===Ai.IK&&i.setGCCErrors(t,e)}}},{key:"build",value:function(t,e){var i=this;return(0,n.Z)(f().mark((function n(){var r,a,s,o,d,h,v,p,g,m,w,k,Z,b,C,x,S,_,P,D,I,A;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i.lastOptions=t,s=t.diagram,o=t.files,d=t.listing,h=t.debug,v=t.elf,p=s.findMCU(),m=parseInt(null!==(g=null===p||void 0===p?void 0:p.attrs.get("__fakeRamSize"))&&void 0!==g?g:"0",10),k=(0,Dt.Z)(null!==(w=null===p||void 0===p?void 0:p.attrs.get("frequency"))&&void 0!==w?w:"0"),b=null!==(Z=null===p||void 0===p?void 0:p.attrs.get("env"))&&void 0!==Z?Z:"",x=(0,y.nr)(null!==(C=null===p||void 0===p?void 0:p.type)&&void 0!==C?C:"",b),S=(0,l.Z)((0,u.Z)({elf:v,listing:d,debug:h},m&&{ramSize:m},k&&{cpuFreq:k}),{symbols:x.startsWith("esp32")}),_=Ei.h.find((function(e){return e.club&&e.id===t.userId})),n.t0=c.Z,n.next=17,Bs((function(){return(0,Bi.b)(o,{abortSignal:e,board:x,builder:null===p||void 0===p?void 0:p.attrs.get("builder"),options:S,userId:t.userId,localLibraryDirectory:i.localLibraryDirectory,projectId:t.projectId,buildType:t.thumbnail?"thumbnail":_?"club":"interactive"})}));case 17:return n.t1=n.sent,P=(0,n.t0)(n.t1,2),D=P[0],I=P[1],(null===D||void 0===D||null===(r=D.stderr)||void 0===r?void 0:r.includes("Error during build"))&&(D.hex=""),i.reportGCCErrors((null===D||void 0===D?void 0:D.stderr)||"",(null!==(A=null===D||void 0===D||null===(a=D.hex)||void 0===a?void 0:a.length)&&void 0!==A?A:0)>0),n.abrupt("return",{hex:D,hexError:I});case 25:case"end":return n.stop()}}),n)})))()}},{key:"loadPrebuiltHex",value:function(t){return{hex:{hex:t,stderr:"",stdout:""},hexError:null}}},{key:"skipSDCardDownload",value:function(){this.sdCardDownloadSkipped=!0}},{key:"ensureSDCardFiles",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var n;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(n=t.filter((function(t){return t.downloading})).map((function(t){return(0,p.gx)((function(){return!t.downloading}))}))).length){i.next=7;break}return e.showSDCardDownload=!0,e.sdCardDownloadSkipped=!1,i.next=6,Promise.race([Promise.all(n),(0,p.gx)((function(){return e.sdCardDownloadSkipped}))]);case 6:(0,p.z)((function(){e.showSDCardDownload=!1}));case 7:return i.abrupt("return",t.filter((function(t){return t.buffer})).map((function(t){return{name:t.name.substring(Ai.ir.length),content:new Uint8Array(t.buffer)}})));case 8:case"end":return i.stop()}}),i)})))()}},{key:"getRuntime",value:function(t,e,i){var n,r=null===e||void 0===e?void 0:e.split("-"),a=null===r||void 0===r?void 0:r[0],s=null===r||void 0===r?void 0:r.slice(1).join("-"),o=t.environments[a];if(!o)return null;switch(a){case"kaluma":var c,d,h=null!==(d=null===(c=i.find((function(t){return"code.js"===t.name})))||void 0===c?void 0:c.content)&&void 0!==d?d:"none";o.fs&&(o=(0,l.Z)((0,u.Z)({},o),{fs:(0,l.Z)((0,u.Z)({},o.fs),{overlays:[{offset:1048576,data:(new TextEncoder).encode(h+"\0")}]})}));break;case"circuitpython":o.fs||(o=(0,l.Z)((0,u.Z)({},o),{fs:{type:"fat",flashOffset:2097152,blockSize:512,numBlocks:1024}}))}return o.firmware&&o.defaultVersion?{firmwareURL:o.firmware.replace("$VERSION",s||o.defaultVersion),type:null!==(n=o.type)&&void 0!==n?n:"binary",fs:o.fs}:null}},{key:"loadCustomBoards",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.boardRegistry.loadBoards(t.parts.map((function(t){return t.type})).filter((function(t){return t.startsWith("board-")})).map((function(t){return t.replace(/^board-/,"")})));case 2:case"end":return i.stop()}}),i)})))()}},{key:"start",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var n,r,a,s,u,l,c,d,h,v,p,g,m,y,w,k,Z;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return e.lastOptions=t,r=t.diagram.board,a=t.files.find((function(t){return"main.py"===t.name}))?"micropython":"",u=e.getRuntime(r,null!==(s=null===(n=t.diagram.findMCU())||void 0===n?void 0:n.attrs.get("env"))&&void 0!==s?s:a,t.files),i.prev=6,null===(l=e.abortController)||void 0===l||l.abort(),e.building=!0,e.abortController=new AbortController,h=e.abortController.signal,e.mcu&&e.stop(),v=u&&"plotter"!==(null===(c=t.diagram.serialMonitor)||void 0===c?void 0:c.display)?"terminal":null===(d=t.diagram.serialMonitor)||void 0===d?void 0:d.display,e.serial.init((0,Ri.m)(v)),e.showPioDebugger=!1,i.next=18,e.loadCustomBoards(t.diagram);case 18:return i.next=21,e.ensureSDCardFiles(null!==(p=t.sdCardFiles)&&void 0!==p?p:[]);case 21:if(li.files=i.sent,!u){i.next=24;break}return i.abrupt("return",e.startRuntime(u,t,h));case 24:if(m=null!==(g=t.sideHex)&&void 0!==g?g:e.overrideHex,!(0,o.Z)(m,ArrayBuffer)){i.next=30;break}return i.next=29,e.loadHex("",t.diagram,!0,h,t.files,m);case 29:return i.abrupt("return",i.sent);case 30:if(!m){i.next=34;break}i.t0=e.loadPrebuiltHex(m),i.next=37;break;case 34:return i.next=36,e.build(t,h);case 36:i.t0=i.sent;case 37:if(y=i.t0,w=y.hex,k=y.hexError,!h.aborted){i.next=43;break}return console.log("Build aborted"),i.abrupt("return");case 43:if(e.buildResult=w,!k){i.next=48;break}return console.error(k),alert("Build server failure: "+k),i.abrupt("return");case 48:if(null===w||void 0===w?void 0:w.hex){i.next=52;break}return e.onBuildFailure(null!==(Z=null===w||void 0===w?void 0:w.stderr)&&void 0!==Z?Z:"Unknown build error"),i.abrupt("return");case 52:return i.next=54,e.loadHex(w.hex,t.diagram,!t.autoPause,h,t.files);case 54:return i.prev=54,e.building=!1,i.finish(54);case 57:case"end":return i.stop()}}),i,null,[[6,,54,57]])})))()}},{key:"startRuntime",value:function(t,e,i){var r=this;return(0,n.Z)(f().mark((function n(){var a,s,o,u,l,c,h;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=4,fetch(t.firmwareURL);case 4:if(s=n.sent,!i.aborted){n.next=7;break}return n.abrupt("return");case 7:if("hex"!==t.type){n.next=13;break}return n.next=10,s.text();case 10:n.t0=n.sent,n.next=14;break;case 13:n.t0="";case 14:if(o=n.t0,"binary"!==t.type){n.next=21;break}return n.next=18,s.arrayBuffer();case 18:n.t1=n.sent,n.next=22;break;case 21:n.t1=void 0;case 22:if(u=n.t1,!i.aborted){n.next=25;break}return n.abrupt("return");case 25:if(l=null===(a=e.files.find((function(t){return"requirements.txt"===t.name})))||void 0===a?void 0:a.content,n.t2=d.Z,!l){n.next=34;break}return n.next=31,Li(l);case 31:n.t3=n.sent,n.next=35;break;case 34:n.t3=[];case 35:return n.t4=n.t3,h=(0,n.t2)(n.t4).concat((0,d.Z)(e.files),(0,d.Z)(null!==(c=e.binaryFiles)&&void 0!==c?c:[])),n.next=39,r.loadHex(o,e.diagram,!0,i,h,u,t.fs,t.firmwareURL);case 39:return n.prev=39,r.building=!1,n.finish(39);case 42:case"end":return n.stop()}}),n,null,[[0,,39,42]])})))()}},{key:"createMCURunner",value:function(t,e,r,a,s,o){var u=this;return(0,n.Z)(f().mark((function n(){var l,c,d,h,v,p,g,m,y,w,k,Z,b,C,x,S,_;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:u.wifiManager=void 0,c=(null===(l=u.buildResult)||void 0===l?void 0:l.hex)===e?u.buildResult.symbols:void 0,n.t0=t,n.next="esp32"===n.t0||"esp32-c3"===n.t0||"esp32-s2"===n.t0||"esp32-s3"===n.t0?6:"rp2040"===n.t0?24:"avr"===n.t0?32:"stm32f103c8"===n.t0||"stm32l432kc"===n.t0?39:45;break;case 6:return d=null===r||void 0===r?void 0:r.attrs.get("firmwareOffset"),h=null===r||void 0===r?void 0:r.attrs.get("flashSize"),p=null!==(v=null===r||void 0===r?void 0:r.attrs.get("psramSize"))&&void 0!==v?v:"4",g="1"===(null===r||void 0===r?void 0:r.attrs.get("fullBoot")),n.next=13,Promise.all([i.e(3421),i.e(2442),i.e(3244)]).then(i.bind(i,43244));case 13:return n.t1=n.sent.ESPRunner,n.t2=e,n.t3={firmwareBinary:s,firmwareOffset:d?parseInt(d):void 0,flashSizeMB:h?parseInt(h,10):void 0,psramSizeMB:p?parseInt(p,10):void 0,fullBoot:g,chip:t,symbols:c,partitionsCsv:(0,Ui.LR)(null===a||void 0===a?void 0:a.find((function(t){return"partitions.csv"===t.name}))),noCyclesOpt:"disable"===(null===r||void 0===r?void 0:r.attrs.get("__timingOptimizations")),badgeApp:null===r||void 0===r?void 0:r.attrs.get("badgeApp"),idlePC:"https://wokwi.github.io/firmware-assets/circuitpython/adafruit-circuitpython-franzininho_wifi_wroom-en_US-7.0.0.bin"===o?1074402670:0},m=new n.t1(n.t2,n.t3),u.wifiManager=m.wifi,n.next=20,m.loadBootrom();case 20:if("1"!==(null===r||void 0===r?void 0:r.attrs.get("fastTLS"))){n.next=23;break}return n.next=23,m.patchTLS();case 23:return n.abrupt("return",m);case 24:return n.next=28,Promise.all([i.e(2319),i.e(3368),i.e(8107)]).then(i.bind(i,53368));case 28:return n.t4=n.sent.RPRunner,n.t5=e,n.t6={showPIODebugger:function(){u.togglePIODebugger(!0)},firmwareBinary:s,python:!!o&&!(null===(y=null===r||void 0===r?void 0:r.attrs.get("env"))||void 0===y?void 0:y.startsWith("kaluma-")),patchCircuitPython:null!==(k=null===(w=null===r||void 0===r?void 0:r.attrs.get("env"))||void 0===w?void 0:w.startsWith("circuitpython-"))&&void 0!==k&&k,readonlyFlash:"1"===(null===r||void 0===r?void 0:r.attrs.get("__readonlyFlash"))},n.abrupt("return",new n.t4(n.t5,n.t6));case 32:return b=parseInt(null!==(Z=null===r||void 0===r?void 0:r.attrs.get("__fakeRamSize"))&&void 0!==Z?Z:"0",10),x=(0,Dt.Z)(null!==(C=null===r||void 0===r?void 0:r.attrs.get("frequency"))&&void 0!==C?C:"0"),_=rs(null!==(S=null===r||void 0===r?void 0:r.type)&&void 0!==S?S:""),n.abrupt("return",new Va(e,_,void 0,{ramSize:b,frequency:x,firmwareBinary:s}));case 39:return n.next=41,Promise.all([i.e(1311),i.e(5068),i.e(7690),i.e(6723)]).then(i.bind(i,36723));case 41:return n.t7=n.sent.STM32Runner,n.t8=e,n.t9={chip:t},n.abrupt("return",new n.t7(n.t8,n.t9));case 45:case"end":return n.stop()}}),n)})))()}},{key:"loadChips",value:function(t){var e=this;return(0,n.Z)(f().mark((function i(){var r,a,s;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r={},a=!1,s=function(){var i=(0,n.Z)(f().mark((function i(n){var s,o,u,l,c,d,h,v,p;return f().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=n.name.split(".")[0],u=o+".chip.json",l="chip-"+o,d=null!==(c=null===(s=t.find((function(t){return t.name===u})))||void 0===s?void 0:s.content)&&void 0!==c?c:"",v=null!==(h=(0,Rs.C)("string"===typeof d?d:(new TextDecoder).decode(d)))&&void 0!==h?h:{},i.next=10,gs(l,n.content,v,n.name.endsWith(".rs")?"rust":n.name.endsWith(".v")?"verilog":"c",(function(t){a=!0,e.reportGCCErrors(t,!1),e.onBuildFailure(t)}));case 10:(p=i.sent)&&(r[l]=p);case 12:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}(),i.next=5,Promise.all(null===t||void 0===t?void 0:t.filter((function(t){return"chip"===(0,Ui.r5)(t.name)})).map(s));case 5:return i.abrupt("return",a?null:r);case 6:case"end":return i.stop()}}),i)})))()}},{key:"loadHex",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0,l=this;return(0,n.Z)(f().mark((function n(){var c,d,h,v,p,g,m,y,w,k,Z,b,C;return f().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(v=e.findMCU(),!a){n.next=8;break}return n.next=5,l.loadChips(a);case 5:n.t0=n.sent,n.next=9;break;case 8:n.t0={};case 9:if(p=n.t0){n.next=12;break}return n.abrupt("return");case 12:return g=0,m=0,y=function(){var t=(new Date).getTime(),e=w.cpuMillis;if(l.speedElement&&t-g>500){var i=(e-m)/(t-g);m=e,g=t,l.speedElement.textContent="".concat(Math.floor(100*i).toFixed(0),"%")}l.timeElement&&(l.timeElement.textContent=Is(e/1e3))},n.next=17,l.createMCURunner(e.board.mcuType,t,v,a,s,u);case 17:if((w=n.sent).scheduler.afterRun=y,!(null===r||void 0===r?void 0:r.aborted)){n.next=21;break}return n.abrupt("return");case 21:if(!a||!o){n.next=28;break}return null===(k=w.adjustFSConfig)||void 0===k||k.call(w,o),n.next=26,(0,ys.z)(w.flash,o,a);case 26:if(!(null===r||void 0===r?void 0:r.aborted)){n.next=28;break}return n.abrupt("return");case 28:return(Z=new _s(w,p)).attach(e),l.wifiManager||(l.wifiManager=new Ps.c(w)),l.wifiManager.setCredentials({user:null!==(b=null===(c=l.lastOptions)||void 0===c?void 0:c.userId)&&void 0!==b?b:"",project:null!==(C=null===(d=l.lastOptions)||void 0===d?void 0:d.projectId)&&void 0!==C?C:""}),n.next=35,Z.initSimulation(null!==a&&void 0!==a?a:[],l.wifiManager);case 35:l.simulationController=Z,l.lastUpdatedNanos=-1,"never"===(null===(h=e.serialMonitor)||void 0===h?void 0:h.display)||(l.bufferedSerialRx=new ss(Z.serialRx),l.bufferedSerialRx.subscribe((function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=t[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;l.serial.appendSerial(s)}}catch(Ns){i=!0,n=Ns}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}))),w.onBreak=function(){return!!l.debugging&&(w.rewindInstruction(),l.breakpoint=!0,l.pause(),!0)},w.onDebuggerBreakpoint=function(){l.pause()},l.mcu=w,l.breakpoint=!1,i?l.resume():l.paused=!0,l.restarting=!1,l.update();case 46:case"end":return n.stop()}}),n)})))()}},{key:"update",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this,n=i.simulationController,r=i.mcu;if(n&&r){if(r.cpuNanos!==this.lastUpdatedNanos){var a,s={};null===(a=this.bufferedSerialRx)||void 0===a||a.update();var o=!0,u=!1,l=void 0;try{for(var c,d=n.update(e)[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,v=h.id,f=h.update;s[v]=f.value}}catch(Ns){u=!0,l=Ns}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}this.lastUpdate=s,this.lastUpdatedNanos=r.cpuNanos,Object.assign(this.partValues,s)}if(null===(t=this.mcu)||void 0===t?void 0:t.running){var p=this;requestAnimationFrame((function(){return p.update()}))}}}},{key:"dispatchEvent",value:function(t,e){var i;null===(i=this.simulationController)||void 0===i||i.dispatchEvent(t,e)}},{key:"pause",value:function(){var t,e;this.update(!0),null===(t=this.mcu)||void 0===t||t.stop(),null===(e=this.simulationController)||void 0===e||e.pause(),this.paused=!0}},{key:"resume",value:function(){var t,e;this.paused=!1,this.breakpoint=!1,null===(t=this.mcu)||void 0===t||t.start(),null===(e=this.simulationController)||void 0===e||e.resume(),this.update()}},{key:"stop",value:function(){var t,e;null===(t=this.simulationController)||void 0===t||t.reset(!0),this.update(),null===(e=this.mcu)||void 0===e||e.stop(),this.mcu=null,this.paused=!1,this.simulationController=null,this.partValues={},this.speedElement&&(this.speedElement.textContent="0%")}},{key:"feedSerial",value:function(t){var e;null===(e=this.simulationController)||void 0===e||e.serialTx.write((new TextEncoder).encode(t))}},{key:"findPin",value:function(t){var e;return null===(e=this.simulationController)||void 0===e?void 0:e.findPin(t)}},{key:"togglePIODebugger",value:function(t){this.showPioDebugger=t}},{key:"singleStep",value:function(){var t,e;this.breakpoint=!1,null===(t=this.mcu)||void 0===t||null===(e=t.singleStep)||void 0===e||e.call(t),this.update(!0)}},{key:"forceUpdate",value:function(){this.lastUpdatedNanos=-1,this.update(!0)}},{key:"lastUpdateNanos",get:function(){return this.lastUpdatedNanos}},{key:"closeProject",value:function(){this.stop(),this.serial.clearSerial(),this.serial.hideSerial()}},{key:"gdbMessage",value:function(t){var e,i=this;if("c"===t||t.startsWith("vCont;c"))return this.paused&&this.resume(),null;if("s"===t)return this.singleStep(),(0,Xi.KC)("S05");if(t.startsWith("vFile:"))return this.gdbFileMessage(t);if(t.startsWith("qRcmd,")){var n=this.gdbMonitor((0,Xi.nX)(t.split(",")[1]));if(n)return n}return null===(e=this.mcu)||void 0===e?void 0:e.gdbMessage(t,(function(){i.paused&&i.forceUpdate()}))}},{key:"gdbMonitor",value:function(t){var e,i=null!==(e=t.split(" ")[1])&&void 0!==e?e:"";switch(t){case"reset":case"reset debug":case"reset halt":case"reset init":return this.lastOptions?(console.log("Restarting simulation..."),this.restarting=!0,this.start((0,u.Z)((0,l.Z)((0,u.Z)({},this.lastOptions),{autoPause:""!==i}),"debug"===i?{elf:!0,debug:!0}:{})),(0,Xi.KC)("O"+(0,Xi.Nc)("Restarting simulation...\n"))+(0,Xi.KC)("OK")):(0,Xi.KC)("")}}},{key:"gdbFileMessage",value:function(t){var e=(0,c.Z)(t.split(":"),3),i=e[1],n=e[2];switch(i){case"open":var r=n.split(",");if("sketch.elf"===(0,Xi.nX)(r[0]))return(0,Xi.KC)("F 1");break;case"pread":var a=n.split(",").map((function(t){return parseInt(t,16)})),s=(0,c.Z)(a,3),o=s[0],u=s[1],l=s[2];if(1===o){var d,h=null===(d=this.buildResult)||void 0===d?void 0:d.elf;if(!h)return(0,Xi.KC)("F 0;");var v=h.substr(l,u);return(0,Xi.KC)("F ".concat(v.length.toString(16),";").concat(v))}return(0,Xi.KC)("F -1");case"close":return"1"===n?(0,Xi.KC)("F 0"):(0,Xi.KC)("F -1")}return(0,Xi.KC)("")}},{key:"tempRunner",get:function(){return this.mcu}},{key:"serialRx",get:function(){return this.bufferedSerialRx}},{key:"wifi",get:function(){return this.wifiManager}}]),t}();(0,h.gn)([p.LO],Us.prototype,"mcu",void 0),(0,h.gn)([p.LO],Us.prototype,"building",void 0),(0,h.gn)([p.LO],Us.prototype,"paused",void 0),(0,h.gn)([p.LO],Us.prototype,"restarting",void 0),(0,h.gn)([p.LO],Us.prototype,"breakpoint",void 0),(0,h.gn)([p.LO],Us.prototype,"debugging",void 0),(0,h.gn)([p.LO],Us.prototype,"buildResult",void 0),(0,h.gn)([p.LO],Us.prototype,"showPioDebugger",void 0),(0,h.gn)([p.LO],Us.prototype,"showSDCardDownload",void 0),(0,h.gn)([p.LO],Us.prototype,"sdCardDownloadSkipped",void 0),(0,h.gn)([p.LO],Us.prototype,"lastUpdate",void 0),(0,h.gn)([p.LO],Us.prototype,"partValues",void 0),(0,h.gn)([p.Fl],Us.prototype,"running",null),(0,h.gn)([p.Fl],Us.prototype,"status",null),(0,h.gn)([p.aD],Us.prototype,"start",null),(0,h.gn)([p.aD],Us.prototype,"startRuntime",null),(0,h.gn)([p.aD],Us.prototype,"loadHex",null),(0,h.gn)([p.aD],Us.prototype,"update",null),(0,h.gn)([p.aD],Us.prototype,"togglePIODebugger",null)},21831:function(t,e,i){i.d(e,{V:function(){return u},m:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(68949);function o(t){switch(t){case"never":case"always":case"auto":case"plotter":case"terminal":return t;default:return"auto"}}var u=function(){function t(){(0,n.Z)(this,t),(0,a.Z)(this,"show",!1),(0,a.Z)(this,"terminalMode",!1),(0,a.Z)(this,"showPlotter",!1),(0,a.Z)(this,"textBuffer",""),(0,a.Z)(this,"lines",[]),(0,a.Z)(this,"bytesBuffer",[]),(0,a.Z)(this,"serialUTF8Sequence",[]),(0,a.Z)(this,"listener",void 0),(0,s.ky)(this,{serialUTF8Sequence:!1})}return(0,r.Z)(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";this.show="always"===t||"plotter"===t,this.showPlotter="plotter"===t,this.terminalMode="terminal"===t,this.clearSerial()}},{key:"hideSerial",value:function(){this.show=!1}},{key:"clearSerial",value:function(){this.lines=[],this.textBuffer="",this.serialUTF8Sequence=[],this.bytesBuffer=[]}},{key:"appendSerial",value:function(t){var e;if(this.show=!0,this.terminalMode)return this.bytesBuffer.push(t),void(null===(e=this.listener)||void 0===e||e.call(this));if(t>127&&this.serialUTF8Sequence.push(t),this.serialUTF8Sequence.length>1){var i=new TextDecoder("utf-8",{fatal:!0});try{var n=i.decode(new Uint8Array(this.serialUTF8Sequence));return this.textBuffer=this.textBuffer.slice(0,-(this.serialUTF8Sequence.length-1))+n,void(this.serialUTF8Sequence=[])}catch(a){}}if(this.textBuffer+=String.fromCharCode(t),this.textBuffer.endsWith("\n")){var r=this.textBuffer.substr(0,this.textBuffer.length-1);console.log("[Serial] %c%s","color: blue",r),this.lines.push(r),this.textBuffer=""}}},{key:"togglePlotter",value:function(){this.showPlotter=!this.showPlotter}}]),t}()},17920:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{P:function(){return cacheKey},a:function(){return hashCacheKey}});var _swc_helpers_src_async_to_generator_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(47568),_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(29815),_vercel_path0_node_modules_next_dist_compiled_regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34051),_vercel_path0_node_modules_next_dist_compiled_regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_vercel_path0_node_modules_next_dist_compiled_regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0__),sortByName=function(t,e){return t.name<e.name?-1:t.name>e.name?1:0};function cacheKey(t){var e=t.builder,i=t.board,n=t.sketch,r=t.files,a=t.options,s=(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)(r).sort(sortByName);return JSON.stringify([["version",1],["builder",e],["board",i],["file","sketch.ino",n.trim()]].concat((0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((null===a||void 0===a?void 0:a.elf)?["option","elf"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((null===a||void 0===a?void 0:a.listing)?["option","listing"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((null===a||void 0===a?void 0:a.debug)?["option","debug"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((null===a||void 0===a?void 0:a.symbols)?["option","symbols"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((null===a||void 0===a?void 0:a.ramSize)?["option","ramSize",a.ramSize]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((null===a||void 0===a?void 0:a.cpuFreq)?["option","cpuFreq",a.cpuFreq]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)(s.map((function(t){return["file",t.name,t.content.trim()]})))))}function hashCacheKey(t){return _hashCacheKey.apply(this,arguments)}function _hashCacheKey(){return _hashCacheKey=(0,_swc_helpers_src_async_to_generator_mjs__WEBPACK_IMPORTED_MODULE_2__.Z)(_vercel_path0_node_modules_next_dist_compiled_regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(key){var encoder,hashBuffer,hashArray;return _vercel_path0_node_modules_next_dist_compiled_regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_ctx){for(;;)switch(_ctx.prev=_ctx.next){case 0:if("undefined"===typeof crypto){_ctx.next=16;break}return _ctx.prev=1,encoder=new TextEncoder,_ctx.next=5,crypto.subtle.digest("sha-256",encoder.encode(key));case 5:return hashBuffer=_ctx.sent,hashArray=Array.from(new Uint8Array(hashBuffer)),_ctx.abrupt("return",hashArray.map((function(t){return t.toString(16).padStart(2,"0")})).join(""));case 10:return _ctx.prev=10,_ctx.t0=_ctx.catch(1),console.warn("Hash generation failed",_ctx.t0),_ctx.abrupt("return",null);case 14:_ctx.next=17;break;case 16:return _ctx.abrupt("return",eval("require")("crypto").createHash("sha256").update(key).digest("hex"));case 17:case"end":return _ctx.stop()}}),_callee,null,[[1,10]])}))),_hashCacheKey.apply(this,arguments)}},74372:function(t,e,i){i.d(e,{I:function(){return C},b:function(){return _}});var n=i(47568),r=i(26042),a=i(69396),s=i(29815),o=i(34051),u=i.n(o),l=i(51438),c=i(52951),d=i(14924),h="/_cache/hexi/",v=function(){function t(){(0,l.Z)(this,t),(0,d.Z)(this,"cache",void 0),this.cache=caches.open("hexi-cache")}return(0,c.Z)(t,[{key:"put",value:function(t,e){var i=this;return(0,n.Z)(u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,i.cache;case 3:return r=n.sent,86400,n.next=7,r.put(h+t,new Response(JSON.stringify(e),{headers:{"content-type":"application/json","cache-control":"public, max-age=".concat(2592e3)}}));case 7:n.next=13;break;case 9:return n.prev=9,n.t0=n.catch(0),console.warn(n.t0),n.abrupt("return");case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()}},{key:"get",value:function(t){var e=this;return(0,n.Z)(u().mark((function i(){var n,r;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,e.cache;case 3:return n=i.sent,i.next=6,n.match(h+t);case 6:if(!(r=i.sent)){i.next=11;break}return i.next=10,r.json();case 10:return i.abrupt("return",i.sent);case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(0),console.warn(i.t0);case 16:return i.abrupt("return",null);case 17:case"end":return i.stop()}}),i,null,[[0,13]])})))()}},{key:"clear",value:function(){return(0,n.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return t.stop()}}),t)})))()}}]),t}(),f=i(17920),p=i(28715),g=i(23115),m=i(84104);function y(t,e){return w.apply(this,arguments)}function w(){return w=(0,n.Z)(u().mark((function t(e,i){var r,a,o,l,c,d,h,v,f,y;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i){t.next=2;break}return t.abrupt("return",[]);case 2:r=[],a=!0,o=!1,l=void 0,t.prev=4,c=(0,g.h)(null!==e&&void 0!==e?e:"")[Symbol.iterator]();case 6:if(a=(d=c.next()).done){t.next=26;break}return h=d.value,f=h.replace(/\s/g,"_"),t.next=12,i.getDirectoryHandle(f).catch((function(){return null}));case 12:if(y=t.sent){t.next=15;break}return t.abrupt("continue",23);case 15:return t.t0=(v=r).push,t.t1=v,t.t2=s.Z,t.next=20,(0,p.Jj)(y,function(){var t=(0,n.Z)(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(["header","source","libraries","sketch"].includes((0,m.r5)(e.name))||"library.properties"===e.name){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,i.resolve(e);case 4:if((n=t.sent)&&"examples"!==n[1]){t.next=7;break}return t.abrupt("return");case 7:return t.t0="libraries/".concat(n.join("/")),t.next=10,e.getFile();case 10:return t.next=12,t.sent.text();case 12:return t.t1=t.sent,t.abrupt("return",{name:t.t0,content:t.t1});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 20:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4);case 23:a=!0,t.next=6;break;case 26:t.next=32;break;case 28:t.prev=28,t.t5=t.catch(4),o=!0,l=t.t5;case 32:t.prev=32,t.prev=33,a||null==c.return||c.return();case 35:if(t.prev=35,!o){t.next=38;break}throw l;case 38:return t.finish(35);case 39:return t.finish(32);case 40:return t.abrupt("return",r);case 41:case"end":return t.stop()}}),t,null,[[4,28,32,40],[33,,35,39]])}))),w.apply(this,arguments)}var k={name:"_wokwi_mbed_speedup_patch.cpp",content:'namespace{\nextern "C" void rtos_attach_idle_hook(void*ptr);\nstatic void idle() {asm("wfe");}\nclass M{public:M();};\nM::M(){rtos_attach_idle_hook((void*)idle);}\nstatic class M __attribute__((used)) c;\n}'},Z=function(){function t(){(0,l.Z)(this,t),(0,d.Z)(this,"cache",new Map)}return(0,c.Z)(t,[{key:"put",value:function(t,e){this.cache.set(t,e)}},{key:"get",value:function(t){var e;return null!==(e=this.cache.get(t))&&void 0!==e?e:null}},{key:"clear",value:function(){this.cache.clear()}}]),t}(),b=i(83454).env.HEXI_URL||"https://wokwi.com",C="undefined"!==typeof localStorage&&"1"===localStorage.getItem("__browserCache")?new v:new Z;function x(){return"undefined"!==typeof localStorage&&localStorage.getItem("__hexi")||b}function S(){var t;return null!==(t="undefined"!==typeof localStorage&&localStorage.getItem("__buildServer"))&&void 0!==t?t:void 0}function _(t,e){return P.apply(this,arguments)}function P(){return(P=(0,n.Z)(u().mark((function t(e,i){var n,o,l,c,d,h,v,p,g,w,Z,b,_,P,D,I;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.find((function(t){return"sketch"===(0,m.r5)(t.name)})),o=e.find((function(t){return"libraries"===(0,m.r5)(t.name)})),l=["header","source","libraries","sketch","rust-manifest"],t.t0=(0,s.Z)(e.filter((function(t){return l.includes((0,m.r5)(t.name))&&t!==n}))),t.t1=s.Z,t.next=8,y(null!==(c=null===o||void 0===o?void 0:o.content)&&void 0!==c?c:"",i.localLibraryDirectory);case 8:return t.t2=t.sent,t.t3=(0,t.t1)(t.t2),d=t.t0.concat.call(t.t0,t.t3),h=(null===n||void 0===n?void 0:n.content)||"",v=i.builder,"pipico"!==(g=null!==(p=i.board)&&void 0!==p?p:"uno")||v||d.push(k),w=i.cache||C,t.next=19,(0,f.a)((0,f.P)({builder:null!==v&&void 0!==v?v:"",board:g,sketch:h,files:d,options:i.options}));case 19:if(Z=t.sent,t.t4=Z,!t.t4){t.next=25;break}return t.next=24,w.get(Z);case 24:t.t4=t.sent;case 25:if(!(b=t.t4)){t.next=28;break}return t.abrupt("return",Promise.resolve(b));case 28:return P={sketch:h,files:d,board:g,options:i.options,builder:v,infra:S(),w:{b:i.buildType,p:null!==(_=i.projectId)&&void 0!==_?_:"undefined"!==typeof location?location.pathname:void 0,u:i.userId}},t.next=32,fetch(x()+"/build",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(P),signal:i.abortSignal});case 32:if(502!==(D=t.sent).status){t.next=35;break}throw new Error("Project compilation takes too long. Please remove some libraries and try again, or contact support@wokwi.com for a dedicated private build server.");case 35:return t.t5=a.Z,t.t6=r.Z,t.t7={},t.next=40,D.json();case 40:if(t.t8=t.sent,t.t9=(0,t.t6)(t.t7,t.t8),t.t10={cacheKey:Z},I=(0,t.t5)(t.t9,t.t10),!Z){t.next=47;break}return t.next=47,w.put(Z,I);case 47:return t.abrupt("return",I);case 48:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},23115:function(t,e,i){i.d(e,{h:function(){return s},i:function(){return o}});var n=i(34051),r=i.n(n),a=r().mark(s);function s(t){var e,i,n,s,o,u,l;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=!0,i=!1,n=void 0,r.prev=1,s=t.split("\n")[Symbol.iterator]();case 3:if(e=(o=s.next()).done){r.next=12;break}if(u=o.value,!(l=u.trim()).length||"#"===l[0]){r.next=9;break}return r.next=9,l;case 9:e=!0,r.next=3;break;case 12:r.next=18;break;case 14:r.prev=14,r.t0=r.catch(1),i=!0,n=r.t0;case 18:r.prev=18,r.prev=19,e||null==s.return||s.return();case 21:if(r.prev=21,!i){r.next=24;break}throw n;case 24:return r.finish(21);case 25:return r.finish(18);case 26:case"end":return r.stop()}}),a,null,[[1,14,18,26],[19,,21,25]])}var o={"Adafruit_NeoPixel.h":"Adafruit NeoPixel","Adafruit_GFX.h":"Adafruit GFX Library","DHT.h":"DHT sensor library","DHT_U.h":"DHT sensor library","FastLED.h":"FastLED","Key.h":"Keypad","Keypad.h":"Keypad","LiquidCrystal.h":"LiquidCrystal","LiquidCrystal_I2C.h":"LiquidCrystal I2C","MD_Parola.h":"MD_Parola","RTClib.h":"RTClib","SD.h":"SD","Servo.h":"Servo","SevSeg.h":"SevSeg","U8glib.h":"U8glib"}},32122:function(t,e,i){i.d(e,{h:function(){return n}});var n=[{name:"arcostasi",id:"286157501413458444",photo:"https://avatars0.githubusercontent.com/u/5041497?s=100&v=4",club:!0},{name:"ldirko",id:"280799682860417548",photo:"https://lh3.googleusercontent.com/a-/AOh14GjfzzDdqzNihMeBOMpB3273qBGGeJXd6F7Dqd_U2A=s96-c"},{name:"stepko",id:"287675906461270536",photo:"https://lh3.googleusercontent.com/a-/AOh14GihMvxeQ5X_BQhx4oRFuhENHC42yGtTr8CcxNnzTQ=s96-c"},{name:"sutaburosu",id:"283354107627962893",photo:"https://avatars2.githubusercontent.com/u/20606?s=100&v=4",club:!0},{name:"costyn",id:"283264567044211208",photo:"https://avatars3.githubusercontent.com/u/2042280?s=100&v=4",club:!0},{name:"urish",id:i(73169).y?"276825819207172616":"276718902165111297",photo:"https://lh3.googleusercontent.com/a-/AAuE7mDG2n38vWO1JDd_nhm_bxqgizf3YqE5mhelLeQg"},{name:"edoctoor",id:"317850651786740289",photo:"https://ui-avatars.com/api/?name=E+d&background=0D8ABC&color=fff"},{name:"omkar",id:"323004943736767059",photo:"https://lh3.googleusercontent.com/a/AATXAJw6VwK6jHyz6Wj9IMRnxEAg-hTwzYJUNOb-_v2B=s96-c"},{name:"jimlee",id:"302859022757790217",photo:"https://ui-avatars.com/api/?name=J+L&background=0D8ABC&color=fff"},{name:"sergiogasquez",id:"328902925809091154",photo:"https://avatars.githubusercontent.com/u/12926049?v=4"},{name:"hugs",id:"348154082945401427",photo:"https://pbs.twimg.com/profile_images/1274387957332488194/mwMiiHeI_400x400.jpg"},{name:"shaos",id:"348540509243834962",photo:"https://ui-avatars.com/api/?name=S&background=0D8ABC&color=fff"}]},64295:function(t,e,i){i.d(e,{A_:function(){return s},PC:function(){return n},Q5:function(){return a},Vk:function(){return o},hH:function(){return u},ss:function(){return r}});var n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:"analog",channel:t}},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"i2c",signal:t,bus:e}},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"spi",signal:t,bus:e}},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"usart",signal:t,bus:e}},o={type:"power",signal:"GND"},u=function(t){return{type:"power",signal:"VCC",voltage:t}}},96387:function(t,e,i){i.d(e,{Q:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(29815),o=function(){function t(){(0,n.Z)(this,t),(0,a.Z)(this,"fifo",[]),(0,a.Z)(this,"fifoIndex",0)}return(0,r.Z)(t,[{key:"peek",value:function(){return this.fifoIndex<this.fifo.length?this.fifo[this.fifoIndex]:null}},{key:"available",get:function(){return this.fifo.length-this.fifoIndex}},{key:"next",value:function(){if(this.fifoIndex<this.fifo.length){var t=this.fifo[this.fifoIndex++];return this.fifoIndex>=256&&(this.fifo.splice(0,256),this.fifoIndex-=256),t}return null}},{key:"write",value:function(t){var e;(e=this.fifo).push.apply(e,(0,s.Z)(t))}},{key:"writeByte",value:function(t){this.fifo.push(t)}}]),t}()},57954:function(t,e,i){function n(t,e){if(null==t)return e;var i=parseFloat(t);return isNaN(i)?e:i}i.d(e,{R:function(){return n}})},11113:function(t,e,i){i.d(e,{Cb:function(){return u},al:function(){return d},bf:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(29815),o=64,u=32,l=["R1","G1","B1","R2","G2","B2"],c=["A","B","C","D","E"],d=function(){function t(e,i){var r=this;(0,n.Z)(this,t),(0,a.Z)(this,"pixels",new Uint32Array(u*o)),(0,a.Z)(this,"input",l.map((function(){return new Uint8Array(o/8)}))),(0,a.Z)(this,"buffer",l.map((function(){return new Uint8Array(o/8)}))),(0,a.Z)(this,"address",0),(0,a.Z)(this,"updated",!1),(0,a.Z)(this,"copy",(function(){r.updated=!0;for(var t=r.buffer,e=r.address*o,i=(u/2+r.address)*o,n=0;n<o;n++){var a=n>>3,s=7&n,l=t[0][a]&1<<s?255:0,c=t[1][a]&1<<s?255:0,d=t[2][a]&1<<s?255:0,h=t[3][a]&1<<s?255:0,v=t[4][a]&1<<s?255:0,f=t[5][a]&1<<s?255:0;r.pixels[e+o-1-n]=l<<16|c<<8|d,r.pixels[i+o-1-n]=h<<16|v<<8|f}}));var s=l.map((function(t){return i.get(t)})),d=c.map((function(t){return i.get(t)})),h=i.get("OE");d.forEach((function(t,e){var i=r,n=1<<e;r.address|=t.value?n:0,t.onValueChange((function(t){t?i.address|=n:i.address&=~n,h.value||i.copy()}))}));var v=function(t,e){for(var i=e?1:0,n=0;n<t.length;n++){var r=t[n]<<1|i;i=128&t[n]?1:0,t[n]=r}},f=this.input,p=this.buffer;i.get("CLK").onValueChange((function(t){t&&(v(f[0],s[0].value),v(f[1],s[1].value),v(f[2],s[2].value),v(f[3],s[3].value),v(f[4],s[4].value),v(f[5],s[5].value))})),i.get("OE").onValueChange((function(t){t||r.copy()})),i.get("LAT").onValueChange((function(t){t&&(p[0].set(f[0]),p[1].set(f[1]),p[2].set(f[2]),p[3].set(f[3]),p[4].set(f[4]),p[5].set(f[5]),h.value||r.copy())}))}return(0,r.Z)(t,[{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{pixels:this.pixels}}):null}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.input[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.fill(0)}}catch(c){e=!0,i=c}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}var a=!0,s=!1,o=void 0;try{for(var u,l=this.buffer[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.fill(0)}}catch(c){s=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}this.pixels.fill(0)}}]),t}();(0,a.Z)(d,"pinNames",(0,s.Z)(l).concat((0,s.Z)(c),["CLK","LAT","OE","GND"]))},29399:function(t,e,i){i.d(e,{j:function(){return l},s:function(){return n}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(37405);!function(t){t.load="load"}(n||(n={}));var u=Math.round(1e8),l=function(){function t(e,i,n,a){var l=this;(0,r.Z)(this,t),(0,s.Z)(this,"outValue",void 0),(0,s.Z)(this,"bitIndex",void 0),(0,s.Z)(this,"lastChange",void 0),(0,s.Z)(this,"channel",void 0),(0,s.Z)(this,"gain",void 0),(0,s.Z)(this,"nextSampleTime",void 0),(0,s.Z)(this,"sck",void 0),(0,s.Z)(this,"dt",void 0),(0,s.Z)(this,"acquireSample",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"vars",void 0),this.clock=e,this.vars=a,this.outValue=0,this.bitIndex=0,this.lastChange=0,this.channel=0,this.gain=128,this.nextSampleTime=0,this.acquireSample=function(){var t=l.clock;t.cpuNanos<=l.nextSampleTime?l.sck.value||(l.nextSampleTime+=u,t.addEvent(u,l.acquireSample),l.outValue=l.read(),l.bitIndex=0,l.dt.setState(o.J.Low)):l.clock.addEvent(l.clock.cpuNanos-u,l.acquireSample)},this.sck=i.get("SCK"),this.dt=i.get("DT"),this.sck.setState(o.J.PullUp),this.dt.setState(o.J.High),this.sck.onValueChange((function(t){var i=l.lastChange,n=l.bitIndex;if(t){if(n<24){var r=l.outValue&1<<23-n;l.dt.setState(r?o.J.High:o.J.Low)}else l.dt.setState(o.J.High),l.updateGain(),l.nextSampleTime=e.cpuNanos+u;l.bitIndex++}else e.cpuNanos-i>6e4&&(l.nextSampleTime=e.cpuNanos+u,e.addEvent(u,l.acquireSample));l.lastChange=e.cpuNanos}))}return(0,a.Z)(t,[{key:"updateGain",value:function(){switch(this.bitIndex){case 24:this.channel=0,this.gain=128;break;case 25:this.channel=1,this.gain=32;break;default:this.channel=0,this.gain=64}}},{key:"read",value:function(){return 1==this.channel?0:3.28125*this.vars.readFloat(n.load)*this.gain}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.lastChange=0,this.nextSampleTime=0}}]),t}();(0,s.Z)(l,"pinNames",["GND","DT","SCK","VCC"])},11551:function(t,e,i){i.d(e,{_:function(){return g},g:function(){return h}});var n=i(51438),r=i(95315),a=i(70222),s=i(88409),o=i(52951),u=i(14924),l=i(8371),c=i(42191),d=i(13918);var h,v=-32768,f=32767;!function(t){t.temperature="temperature",t.accelX="accelX",t.accelY="accelY",t.accelZ="accelZ",t.rotationX="rotationX",t.rotationY="rotationY",t.rotationZ="rotationZ"}(h||(h={}));var p=new WeakMap,g=function(){function t(e,i,o,l){var v=this;(0,n.Z)(this,t),(0,u.Z)(this,"registers",void 0),(0,u.Z)(this,"addr",void 0),(0,u.Z)(this,"updated",void 0),(0,u.Z)(this,"ledOn",void 0),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,u.Z)(this,"clock",void 0),(0,u.Z)(this,"vars",void 0),this.clock=e,this.vars=l,this.registers=new Uint8Array(118),this.addr=0,this.updated=!1,this.ledOn=!1,(0,s.Z)(this,p,!1);var f=i.get("AD0"),g=new d.A({scl:i.get("SCL"),sda:i.get("SDA")});(0,c.u)(g,104,[f]),function(t,e,i){var n=null,r=function(){var r=t.driven&&e.driven&&t.value&&!e.value;n!==r&&i(n=r)};r(),t.onValueChange(r),e.onValueChange(r)}(i.get("VCC"),i.get("GND"),(function(t){v.ledOn=t,v.updated=!0})),this.reset();var m=function(){v.setAcceleration(l.readFloat(h.accelX),l.readFloat(h.accelY),l.readFloat(h.accelZ))},y=function(){v.setRotation(l.readFloat(h.rotationX),l.readFloat(h.rotationY),l.readFloat(h.rotationZ))};l.autorun(m),l.autorun(y),l.autorun((function(){v.setTemperature(l.readFloat(h.temperature))})),g.onConnect=function(){return(0,s.Z)(v,p,!0),!0},g.onReadByte=function(){var t=v.registers[v.addr];return v.addr=(v.addr+1)%118,t},g.onWriteByte=function(t){if((0,r.Z)(v,p))return v.addr=t,(0,s.Z)(v,p,!1),!0;var e=!0,i=!1,n=v.addr;switch(n){case 107:v.registers[107]=127&t;break;case 55:case 56:i=!0;break;default:n>=13&&n<=52||n>=99&&n<=116?(i=!0,e=!0):e=!1}return i&&(v.registers[n]=t),28===n?m():27===n&&y(),v.addr=(v.addr+1)%118,e}}return(0,o.Z)(t,[{key:"setTemperature",value:function(t){var e=Math.round(340*(t-36.53));this.registers[65]=e>>8&255,this.registers[66]=255&e}},{key:"setAcceleration",value:function(t,e,i){var n=[16384,8192,4096,2048][this.registers[28]>>3&3],r=0|(0,l.u)(n*t,v,f),a=0|(0,l.u)(n*e,v,f),s=0|(0,l.u)(n*i,v,f);this.registers[59]=r>>8&255,this.registers[60]=255&r,this.registers[61]=a>>8&255,this.registers[62]=255&a,this.registers[63]=s>>8&255,this.registers[64]=255&s}},{key:"setRotation",value:function(t,e,i){var n=[131,65.5,32.8,16.4][this.registers[27]>>3&3],r=0|(0,l.u)(n*t,v,f),a=0|(0,l.u)(n*e,v,f),s=0|(0,l.u)(n*i,v,f);this.registers[67]=r>>8&255,this.registers[68]=255&r,this.registers[69]=a>>8&255,this.registers[70]=255&a,this.registers[71]=s>>8&255,this.registers[72]=255&s}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{ledOn:this.ledOn}}):null}},{key:"reset",value:function(){var t=this.vars;this.registers.fill(0),this.registers[107]=64,this.registers[117]=104,this.addr=0,t.initFloat(h.accelX,0),t.initFloat(h.accelY,0),t.initFloat(h.accelZ,1),t.initFloat(h.rotationX,0),t.initFloat(h.rotationY,0),t.initFloat(h.rotationZ,0),t.initFloat(h.temperature,24)}}]),t}();(0,u.Z)(g,"pinNames",["VCC","GND","SCL","SDA","AD0","INT"])},41812:function(t,e,i){i.d(e,{W:function(){return u},l:function(){return l}});var n=i(51438),r=i(52951),a=i(14924),s=i(37405),o=i(57954),u=500,l=function(){function t(e,i,r){(0,n.Z)(this,t),(0,a.Z)(this,"lux",void 0),(0,a.Z)(this,"gamma",void 0),(0,a.Z)(this,"c",void 0),(0,a.Z)(this,"threshold",void 0),(0,a.Z)(this,"ledOut",!1),(0,a.Z)(this,"updated",!0),(0,a.Z)(this,"analogOut",void 0),(0,a.Z)(this,"digitalOut",void 0),this.digitalOut=i.get("DO"),this.analogOut=i.get("AO"),this.lux=(0,o.R)(r.get("lux"),u),this.gamma=(0,o.R)(r.get("gamma"),.7),this.threshold=(0,o.R)(r.get("threshold"),2.5);var s=(0,o.R)(r.get("rl10"),50);this.c=Math.log10(1e3*s)+this.gamma,this.luxUpdated()}return(0,r.Z)(t,[{key:"onEvent",value:function(t){this.lux=t.lux,this.luxUpdated()}},{key:"luxUpdated",value:function(){var t=this,e=t.gamma,i=t.c,n=t.lux,r=Math.pow(10,i)/Math.pow(Math.max(n,.001),e),a=r/(1e4+r)*5;this.analogOut.node.analogPort.write(a);var o=a>this.threshold;this.digitalOut.setState(o?s.J.High:s.J.Low),this.ledOut!==!o&&(this.ledOut=!o,this.updated=!0)}},{key:"update",value:function(){return this.updated?{value:{ledOn:!0,ledDigitalOut:this.ledOut}}:null}},{key:"reset",value:function(){}}]),t}();(0,a.Z)(l,"pinNames",["VCC","GND","DO","AO"])},67044:function(t,e,i){i.d(e,{V:function(){return s},z:function(){return u}});var n=i(47568),r=i(34051),a=i.n(r);function s(t){return o.apply(this,arguments)}function o(){return(o=(0,n.Z)(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="fat"===t.t0?3:"lfs"===t.t0?6:9;break;case 3:return t.next=5,Promise.all([i.e(4102),i.e(9829)]).then(i.bind(i,59829));case 5:case 8:return t.abrupt("break",9);case 6:return t.next=8,Promise.all([i.e(6137),i.e(4669)]).then(i.bind(i,54669));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(t,e,i){return l.apply(this,arguments)}function l(){return(l=(0,n.Z)(a().mark((function t(e,n,r){var s,o,u,l,c,d,h,v,f,p,g,m,y,w;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=n.type,o=n.flashOffset,u=n.blockSize,l=n.numBlocks,c=n.mkdirs,t.t0=s,t.next="fat"===t.t0?4:"lfs"===t.t0?10:16;break;case 4:return t.next=6,Promise.all([i.e(4102),i.e(9829)]).then(i.bind(i,59829));case 6:return d=t.sent.makeFatFS,t.next=9,d({flash:e.subarray(o),blockSize:u,numBlocks:l,noPartitionTable:!0,mkdirs:c},r);case 9:return t.abrupt("break",16);case 10:return t.next=12,Promise.all([i.e(6137),i.e(4669)]).then(i.bind(i,54669));case 12:return h=t.sent.makeLittlefs,t.next=15,h({flash:e.subarray(o),blockSize:u,numBlocks:l,mkdirs:c},r);case 15:return t.abrupt("break",16);case 16:for(f=!0,p=!1,g=void 0,t.prev=18,m=(null!==(v=n.overlays)&&void 0!==v?v:[])[Symbol.iterator]();!(f=(y=m.next()).done);f=!0)w=y.value,e.set(w.data,w.offset);t.next=26;break;case 22:t.prev=22,t.t1=t.catch(18),p=!0,g=t.t1;case 26:t.prev=26,t.prev=27,f||null==m.return||m.return();case 29:if(t.prev=29,!p){t.next=32;break}throw g;case 32:return t.finish(29);case 33:return t.finish(26);case 34:case"end":return t.stop()}}),t,null,[[18,22,26,34],[27,,29,33]])})))).apply(this,arguments)}},26017:function(t,e,i){i.d(e,{$_:function(){return r},H_:function(){return s},KC:function(){return u},NC:function(){return o},Nc:function(){return l},ZY:function(){return n},nX:function(){return c}});var n=u("S02"),r=u("S05");function a(t){return(t>>4).toString(16)+(15&t).toString(16)}function s(t){for(var e=new Uint8Array(t.length/2),i=0;i<e.length;i++)e[i]=parseInt(t.substr(2*i,2),16);return e}function o(t){return Array.from(t).map(a).join("")}function u(t){return"+$".concat(t,"#").concat(a(255&t.split("").map((function(t){return t.charCodeAt(0)})).reduce((function(t,e){return t+e}),0)))}function l(t){return o((new TextEncoder).encode(t))}function c(t){return(new TextDecoder).decode(s(t))}},14116:function(t,e,i){var n;i.d(e,{q:function(){return n}}),function(t){t[t.BRG=0]="BRG",t[t.RGBA=1]="RGBA"}(n||(n={}))},53124:function(t,e,i){i.d(e,{i:function(){return o},x:function(){return u}});var n=i(10253),r=i(34051),a=i.n(r),s=a().mark(u);function o(t,e){var i=!0,r=!1,a=void 0;try{for(var s,o=u(t)[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var l=(0,n.Z)(s.value,2),c=l[0],d=l[1];e[c]=d}}catch(h){r=!0,a=h}finally{try{i||null==o.return||o.return()}finally{if(r)throw a}}}function u(t){var e,i,n,r,o,u,l,c,d,h,v;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e=0,i=!0,n=!1,r=void 0,a.prev=2,o=t.split("\n")[Symbol.iterator]();case 4:if(i=(u=o.next()).done){a.next=22;break}if(l=u.value,c=l.substr(7,2),":"!==l[0]||"00"!==c){a.next=17;break}d=parseInt(l.substr(1,2),16),h=parseInt(l.substr(3,4),16),v=0;case 11:if(!(v<d)){a.next=17;break}return a.next=14,[e+h+v,parseInt(l.substr(9+2*v,2),16)];case 14:v++,a.next=11;break;case 17:":"===l[0]&&"02"===c&&(e=parseInt(l.substr(9,4),16)<<4),":"===l[0]&&"04"===c&&(e=parseInt(l.substr(9,4),16)<<16);case 19:i=!0,a.next=4;break;case 22:a.next=28;break;case 24:a.prev=24,a.t0=a.catch(2),n=!0,r=a.t0;case 28:a.prev=28,a.prev=29,i||null==o.return||o.return();case 31:if(a.prev=31,!n){a.next=34;break}throw r;case 34:return a.finish(31);case 35:return a.finish(28);case 36:case"end":return a.stop()}}),s,null,[[2,24,28,36],[29,,31,35]])}},49006:function(t,e,i){i.d(e,{E:function(){return s}});var n=i(51438),r=i(52951),a=i(14924),s=function(){function t(e,i){(0,n.Z)(this,t),(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"state",void 0),this.name=e,this.state=i}return(0,r.Z)(t,[{key:"attach",value:function(t){t.state=this.state}}]),t}()},99569:function(t,e,i){i.d(e,{Y:function(){return d}});var n=i(51438),r=i(52951),a=i(14924),s=i(29815),o=Symbol.iterator,u=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"set",void 0),(0,a.Z)(this,"unionSet",null),this.set=new Set(e)}return(0,r.Z)(t,[{key:o,value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set)[Symbol.iterator]()}},{key:"unionWith",value:function(t){if(this.unionSet=t,t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.set[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;t.add(s)}}catch(o){i=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}},{key:"size",get:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).size}},{key:"add",value:function(t){var e;this.set.add(t),null===(e=this.unionSet)||void 0===e||e.add(t)}},{key:"delete",value:function(t){var e;this.set.delete(t),null===(e=this.unionSet)||void 0===e||e.delete(t)}},{key:"has",value:function(t){var e;return(null!==(e=this.unionSet)&&void 0!==e?e:this.set).has(t)}},{key:"forEach",value:function(t){var e;(null!==(e=this.unionSet)&&void 0!==e?e:this.set).forEach(t)}},{key:"entries",value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).entries()}},{key:"keys",value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).keys()}},{key:"values",value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).values()}},{key:"ownPins",get:function(){return this.set}}]),t}(),l=i(37405),c=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"high",void 0),(0,a.Z)(this,"voltage",void 0),(0,a.Z)(this,"hasVoltage",void 0),(0,a.Z)(this,"listeners",void 0),(0,a.Z)(this,"node",void 0),this.node=e,this.high=5,this.voltage=Math.random()*this.high,this.hasVoltage=!1,this.listeners=new Set}return(0,r.Z)(t,[{key:"read",value:function(){if(this.hasVoltage)return this.voltage;switch(this.node.state){case l.J.High:case l.J.PullUp:return this.voltage=5,this.high;case l.J.PullDown:case l.J.Low:return this.voltage=0,0;default:return this.voltage=.9*this.voltage+Math.random()*this.high*.1,this.voltage}}},{key:"readNormalized",value:function(){return this.read()/this.high}},{key:"write",value:function(t){if(!this.hasVoltage||t!==this.voltage){this.voltage=t,this.hasVoltage=!0;var e=t/this.high,i=!0,n=!1,r=void 0;try{for(var a,s=this.listeners[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){(0,a.value)(t,e)}}catch(o){n=!0,r=o}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}},{key:"writeNormalized",value:function(t){this.write(t*this.high)}},{key:"addListener",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}}]),t}(),d=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"analogPort",void 0),(0,a.Z)(this,"listeners",void 0),(0,a.Z)(this,"stateListeners",void 0),(0,a.Z)(this,"pinSet",void 0),(0,a.Z)(this,"bridges",void 0),(0,a.Z)(this,"bridgedNodes",void 0),(0,a.Z)(this,"digitalValue",void 0),(0,a.Z)(this,"currentState",void 0),(0,a.Z)(this,"valueChangedNanos",void 0),(0,a.Z)(this,"_drivingPin",void 0),(0,a.Z)(this,"clock",void 0),this.clock=e,this.analogPort=new c(this),this.listeners=new Set,this.stateListeners=new Set,this.pinSet=new u,this.bridges=new Set,this.bridgedNodes=new Set([this]),this.digitalValue=!1,this.currentState=l.J.HighZ,this.valueChangedNanos=this.clock.cpuNanos,this._drivingPin=null}return(0,r.Z)(t,[{key:"value",get:function(){return this.digitalValue}},{key:"state",get:function(){return this.currentState}},{key:"pins",get:function(){return this.pinSet}},{key:"attachPin",value:function(t){this.pinSet.add(t)}},{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"subscribeState",value:function(t){var e=this;return this.stateListeners.add(t),function(){return e.stateListeners.delete(t)}}},{key:"resolve",value:function(){var t,e,i=null,n=null,r=null,a=null,s=!0,o=!1,u=void 0;try{for(var c,d=this.pins[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;switch(h.internalState){case l.J.Low:n=h;break;case l.J.High:i=h;break;case l.J.PullUp:r=h;break;case l.J.PullDown:a=h}}}catch(N){o=!0,u=N}finally{try{s||null==d.return||d.return()}finally{if(o)throw u}}n&&i&&console.warn('Short circuit! pins: "'.concat(n.name,'" and "').concat(i.name,'"'));var v=null;i?(t=!0,e=l.J.High,v=i):n?(t=!1,e=l.J.Low,v=n):r?(t=!0,e=l.J.PullUp,v=r):a?(t=!1,e=l.J.PullDown,v=a):(t=Math.random()>.5,e=l.J.HighZ,v=null);var f=!0,p=!1,g=void 0;try{for(var m,y=this.bridgedNodes[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var w=m.value,k=w.digitalValue,Z=w.currentState;if(w.digitalValue=t,w.currentState=e,w._drivingPin=v,Z!==e){var b=!0,C=!1,x=void 0;try{for(var S,_=w.stateListeners[Symbol.iterator]();!(b=(S=_.next()).done);b=!0){(0,S.value)()}}catch(N){C=!0,x=N}finally{try{b||null==_.return||_.return()}finally{if(C)throw x}}}if(k!==w.digitalValue){var P=w.digitalValue,D=w.clock.cpuNanos,I=D-w.valueChangedNanos;w.valueChangedNanos=D;var A=!0,R=!1,B=void 0;try{for(var E,U=w.listeners[Symbol.iterator]();!(A=(E=U.next()).done);A=!0){(0,E.value)(P,{nanos:I})}}catch(N){R=!0,B=N}finally{try{A||null==U.return||U.return()}finally{if(R)throw B}}}}}catch(N){p=!0,g=N}finally{try{f||null==y.return||y.return()}finally{if(p)throw g}}}},{key:"drivingPin",get:function(){return this._drivingPin}},{key:"updateBridges",value:function(){for(var t=new Set([this]),e=new Set,i=Array.from(this.bridges);i.length;){var n,r=i.pop();if(r&&!e.has(r))e.add(r),t.add(r.node),(n=i).push.apply(n,(0,s.Z)(r.node.bridges))}if(t.size<2)this.pinSet.unionWith(null),this.bridgedNodes=new Set([this]);else{var a=new Set(this.pinSet.ownPins),o=!0,u=!1,l=void 0;try{for(var c,d=t[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;h.pinSet.unionWith(a),h.bridgedNodes=t}}catch(v){u=!0,l=v}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}}this.resolve()}}]),t}()},37405:function(t,e,i){i.d(e,{J:function(){return n},U:function(){return o}});var n,r=i(51438),a=i(52951),s=i(14924);!function(t){t[t.Low=0]="Low",t[t.High=1]="High",t[t.HighZ=2]="HighZ",t[t.PullUp=3]="PullUp",t[t.PullDown=4]="PullDown"}(n||(n={}));var o=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"currentState",void 0),(0,s.Z)(this,"protocols",void 0),(0,s.Z)(this,"node",void 0),(0,s.Z)(this,"name",void 0),this.node=e,this.name=i,this.currentState=n.HighZ,this.protocols={},e.attachPin(this)}return(0,a.Z)(t,[{key:"value",get:function(){return this.node.value}},{key:"driven",get:function(){return this.node.state!==n.HighZ}},{key:"onStateChange",value:function(t){return this.node.subscribeState(t)}},{key:"onValueChange",value:function(t){return this.node.subscribe(t)}},{key:"state",get:function(){return this.node.state},set:function(t){t!==this.currentState&&(this.currentState=t,this.node.resolve())}},{key:"internalState",get:function(){return this.currentState}},{key:"setState",value:function(t){this.state=t}}]),t}()},42191:function(t,e,i){function n(t,e,i){var n=function(){var t=e,n=0,r=!0,a=!1,s=void 0;try{for(var o,u=i[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){t|=o.value.value?1<<n:0,n++}}catch(l){a=!0,s=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}return t};t.addressFilter=n();var r=!0,a=!1,s=void 0;try{for(var o,u=i[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){o.value.onValueChange((function(){t.addressFilter=n()}))}}catch(l){a=!0,s=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}i.d(e,{u:function(){return n}})},3776:function(t,e,i){i.d(e,{n:function(){return c}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(29815),u=i(37405);function l(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=function(t){var i=e.shift();i&&i(n,t)};n(void 0)}!function(t){t[t.Idle=0]="Idle",t[t.Start=1]="Start",t[t.Write=2]="Write",t[t.Read=3]="Read"}(n||(n={}));var c=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"frequency",void 0),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"busy",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"pins",void 0),this.clock=e,this.pins=i,this.frequency=1e5,this.state=n.Idle,this.busy=!1}return(0,a.Z)(t,[{key:"enable",value:function(){var t=this.pins,e=t.scl,i=t.sda;e.setState(u.J.PullUp),i.setState(u.J.PullUp)}},{key:"disable",value:function(){var t=this.pins,e=t.scl,i=t.sda;e.setState(u.J.HighZ),i.setState(u.J.HighZ)}},{key:"tick",value:function(t){var e=Math.floor(1e9/this.frequency/2);this.clock.addEvent(e,t)}},{key:"clockHigh",value:function(t){var e=this.pins.scl;if(e.value)t();else var i=e.onValueChange((function(){i(),t()}))}},{key:"start",value:function(t){var e=this,i=this.pins,r=i.sda,a=i.scl,s=[];if(this.state!==n.Idle){var c=this;s.push((function(t){r.setState(u.J.PullUp),c.tick(t)}),(function(t){a.setState(u.J.PullUp),c.clockHigh(t)}),(function(t){c.tick(t)}))}l.apply(void 0,(0,o.Z)(s).concat([function(i){if(!r.value)return e.state=n.Idle,void t(!1);e.state=n.Start,r.setState(u.J.Low),e.tick(i)},function(){a.setState(u.J.Low),t(!0)}]))}},{key:"stop",value:function(t){var e=this,i=this.pins,r=i.sda,a=i.scl;l((function(t){r.setState(u.J.Low),e.tick(t)}),(function(t){a.setState(u.J.PullUp),e.clockHigh(t)}),(function(t){e.tick(t)}),(function(t){r.setState(u.J.PullUp),e.tick(t)}),(function(){e.state=n.Idle,r.value?t(!0):t(!1)}))}},{key:"connect",value:function(t,e,i){var r=this,a=t<<1|(e?0:1);this.write(a,(function(t){r.state=t?e?n.Write:n.Read:n.Idle,i(t)}))}},{key:"read",value:function(t,e){var i=this,n=0;l((function(t){return i.readBit(t)}),(function(t,e){n|=e?128:0,i.readBit(t)}),(function(t,e){n|=e?64:0,i.readBit(t)}),(function(t,e){n|=e?32:0,i.readBit(t)}),(function(t,e){n|=e?16:0,i.readBit(t)}),(function(t,e){n|=e?8:0,i.readBit(t)}),(function(t,e){n|=e?4:0,i.readBit(t)}),(function(t,e){n|=e?2:0,i.readBit(t)}),(function(e,r){n|=r?1:0,i.writeBit(!t,e)}),(function(){return e(n)}))}},{key:"write",value:function(t,e){var i=this;l((function(e){return i.writeBit(!!(128&t),e)}),(function(n,r){return r?i.writeBit(!!(64&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(32&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(16&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(8&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(4&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(2&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(1&t),n):e(!1)}),(function(t,n){n?i.readBit((function(t){return e(!t)})):e(!1)}))}},{key:"writeBit",value:function(t,e){var i=this,r=this.pins,a=r.scl,s=r.sda;l((function(e){s.setState(t?u.J.PullUp:u.J.Low),i.tick(e)}),(function(t){a.setState(u.J.PullUp),i.tick(t)}),(function(t){i.clockHigh(t)}),(function(){var r=s.value;a.setState(u.J.Low),r!==t?(i.state=n.Idle,e(!1)):e(!0)}))}},{key:"readBit",value:function(t){var e=this,i=this.pins,n=i.scl,r=i.sda;l((function(t){r.setState(u.J.PullUp),e.tick(t)}),(function(t){n.setState(u.J.PullUp),e.clockHigh(t)}),(function(t){e.tick(t)}),(function(){var e=r.value;n.setState(u.J.Low),t(e)}))}}]),t}()},13918:function(t,e,i){i.d(e,{A:function(){return u}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(37405);!function(t){t[t.Idle=0]="Idle",t[t.Start=1]="Start",t[t.Stop=2]="Stop",t[t.Read=3]="Read",t[t.Write=4]="Write"}(n||(n={}));var u=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this;(0,r.Z)(this,t),(0,s.Z)(this,"outgoingByte",void 0),(0,s.Z)(this,"incomingByte",void 0),(0,s.Z)(this,"clockIndex",void 0),(0,s.Z)(this,"ack",void 0),(0,s.Z)(this,"firstByte",void 0),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"onStart",void 0),(0,s.Z)(this,"onConnect",void 0),(0,s.Z)(this,"onReadByte",void 0),(0,s.Z)(this,"onWriteByte",void 0),(0,s.Z)(this,"onDisconnect",void 0),(0,s.Z)(this,"addressFilter",void 0),this.addressFilter=i,this.outgoingByte=0,this.incomingByte=0,this.clockIndex=0,this.ack=!1,this.firstByte=!1,this.state=n.Idle;var u=e.scl,l=e.sda;u.setState(o.J.PullUp),l.setState(o.J.PullUp),l.onValueChange((function(t){var e,i,r,s;u.value&&!t&&(a.state=n.Start,a.clockIndex=0,a.incomingByte=0,null===(i=(e=a).onStart)||void 0===i||i.call(e));u.value&&t&&(a.state=n.Stop,null===(s=(r=a).onDisconnect)||void 0===s||s.call(r))})),u.onValueChange((function(t){var e=a.state===n.Start,i=a.state===n.Write,r=a.state===n.Read;if(t||l.setState(o.J.PullUp),t&&8===a.clockIndex)return a.incomingByte=0,void(a.clockIndex=0);if(e||i)if(t&&a.clockIndex<8)a.incomingByte<<=1,a.incomingByte|=l.value?1:0;else if(!t&&8===a.clockIndex){if(e){var s,u,c,d=a.incomingByte>>>1,h=!(1&a.incomingByte);if(a.addressFilter&&d!==a.addressFilter)a.ack=!1;else a.ack=null!==(c=null===(u=(s=a).onConnect)||void 0===u?void 0:u.call(s,d,h))&&void 0!==c&&c;a.ack?a.state=h?n.Write:n.Read:a.state=n.Idle,a.firstByte=!0}else{var v,f,p;a.ack=null!==(p=null===(f=(v=a).onWriteByte)||void 0===f?void 0:f.call(v,a.incomingByte))&&void 0!==p&&p}l.setState(a.ack?o.J.Low:o.J.PullUp)}if(r&&!t&&a.clockIndex<8)if(0===a.clockIndex&&l.value&&!a.firstByte)a.state=n.Idle;else{var g,m,y;if(0===a.clockIndex)a.outgoingByte=null!==(y=null===(m=(g=a).onReadByte)||void 0===m?void 0:m.call(g))&&void 0!==y?y:255,a.firstByte=!1;var w=a.outgoingByte&1<<7-a.clockIndex;l.setState(w?o.J.PullUp:o.J.Low)}t&&a.clockIndex++}))}return(0,a.Z)(t,[{key:"setHandler",value:function(t){this.onConnect=t.i2cConnect.bind(t),this.onReadByte=t.i2cReadByte.bind(t),this.onWriteByte=t.i2cWriteByte.bind(t),this.onDisconnect=t.i2cDisconnect.bind(t)}}]),t}()},16905:function(t,e,i){i.d(e,{v:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(37405),o=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=this;(0,n.Z)(this,t),(0,a.Z)(this,"busy",void 0),(0,a.Z)(this,"incomingByte",void 0),(0,a.Z)(this,"outgoingByte",void 0),(0,a.Z)(this,"bitIndex",void 0),(0,a.Z)(this,"clockIndex",void 0),(0,a.Z)(this,"clockNanos",void 0),(0,a.Z)(this,"completionCallback",void 0),(0,a.Z)(this,"clockCallback",void 0),(0,a.Z)(this,"clock",void 0),(0,a.Z)(this,"pins",void 0),(0,a.Z)(this,"mode",void 0),this.clock=e,this.pins=i,this.mode=r,this.busy=!1,this.incomingByte=0,this.outgoingByte=0,this.bitIndex=0,this.clockIndex=0,this.clockNanos=0,this.completionCallback=function(){return 0},this.clockCallback=function(){var t=o.clock,e=o.pins,i=e.clk,n=e.mosi,r=e.miso,a=o.clockIndex,u=o.bitIndex;a%2===1?(o.incomingByte|=(null===r||void 0===r?void 0:r.value)?1<<u:0,o.bitIndex--):null===n||void 0===n||n.setState(o.outgoingByte&1<<u?s.J.High:s.J.Low),i.setState(i.value?s.J.Low:s.J.High),o.clockIndex++,15===a?(o.busy=!1,o.completionCallback(o.incomingByte)):t.addEvent(o.clockNanos,o.clockCallback)};var u=r>=2,l=i.miso,c=i.clk,d=i.mosi;null===l||void 0===l||l.setState(s.J.HighZ),null===d||void 0===d||d.setState(s.J.HighZ),null===c||void 0===c||c.setState(u?s.J.High:s.J.Low)}return(0,r.Z)(t,[{key:"transmit",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=this.mode,r=this.pins,a=r.clk,o=r.mosi,u=n>=2,l=1===n||3===n;if(this.busy)throw new Error("SPI hardware is busy");this.busy=!0,this.incomingByte=0,this.bitIndex=7,this.clockIndex=0,this.outgoingByte=t,this.clockNanos=i,this.completionCallback=e,a.setState(u?s.J.High:s.J.Low),l?(null===o||void 0===o||o.setState(s.J.High),this.clock.addEvent(i,this.clockCallback)):this.clockCallback()}},{key:"transmitBuffer",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=this,r=0,a=function(s){s>=0&&(t[r-1]=s),r<t.length?n.transmit(t[r++],a,i):e()};a(-1)}}]),t}()},35154:function(t,e,i){i.d(e,{g:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(29182),o=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9600,o=this;(0,n.Z)(this,t),(0,a.Z)(this,"listeners",void 0),(0,a.Z)(this,"autoBaudRate",void 0),(0,a.Z)(this,"rxInProgress",void 0),(0,a.Z)(this,"bits",void 0),(0,a.Z)(this,"stopBits",void 0),(0,a.Z)(this,"parity",void 0),(0,a.Z)(this,"baudRate",void 0),this.baudRate=r,this.listeners=new Set,this.autoBaudRate=!1,this.rxInProgress=!1,this.bits=8,this.stopBits=1,this.parity=s.A.None,i.protocols.uartRX=this,i.onValueChange((function(){if(o.autoBaudRate){var t=!0,n=!1,r=void 0;try{for(var a,u=i.node.pins[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var l=a.value.protocols.uartTX;l&&!l.autoBaudRate&&(o.baudRate=l.baudRate)}}catch(f){n=!0,r=f}finally{try{t||null==u.return||u.return()}finally{if(n)throw r}}}var c=1e9/o.baudRate;if(!i.value&&!o.rxInProgress){var d=o;o.rxInProgress=!0;var h=0,v=o.bits;e.addEvent(Math.round(.5*c),(function(){var t=function(t){e.addEvent(Math.round(c*(t+1)),(function(){h|=i.value?1<<t:0}))},n=d;if(i.value)d.rxInProgress=!1;else{for(var r=0;r<v;r++)t(r);var a=v+d.stopBits;d.parity!==s.A.None&&a++,e.addEvent(Math.round(c*a),(function(){if(i.value){var t=!0,e=!1,r=void 0;try{for(var a,s=n.listeners[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){(0,a.value)(new Uint8Array([h]))}}catch(f){e=!0,r=f}finally{try{t||null==s.return||s.return()}finally{if(e)throw r}}}n.rxInProgress=!1}))}}))}}))}return(0,r.Z)(t,[{key:"feedFromTx",value:function(t){if(this.rxInProgress)return!1;var e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(new Uint8Array([t]))}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}return!0}},{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}}]),t}()},80450:function(t,e,i){i.d(e,{x:function(){return l}});var n=i(51438),r=i(52951),a=i(14924),s=i(96387),o=i(37405),u=i(29182),l=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9600;(0,n.Z)(this,t),(0,a.Z)(this,"onTxComplete",void 0),(0,a.Z)(this,"fifo",void 0),(0,a.Z)(this,"busy",void 0),(0,a.Z)(this,"autoBaudRate",void 0),(0,a.Z)(this,"bits",void 0),(0,a.Z)(this,"stopBits",void 0),(0,a.Z)(this,"parity",void 0),(0,a.Z)(this,"clock",void 0),(0,a.Z)(this,"tx",void 0),(0,a.Z)(this,"baudRate",void 0),this.clock=e,this.tx=i,this.baudRate=r,this.fifo=new s.Q,this.busy=!1,this.autoBaudRate=!1,this.bits=8,this.stopBits=1,this.parity=u.A.None,i.protocols.uartTX=this,i.state=o.J.PullUp}return(0,r.Z)(t,[{key:"transmit",value:function(t){var e=this,i=function(i){e.clock.addEvent(f*(i+1),(function(){r.state=t&1<<i?o.J.PullUp:o.J.Low,p^=r.state?1:0}))},n=this,r=this.tx,a=this.bits;if(this.busy)return!1;if(this.autoBaudRate){var s=!0,l=!1,c=void 0;try{for(var d,h=r.node.pins[Symbol.iterator]();!(s=(d=h.next()).done);s=!0){var v=d.value.protocols.uartRX;v&&!v.autoBaudRate&&(this.baudRate=v.baudRate)}}catch(y){l=!0,c=y}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}}this.busy=!0;var f=Math.round(1e9/this.baudRate);r.state=o.J.Low;for(var p=0,g=0;g<a;g++)i(g);var m=a+1;return this.parity!==u.A.None&&(this.parity===u.A.Odd&&(p^=1),this.clock.addEvent(f*m++,(function(){r.state=p?o.J.PullUp:o.J.Low}))),this.clock.addEvent(f*m++,(function(){r.state=o.J.PullUp})),2===this.stopBits&&m++,this.clock.addEvent(f*m++,(function(){n.busy=!1,n.transmitNext()})),!0}},{key:"transmitNext",value:function(){if(!this.busy){var t,e=this.fifo.next();if(null!=e)this.transmit(e);else null===(t=this.onTxComplete)||void 0===t||t.call(this)}}},{key:"write",value:function(t){this.fifo.write(t),this.transmitNext()}},{key:"writeByte",value:function(t){this.busy?this.fifo.writeByte(t):this.transmit(t)}},{key:"isBusy",get:function(){return this.busy}}]),t}()},29182:function(t,e,i){var n;i.d(e,{A:function(){return n}}),function(t){t[t.None=0]="None",t[t.Odd=1]="Odd",t[t.Even=2]="Even"}(n||(n={}))},41725:function(t,e,i){function n(t,e){var i=/^\d+\.\d+V/.test(e)?e.replace(/\.\d+$/,""):e.split(".")[0];return"".concat(t,":").concat(i)}function r(t){var e=t.split(":");return{partId:e[0],pinName:e[1]}}function a(t,e,i){var n=!0,r=!1,a=void 0;try{for(var s,o=i.pins[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;e.pins.add(u),t.set(u,e)}}catch(l){r=!0,a=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}function s(t){var e=new Map,i=!0,r=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=l.fromPart,d=l.fromPin,h=l.toPart,v=l.toPin,f=n(c,d),p=n(h,v),g=e.get(f)||{pins:new Set([f])},m=e.get(p)||{pins:new Set([p])};e.set(f,g),e.set(p,m),a(e,g,m)}}catch(y){r=!0,s=y}finally{try{i||null==u.return||u.return()}finally{if(r)throw s}}return e}i.d(e,{XP:function(){return s},_N:function(){return r},r4:function(){return n}})},99941:function(t,e,i){i.d(e,{B:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=1e3/30,o=function(){function t(e){var i=this;(0,n.Z)(this,t),(0,a.Z)(this,"lastMillis",void 0),(0,a.Z)(this,"animationFrame",void 0),(0,a.Z)(this,"legacy",void 0),(0,a.Z)(this,"afterRun",void 0),(0,a.Z)(this,"run",void 0),(0,a.Z)(this,"execute",void 0),this.execute=e,this.lastMillis=-1,this.animationFrame=null,this.legacy=!1,this.run=function(t){var e,n,r=t-i.lastMillis;i.lastMillis=t;var a=i.execute(r<s?r:s);null===(n=(e=i).afterRun)||void 0===n||n.call(e),i.animationFrame=a?requestAnimationFrame(i.run):null}}return(0,r.Z)(t,[{key:"start",value:function(){this.stop(),this.animationFrame=requestAnimationFrame(this.run)}},{key:"stop",value:function(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)}}]),t}()},98561:function(t,e,i){function n(){var t=Math.random();return t<.1?-Math.floor(60+t/.1*10):t<.3?-Math.floor(70+(t-.1)/.2*10):t<.7?-Math.floor(80+(t-.3)/.4*10):-Math.floor(90+(t-.7)/.3*10)}i.d(e,{a:function(){return n}})},3615:function(t,e,i){i.d(e,{c:function(){return L}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(82670),u=i(1965),l=i(4111),c=i(28668),d=i(26626),h=i(29815);!function(t){t[t.SSID=0]="SSID",t[t.SupportedRates=1]="SupportedRates",t[t.FHParameterSet=2]="FHParameterSet",t[t.DSParameterSet=3]="DSParameterSet",t[t.CFParameterSet=4]="CFParameterSet",t[t.TrafficIndicationMap=5]="TrafficIndicationMap",t[t.IBSSParameterSet=6]="IBSSParameterSet",t[t.Country=7]="Country",t[t.HoppingPatternParameters=8]="HoppingPatternParameters",t[t.HoppingPatternTable=9]="HoppingPatternTable",t[t.Request=10]="Request",t[t.ChallengeText=16]="ChallengeText",t[t.PowerConstraint=32]="PowerConstraint",t[t.PowerCapability=33]="PowerCapability",t[t.TPCRequest=34]="TPCRequest",t[t.TPCReport=35]="TPCReport",t[t.SupportedChannels=36]="SupportedChannels",t[t.ChannelSwitchAnnouncement=37]="ChannelSwitchAnnouncement",t[t.MeasurementRequest=38]="MeasurementRequest",t[t.MeasurementReport=39]="MeasurementReport",t[t.Quiet=40]="Quiet",t[t.IBSSDFS=41]="IBSSDFS",t[t.ERPInformation=42]="ERPInformation",t[t.RobustSecurityNetwork=48]="RobustSecurityNetwork",t[t.ExtendedSupportedRates=50]="ExtendedSupportedRates",t[t.WPA=221]="WPA"}(n||(n={}));var v,f,p=[255,255,255,255,255,255];function g(t,e){return[t,e.length].concat((0,h.Z)(Array.from(e)))}function m(t){return"undefined"!==typeof TextEncoder?(new TextEncoder).encode(t):t.split("").map((function(t){return t.charCodeAt(0)}))}function y(t){return"undefined"!==typeof TextDecoder?(new TextDecoder).decode(t):Array.from(t).map((function(t){return String.fromCharCode(t)})).join("")}function w(t,e){return t[e+1]<<8|t[e]}function k(t,e){return(3&t)<<2|(15&e)<<4}function Z(t){for(var e=0,i=[];e+1<t.length;){var n=t[e++],r=t[e++];t.length>=e+r&&i.push({id:n,value:t.slice(e,e+r)}),e+=r}return i}function b(t){return t.slice(10,16)}function C(t,e){var i=e.target,n=e.bssid,r=e.seq;return[k(v.Management,t)].concat((0,h.Z)([0,0,0]),(0,h.Z)(Array.from(i)),(0,h.Z)(Array.from(n)),(0,h.Z)(Array.from(n)),(0,h.Z)([r>>4&255,r<<4&255]))}function x(t){var e=t.bssid,i=t.seq,r=t.channel,a=t.ssid;return new Uint8Array((0,h.Z)(C(f.Beacon,{target:p,bssid:e,seq:i})).concat((0,h.Z)([0,0,0,0,0,0,0,0]),(0,h.Z)([100,0]),(0,h.Z)([33,4]),(0,h.Z)(g(n.SSID,m(a))),(0,h.Z)(g(n.SupportedRates,[140,18,152,36,176,72,96,108])),(0,h.Z)(g(n.DSParameterSet,[r])),(0,h.Z)(g(n.TrafficIndicationMap,[0,2,0,0,0,0]))))}!function(t){t[t.Management=0]="Management",t[t.Control=1]="Control",t[t.Data=2]="Data"}(v||(v={})),function(t){t[t.AssociationRequest=0]="AssociationRequest",t[t.ReassociationRequest=2]="ReassociationRequest",t[t.ProbeRequest=4]="ProbeRequest",t[t.TimingAdvertisement=6]="TimingAdvertisement",t[t.Beacon=8]="Beacon",t[t.Disassociation=10]="Disassociation",t[t.Deauthentication=12]="Deauthentication",t[t.Authentication=11]="Authentication",t[t.Action=14]="Action",t[t.AssociationResponse=1]="AssociationResponse",t[t.ReassociationResponse=3]="ReassociationResponse",t[t.ProbeResponse=5]="ProbeResponse",t[t.Reserved=7]="Reserved"}(f||(f={}));var S,_,P=1e8,D=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"clients",void 0),(0,s.Z)(this,"onReceive",void 0),(0,s.Z)(this,"sendBeacon",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"medium",void 0),(0,s.Z)(this,"config",void 0),this.clock=e,this.medium=i,this.config=n,this.clients=new Map,this.onReceive=function(t){var e=t.data,i=t.channel,n=a.config;if(!(i!==n.channel&&i!==n.channel+2||e.length<10)){var r=function(t){var e=t[0]>>2&3,i=t.slice(4,10),n=t.slice(16,22);return{version:3&t[0],type:e,subtype:t[0]>>4&15,flags:t[1],duration:(t[3]>>8)+t[2],target:e===v.Data?n:i,source:t.slice(10,16),bssid:e===v.Data?i:n}}(e),s=r.type,o=r.subtype,l=r.target,c=r.bssid,d=r.source;switch(s){case v.Management:n.bssid.match(new u.o(l))&&a.managementFrame(o,e);break;case v.Data:var h=new u.o(d).toString(),f=a.clients.get(h),p=4&o;f&&n.bssid.match(new u.o(c))&&!p&&a.onDataFrame(f,e)}}},this.sendBeacon=function(){var t=a.config;a.medium.transmit({channel:t.channel,data:x({bssid:t.bssid.bytes,ssid:t.ssid,channel:t.channel,seq:0})}),a.clock.addEvent(P,a.sendBeacon)},this.config.hidden||this.clock.addEvent(P,this.sendBeacon),i.listen(this.onReceive)}return(0,a.Z)(t,[{key:"onDataFrame",value:function(t,e){}},{key:"onClientConnected",value:function(t){}},{key:"transmit",value:function(t){this.medium.transmit({data:t,channel:this.config.channel})}},{key:"managementFrame",value:function(t,e){var i,r=this.config;switch(t){case f.ProbeRequest:var a=function(t){var e=Z(t.subarray(24)).find((function(t){return t.id===n.SSID}));return{source:b(t),ssid:e?y(e.value):""}}(e);a.ssid!==r.ssid&&""!==a.ssid||this.transmit(function(t){var e=t.target,i=t.ssid,r=t.bssid,a=t.seq,s=t.channel;return new Uint8Array((0,h.Z)(C(f.ProbeResponse,{target:e,bssid:r,seq:a})).concat((0,h.Z)([0,0,0,0,0,0,0,0]),(0,h.Z)([100,0]),(0,h.Z)([33,4]),(0,h.Z)(g(n.SSID,m(i))),(0,h.Z)(g(n.SupportedRates,[140,18,152,36,176,72,96,108])),(0,h.Z)(g(n.DSParameterSet,[s]))))}({target:a.source,bssid:r.bssid.bytes,ssid:r.ssid,channel:1,seq:0}));break;case f.Deauthentication:this.clients.delete(new u.o(b(e)).toString());break;case f.Authentication:var s={source:b(i=e),algorithm:w(i,24),authSeq:w(i,26),status:w(i,28)};this.transmit(function(t){var e,i=t.target,n=t.bssid,r=t.seq,a=t.authSeq;return new Uint8Array((0,h.Z)(C(f.Authentication,{target:i,bssid:n,seq:r})).concat((0,h.Z)([0,0]),(0,h.Z)([255&(e=a),e>>8&255]),(0,h.Z)([0,0])))}({target:s.source,bssid:r.bssid.bytes,seq:0,authSeq:s.authSeq+1}));break;case f.AssociationRequest:var o=function(t){var e=Z(t.subarray(28)).find((function(t){return t.id===n.SSID}));return{source:b(t),ssid:e?y(e.value):""}}(e),l=new u.o(o.source);if(!this.clients.has(l.toString())){var c={mac:l};this.clients.set(l.toString(),c),this.onClientConnected(c)}this.transmit(function(t){var e=t.target,i=t.bssid,r=t.seq;return new Uint8Array((0,h.Z)(C(f.AssociationResponse,{target:e,bssid:i,seq:r})).concat((0,h.Z)([33,4]),(0,h.Z)([0,0]),(0,h.Z)([1,192]),(0,h.Z)(g(n.SupportedRates,[140,18,152,36,176,72,96,108]))))}({target:o.source,bssid:r.bssid.bytes,seq:0}))}}}]),t}(),I=function(){function t(e){if((0,r.Z)(this,t),(0,s.Z)(this,"bytes",void 0),(0,s.Z)(this,"address",void 0),this.address=e,"string"===typeof e){var i=e.split(".");this.bytes=new Uint8Array([parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)])}else this.bytes=e.subarray(0,4)}return(0,a.Z)(t,[{key:"toString",value:function(){var t=this.bytes;return"".concat(t[0],".").concat(t[1],".").concat(t[2],".").concat(t[3])}}]),t}();!function(t){t[t.IP=2048]="IP",t[t.ARP=2054]="ARP",t[t.IPv6=34525]="IPv6"}(S||(S={})),function(t){t[t.ICMP=1]="ICMP",t[t.IGMP=2]="IGMP",t[t.TCP=6]="TCP",t[t.UDP=17]="UDP"}(_||(_={}));var A,R=i(2889),B=function(t){(0,c.Z)(i,t);var e=(0,d.Z)(i);function i(t,n,a,o){var u;return(0,r.Z)(this,i),u=e.call(this,t,n,a),(0,s.Z)((0,l.Z)(u),"buffer",void 0),(0,s.Z)((0,l.Z)(u),"socket",void 0),(0,s.Z)((0,l.Z)(u),"enableWarning",void 0),(0,s.Z)((0,l.Z)(u),"proxyParams",void 0),(0,s.Z)((0,l.Z)(u),"proxy",void 0),u.proxy=o,u.buffer=[],u.enableWarning=!0,u.proxyParams=new URLSearchParams,u}return(0,a.Z)(i,[{key:"initSocket",value:function(){var t=this,e=new WebSocket(this.proxy+"?"+this.proxyParams.toString());e.binaryType="arraybuffer",this.socket=e,e.addEventListener("close",(function(){t.socket=void 0})),e.addEventListener("open",(function(){if(t.buffer){var i=!0,n=!1,r=void 0;try{for(var a,s=t.buffer[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;e.send(o)}}catch(u){n=!0,r=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}t.buffer=[]}})),e.addEventListener("message",(function(e){var i,n,r=e.data;if((0,o.Z)(r,ArrayBuffer))t.transmit((i=new Uint8Array(r),n=t.config.bssid.bytes,new Uint8Array([k(v.Data,0),2].concat((0,h.Z)([0,0]),(0,h.Z)(i.slice(0,6)),(0,h.Z)(Array.from(n)),(0,h.Z)(i.slice(6,12)),(0,h.Z)([0,0]),(0,h.Z)([170,170,3,0,0,0]),(0,h.Z)(i.slice(12))))));else if(t.enableWarning){try{var a=JSON.parse(r);if("aloha"===a.type&&"wokwigw"===a.protocol){console.log("WiFi proxy",a.gatewayVersion);var s=a.gatewayVersion.startsWith("netwi")?"Public gateway":"Private gateway";return void(0,R.L)({action:s,category:"wifi",label:a.gatewayVersion})}}catch(u){}console.warn("Unknown WiFi data",r),t.enableWarning=!1}})),e.addEventListener("error",(function(t){console.error("WiFi Internet error",t)}))}},{key:"onClientConnected",value:function(){this.socket||this.initSocket()}},{key:"onDataFrame",value:function(t,e){var i,n=function(t){var e=128&t[0];return new Uint8Array((0,h.Z)(t.slice(16,22)).concat((0,h.Z)(t.slice(10,16)),(0,h.Z)(t.slice(e?32:30))))}(e),r=function(t){var e={frame:t,frameLength:t.length,etherType:0,packetType:"unknown"};if(t.length<14)return e;e.destinationMAC=new u.o(t.slice(0,6)).toString(),e.sourceMAC=new u.o(t.slice(6,12)).toString(),e.etherType=t[12]<<8|t[13];var i=t.subarray(14);switch(e.etherType){case S.ARP:e.packetType="arp";break;case S.IP:if(e.packetType="ip",i.length<20)break;var n=4*(15&i[0]);e.protocol=i[9],e.sourceIP=new I(i.slice(12,16)).toString(),e.destinationIP=new I(i.slice(16,20)).toString();var r=i.subarray(n);switch(e.protocol){case _.ICMP:e.packetType="icmp";break;case _.IGMP:e.packetType="igmp";break;case _.TCP:if(e.packetType="tcp",r.length<20)break;e.sourcePort=r[0]<<8|r[1],e.destinationPort=r[2]<<8|r[3];break;case _.UDP:if(e.packetType="udp",r.length<8)break;e.sourcePort=r[0]<<8|r[1],e.destinationPort=r[2]<<8|r[3]}break;case S.IPv6:e.packetType="ip6"}return e}(n);"udp"===r.packetType&&5353===r.sourcePort&&5353===r.destinationPort||((null===(i=this.socket)||void 0===i?void 0:i.readyState)===WebSocket.OPEN?this.socket.send(n):this.buffer.push(n))}}]),i}(D),E=i(95315),U=i(70222),N=i(88409),T=i(84003);function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6*(new Date).getTime(),i=new Uint8Array(16+t.length),n=new DataView(i.buffer);return n.setUint32(0,Math.floor(e/1e9),!0),n.setUint32(4,Math.floor(e%1e9),!0),n.setUint32(8,t.length,!0),n.setUint32(12,t.length,!0),i.set(t,16),i}!function(t){t[t.ETHERNET=1]="ETHERNET",t[t.IEEE802_11=105]="IEEE802_11",t[t.IEEE802_11_RADIOTAP=127]="IEEE802_11_RADIOTAP"}(A||(A={}));var M=new WeakMap,V=function(){function t(e){var n,a=this;(0,r.Z)(this,t),(0,U.Z)(this,M,{writable:!0,value:void 0}),(0,s.Z)(this,"listeners",void 0),(0,s.Z)(this,"frames",void 0),(0,s.Z)(this,"framesBytes",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,(0,N.Z)(this,M,"undefined"!==typeof BroadcastChannel?new BroadcastChannel("WiFi"):void 0),this.listeners=new Set,this.frames=[],this.framesBytes=0,null===(n=(0,E.Z)(this,M))||void 0===n||n.addEventListener("message",(function(t){var e=t.data,i=!0,n=!1,r=void 0;try{for(var s,o=a.listeners[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){(0,s.value)(e)}}catch(u){n=!0,r=u}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}})),i.g.downloadPcap=function(){console.log('To download a PCAP file, press "F1" in the code editor and select "Download WiFi Packet Capture (PCAP) file"')}}return(0,a.Z)(t,[{key:"listen",value:function(t){this.listeners.add(t)}},{key:"transmit",value:function(t){this.frames.push({nanos:this.clock.cpuNanos,data:t.data}),this.framesBytes+=t.data.length;var e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(t)}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"downloadPcap",value:function(){var t=24+16*this.frames.length,e=new Uint8Array(t+this.framesBytes);e.set(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A.IEEE802_11,e=new Uint8Array(24),i=new DataView(e.buffer);return i.setUint32(0,2712812621,!0),i.setUint16(4,2,!0),i.setUint16(6,4,!0),i.setUint16(16,65535,!0),i.setUint16(20,t,!0),e}());var i=24,n=!0,r=!1,a=void 0;try{for(var s,o=this.frames[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,l=u.data,c=u.nanos;e.set(O(l,c),i),i+=16+l.length}}catch(d){r=!0,a=d}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}(0,T.Sv)("wokwi.pcap",e,"application/vnd.tcpdump.pcap")}}]),t}();var L=function(){function t(e){var i;(0,r.Z)(this,t),(0,s.Z)(this,"medium",void 0),(0,s.Z)(this,"accessPoints",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.medium=new V(this.clock),this.accessPoints=[new B(this.clock,this.medium,{channel:6,ssid:"Wokwi-GUEST",bssid:new u.o("42:13:37:55:aa:01"),hidden:!1},(i="wss://netwi.wokwi.com/","undefined"!==typeof localStorage&&localStorage.getItem("__proxy")||i))]}return(0,a.Z)(t,[{key:"setCredentials",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.accessPoints[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;(0,o.Z)(s,B)&&(s.proxyParams=new URLSearchParams({u:t.user||"anonymous",p:t.project}))}}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}]),t}()},28715:function(t,e,i){i.d(e,{Jj:function(){return c},Uf:function(){return u},Y1:function(){return l}});var n=i(2236),r=i(47568),a=i(29815),s=i(34051),o=i.n(s);function u(){return window.showDirectoryPicker}function l(){return window.showDirectoryPicker()}function c(t,e){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)(o().mark((function t(e,i){var r,s,u,l,d,h,v,f,p,g;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],s=!1,u=!1,t.prev=2,d=(0,n.Z)(e.values());case 4:return t.next=6,d.next();case 6:if(!(s=!(h=t.sent).done)){t.next=30;break}if(v=h.value,"directory"!==(f=v).kind){t.next=21;break}return t.t0=(p=r).push,t.t1=p,t.t2=a.Z,t.next=16,c(f,i);case 16:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4),t.next=27;break;case 21:if(!(g=i(f))||!("then"in g)){t.next=26;break}return t.next=25,g;case 25:g=t.sent;case 26:null!=g&&r.push(g);case 27:s=!1,t.next=4;break;case 30:t.next=36;break;case 32:t.prev=32,t.t5=t.catch(2),u=!0,l=t.t5;case 36:if(t.prev=36,t.prev=37,!s||null==d.return){t.next=41;break}return t.next=41,d.return();case 41:if(t.prev=41,!u){t.next=44;break}throw l;case 44:return t.finish(41);case 45:return t.finish(36);case 46:return t.abrupt("return",r);case 47:case"end":return t.stop()}}),t,null,[[2,32,36,46],[37,,41,45]])})))).apply(this,arguments)}},8371:function(t,e,i){function n(t,e,i){return t<e?e:t>i?i:t}i.d(e,{u:function(){return n}})},79207:function(t,e,i){i.d(e,{Z:function(){return r},w:function(){return a}});var n=i(10253);function r(t){var e=t.replace(/[_,]/g,"").trim().toLowerCase(),i=/^([\d.]+)\s*([mk]|[mk]hz|hz|)$/.exec(e);if(!i)return 0;var r=(0,n.Z)(i,3),a=r[1],s=r[2],o=parseFloat(a);switch(s[0]){case"m":return Math.round(1e6*o);case"k":return Math.round(1e3*o);default:return o}}function a(t){var e="";t>=1e3&&t<1e6?(e="k",t/=1e3):t>=1e6&&t<1e9?(e="m",t/=1e6):t>=1e9&&(e="g",t/=1e9);for(var i=3,n=t.toFixed(i);i&&(n.endsWith("0")||n.endsWith(".")||n.length>4);)i--,n=t.toFixed(i);return"".concat(n).concat(e)}},56498:function(t,e,i){function n(t){return t>=16?t.toString(16):"0"+t.toString(16)}function r(t){return n(t>>8&255)+n(255&t)}function a(t){return r(t>>16&65535)+r(65535&t)}i.d(e,{MS:function(){return a},Tf:function(){return r},sA:function(){return n}})},1965:function(t,e,i){i.d(e,{o:function(){return u}});var n=i(51438),r=i(52951),a=i(14924),s=i(82670),o=i(56498),u=function(){function t(e){if((0,n.Z)(this,t),(0,a.Z)(this,"bytes",void 0),"string"===typeof e){var i=e.split(":");this.bytes=new Uint8Array([parseInt(i[0],16),parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),parseInt(i[4],16),parseInt(i[5],16)])}else this.bytes=e}return(0,r.Z)(t,[{key:"match",value:function(e){return e.equals(t.broadcast)||this.equals(e)}},{key:"equals",value:function(e){return(0,s.Z)(e,t)&&this.toString()===e.toString()}},{key:"toString",value:function(){var t,e,i,n,r,a,s=this.bytes;return[(0,o.sA)(null!==(t=s[0])&&void 0!==t?t:0),(0,o.sA)(null!==(e=s[1])&&void 0!==e?e:0),(0,o.sA)(null!==(i=s[2])&&void 0!==i?i:0),(0,o.sA)(null!==(n=s[3])&&void 0!==n?n:0),(0,o.sA)(null!==(r=s[4])&&void 0!==r?r:0),(0,o.sA)(null!==(a=s[5])&&void 0!==a?a:0)].join(":")}}]),t}();(0,a.Z)(u,"broadcast",new u("ff:ff:ff:ff:ff:ff"))},66869:function(t,e,i){function n(t,e){return t+Math.round(Math.random()*(e-t))}i.d(e,{r:function(){return n}})}}]);