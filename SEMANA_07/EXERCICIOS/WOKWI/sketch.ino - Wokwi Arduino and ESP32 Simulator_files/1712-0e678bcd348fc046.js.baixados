"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1712],{91712:function(e,n,r){r.d(n,{IK:function(){return Z},ir:function(){return N}});var t=r(47568),i=r(29815),a=r(34051),o=r.n(a),u=r(38966),s=r.n(u),d=r(67090),l=r(26042),c=r(69396);var f=r(78298),v=r(84104),m=r(41842),p=r(68102),h=r(28467),g=o().mark(y);function b(e){return""!==e?parseInt(e,8):0}function y(e){var n,r,t,i,a,u,s,d,l,c,f,v,m,p,y,x,k,C,w;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=new h.B(e);case 1:if(!(n.remaining>512)){o.next=28;break}if(r=n.readChars(100),t=b(n.readChars(8)),i=b(n.readChars(8)),a=b(n.readChars(8)),u=b(n.readChars(12)),s=b(n.readChars(12)),d=b(n.readChars(8)),l=n.readChars(1),c=n.readChars(100),f=n.readChars(6),v=n.readChars(2),m="ustar"===f&&"00"===v,p=n.readChars(32),y=n.readChars(32),x=n.readChars(8),k=n.readChars(8),C=n.readChars(155),n.skip(12),r||u||C){o.next=22;break}return o.abrupt("continue",1);case 22:return w=n.readBytes(u),u%512!==0&&n.skip(512-u%512),o.next=26,{name:m&&C?"".concat(C,"/").concat(r):r,mode:t,owner:i,group:a,size:u,lastModified:s,checksum:d,type:l,linkName:c,ownerName:m?p:"",groupName:m?y:"",devMajor:m?x:"",devMinor:m?k:"",data:w};case 26:o.next=1;break;case 28:case"end":return o.stop()}}),g)}var x=r(60286),k=r(51438),C=r(52951),w=r(14924),I=r(68949),V=function(){function e(){(0,k.Z)(this,e),(0,w.Z)(this,"breakpoints",[]),(0,I.ky)(this)}return(0,C.Z)(e,[{key:"setBreakpoint",value:function(e){this.breakpoints.push({lineNumber:e,active:!1})}},{key:"removeBreakpoint",value:function(e){this.breakpoints=this.breakpoints.filter((function(n){return n.lineNumber!==e}))}}]),e}(),F=d.V5.model({name:d.V5.string,size:d.V5.number,serverId:d.V5.maybe(d.V5.string)}).volatile((function(){return{buffer:null,progress:0,modified:!1,uploading:!1,downloading:!1,uploadFailed:!1,abort:new AbortController}})).views((function(e){return{get transferring(){return e.uploading||e.downloading}}})).actions((function(e){return{updateProgress:function(n){e.progress=n},completeUpload:function(n){e.uploading=!1,n?e.serverId=n:(e.uploadFailed=!0,e.modified=!1)},setBuffer:function(n){e.buffer=null!==n&&void 0!==n?n:null,e.downloading=!1},setPristine:function(){e.modified=!1}}})).actions((function(e){return{upload:function(n,r){return(0,t.Z)(o().mark((function t(){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.serverId&&!e.uploading){t.next=2;break}return t.abrupt("return");case 2:return(0,p.DT)(r).then((function(n){return e.setBuffer(n)})),e.uploading=!0,e.modified=!0,t.prev=5,t.next=8,(0,m.cT)(n,r,{abortSignal:e.abort.signal,onProgress:function(n){return e.updateProgress(n.loaded/n.total)}});case 8:i=t.sent,e.completeUpload(i.fileId),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),console.error(t.t0),e.completeUpload();case 16:case"end":return t.stop()}}),t,null,[[5,12]])})))()},afterCreate:function(){return(0,t.Z)(o().mark((function n(){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.serverId){n.next=13;break}return e.downloading=!0,n.prev=2,n.next=5,(0,m.Sv)(e.serverId,{abortSignal:e.abort.signal,onProgress:function(n){return e.updateProgress(n.loaded/e.size)}});case 5:r=n.sent,e.setBuffer(r),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(2),console.error(n.t0),e.setBuffer();case 13:case"end":return n.stop()}}),n,null,[[2,9]])})))()},beforeDestroy:function(){e.abort.abort()}}})),N="sdcard/",L=d.V5.model({name:d.V5.string,content:d.V5.string}).volatile((function(e){return{originalName:e.name,originalContent:e.content,deleted:!1,editorState:null,errors:[],debugger:new V}})).views((function(e){return{get type(){return(0,v.r5)(e.name)},get modified(){return e.content!==e.originalContent||e.originalName!==e.name}}})).actions((function(e){return{update:function(n){e.content=n},rename:function(n){e.name=n},setPristine:function(){e.originalContent=e.content,e.originalName=e.name},setEditorState:function(n){e.editorState=n}}})),Z=d.V5.model({name:d.V5.optional(d.V5.string,""),id:d.V5.maybe(d.V5.string),parentId:d.V5.maybe(d.V5.string),files:d.V5.array(L),serverFiles:d.V5.array(F),owner:d.V5.maybe(d.V5.string),locked:d.V5.maybe(d.V5.boolean),unlisted:d.V5.optional(d.V5.boolean,!1),updated:d.V5.maybe(d.V5.Date),hearts:d.V5.optional(d.V5.number,0),userLiked:d.V5.optional(d.V5.boolean,!1)}).volatile((function(){return{binaryFiles:[],filesDeleted:!1,diagramInstance:x.S0.create(),lastDiagramContent:""}})).views((function(e){return{get diagram(){var n=e.files.find((function(e){return"diagram"===e.type}));if(!n)return null;if((null===n||void 0===n?void 0:n.content)!==e.lastDiagramContent)try{var r;(0,d.Xx)(e.diagramInstance,JSON.parse(null!==(r=null===n||void 0===n?void 0:n.content)&&void 0!==r?r:"null")),e.lastDiagramContent||e.diagramInstance.undoManager.reset()}catch(t){return console.warn("Failed to parse diagram",t),null}return e.diagramInstance},get readme(){return e.files.find((function(e){return"readme"===e.type}))},get modified(){return e.files.some((function(e){return e.modified}))||e.serverFiles.some((function(e){return e.modified}))||e.filesDeleted},findFile:function(n){return e.files.find((function(e){return e.name===n}))},get isDBProject(){return e.id&&/^[0-9]+$/.test(e.id)},get url(){return e.id?(0,v.gd)(e.id):null},get sdCardFiles(){return e.serverFiles.filter((function(e){return e.name.startsWith(N)}))}}})).views((function(e){return{get architecture(){var n;return"rp2040"===(null===(n=e.diagram)||void 0===n?void 0:n.board.mcuType)?"arm":"avr"},get projectType(){var n,r,t=null===(r=null===(n=e.diagram)||void 0===n?void 0:n.findMCU())||void 0===r?void 0:r.attrs.get("env");return(null===t||void 0===t?void 0:t.startsWith("kaluma"))?"kaluma":(null===t||void 0===t?void 0:t.startsWith("micropython"))?"micropython":(null===t||void 0===t?void 0:t.startsWith("circuitpython"))?"circuitpython":"arduino"}}})).actions((function(e){return{addFile:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=e.files.push({name:n,content:r,modified:!0});return e.files[t-1]},addBinaryFile:function(n,r){e.binaryFiles.push({name:n,content:r})},updateFile:function(n,r){var t=e.files.find((function(e){return e.name===n}));null===t||void 0===t||t.update(r)},renameFile:function(n,r){var t;null===(t=e.findFile(n))||void 0===t||t.rename(r),n.endsWith(".ino")&&n===e.name&&(e.name=r)},removeFile:function(n){var r=e.findFile(n);r&&(r.deleted=!0,e.files.remove(r),e.filesDeleted=!0)},uploadFile:function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=t+(0,p.pC)(r),a=e.serverFiles.find((function(e){return e.name===i}));a&&(0,d.ob)(a);var o=F.create({name:i,size:r.size});o.upload(n,r),e.serverFiles.push(o)},removeServerFile:function(e){(0,d.ob)(e)},setName:function(n){e.name=n},fork:function(){e.owner=void 0,e.locked=!1,e.name&&!e.name.endsWith(" copy")&&(e.name+=" copy")},changeId:function(n){e.id=n},changeOwner:function(n){e.owner=n},setPristine:function(){e.files.forEach((function(e){return e.setPristine()})),e.serverFiles.forEach((function(e){return e.setPristine()})),e.filesDeleted=!1},setLocked:function(n){e.locked=n},setUnlisted:function(n){e.unlisted=n},updateHearts:function(n){e.hearts=n},updateUserLike:function(n){e.userLiked=n},setGCCErrors:function(n,r){var t=!0,a=!1,o=void 0;try{for(var u,s=e.files[Symbol.iterator]();!(t=(u=s.next()).done);t=!0){u.value.errors=[]}}catch(x){a=!0,o=x}finally{try{t||null==s.return||s.return()}finally{if(a)throw o}}var d=(0,f.qK)(n),l=d.errors,c=d.remainingOutput,v=e.files[0],m=!0,p=!1,h=void 0;try{for(var g,b=function(n,r){var t,a=r.value,o=e.files.find((function(e){return e.name===a}));o?o.errors=l[a]:(t=v.errors).push.apply(t,(0,i.Z)(l[a]))},y=Object.keys(l)[Symbol.iterator]();!(m=(g=y.next()).done);m=!0)b(0,g)}catch(x){p=!0,h=x}finally{try{m||null==y.return||y.return()}finally{if(p)throw h}}(n=(0,f.zf)(c)).length>0&&!r&&v.errors.push({type:"error",startLineNumber:1,endLineNumber:1,endColumn:1,startColumn:1,message:n})},syncDiagram:function(){var n,r=e.diagram;r&&(e.lastDiagramContent=s()(function(e){return(0,c.Z)((0,l.Z)({},e),{parts:(e.parts||[]).map((function(e){var n=(0,l.Z)({},e);return n.hide||delete n.hide,n.rotate||delete n.rotate,n}))})}((0,d.vM)(r)),null,2,100),null===(n=e.findFile("diagram.json"))||void 0===n||n.update(e.lastDiagramContent));return e.diagram}}})).actions((function(e){return{updateFromServer:function(n){return(0,t.Z)(o().mark((function r(){var t;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.id){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(0,m._L)(n,e.id);case 4:t=r.sent.userLiked,e.updateUserLike(t);case 6:case"end":return r.stop()}}),r)})))()},loadEgg:function(n){return(0,t.Z)(o().mark((function t(){var i,a,u,s,d,l,c,f,v,m;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.e(2655).then(r.bind(r,27885)),t.next=3,fetch("https://wokwi.com/api/external/hatchery?egg=".concat(encodeURIComponent(n)));case 3:return a=t.sent,t.next=6,a.arrayBuffer();case 6:return u=t.sent,t.next=9,i;case 9:for(s=t.sent.inflate(u),d=!0,l=!1,c=void 0,t.prev=11,f=function(n,r){var t=r.value,i="app/"+t.name.split("/").slice(1).join("/");if(i.endsWith(".png")||i.endsWith(".mpy"))e.addBinaryFile(i,t.data);else{var a=(new TextDecoder).decode(t.data);e.files.find((function(e){return e.name===i}))?e.updateFile(i,a):e.addFile(i,a)}},v=y(s)[Symbol.iterator]();!(d=(m=v.next()).done);d=!0)f(0,m);t.next=20;break;case 16:t.prev=16,t.t0=t.catch(11),l=!0,c=t.t0;case 20:t.prev=20,t.prev=21,d||null==v.return||v.return();case 23:if(t.prev=23,!l){t.next=26;break}throw c;case 26:return t.finish(23);case 27:return t.finish(20);case 28:case"end":return t.stop()}}),t,null,[[11,16,20,28],[21,,23,27]])})))()}}}))},78298:function(e,n,r){r.d(n,{qK:function(){return s},zf:function(){return d},GS:function(){return u}});var t=r(29815),i=r(20014);var a="/sketch/",o="sketch.ino";function u(e,n){return e.split("/sketch/sketch.ino").join(n)}function s(e){var n=(0,t.Z)((0,i.parseString)(e)).concat((0,t.Z)(function(e){for(var n=/(\n|^)(\/sketch\/[^:/]+\.S):(\d+): (Warning|Error): (.+)(\s*\n|$)/g,r=[],t=n.exec(e);t;)r.push({filename:t[2],line:parseInt(t[3],10),type:t[4].toLowerCase(),text:t[5],column:1,tokenLength:999,startIndex:t.index,endIndex:t.index+t[0].length}),n.lastIndex--,t=n.exec(e);return r}(e))),r={},u=null;r[o]=[],n.sort((function(e,n){return e.startIndex==n.startIndex?"note"==e.type?1:-1:e.startIndex-n.startIndex}));var s="",d=!0,l=!1,c=void 0;try{for(var f,v=n[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var m,p,h,g=f.value,b=g.filename,y=g.line,x=g.column,k=g.tokenLength,C=g.text,w=g.type,I=g.startIndex,V=g.endIndex,F=e.substring(null!==(p=null===u||void 0===u?void 0:u.endIndex)&&void 0!==p?p:0,I),N=/\r?\n?.+: In function '.+':\s*$/.exec(F),L=null!==(h=null===N||void 0===N||null===(m=N[0])||void 0===m?void 0:m.replace(/^\s*/g,""))&&void 0!==h?h:"";if(N&&(F=F.substr(0,N.index)),u?u.message+=F:s=F,"note"===w&&u&&u.startLineNumber===y&&u.startColumn===x)u.message+="\n"+C,u.endIndex=V;else if(b.startsWith(a)){var Z=b.substring(a.length);u={type:w,startLineNumber:y,endLineNumber:y,startColumn:x,endColumn:x+(k||1),message:L+C,startIndex:I,endIndex:V},r[Z]||(r[Z]=[]),r[Z].push(u)}else{var D=b.replace(/\/arduino\/hardware\/avr\/[0-9.]+\/cores/g,"");r[o].push({type:w,startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:1,message:"".concat(D,":").concat(y,": ").concat(L+C),startIndex:I,endIndex:V})}}}catch(S){l=!0,c=S}finally{try{d||null==v.return||v.return()}finally{if(l)throw c}}return u&&(u.message+=e.substr(u.endIndex).replace(/Error during build: exit status 1/,"").replace(/\s+$/,"")),{errors:r,remainingOutput:s}}function d(e){var n=e.replace(/.+\n.+\n[ \t]*#\s*pragma message "FastLED version 3\.\d+\.\d+".*\n.+/,"").trim();return"Error during build: exit status 1"===n?"":n}},28467:function(e,n,r){r.d(n,{B:function(){return o}});var t=r(51438),i=r(52951),a=r(14924),o=function(){function e(n){(0,t.Z)(this,e),(0,a.Z)(this,"index",void 0),(0,a.Z)(this,"decoder",void 0),(0,a.Z)(this,"buf",void 0),this.buf=n,this.index=0,this.decoder=new TextDecoder}return(0,i.Z)(e,[{key:"readUint8",value:function(){return this.buf[this.index++]}},{key:"readUint16",value:function(){var e=this.index,n=this.buf[e],r=this.buf[e+1];return this.index+=2,r<<8|n}},{key:"readUint32",value:function(){var e=this.index,n=this.buf[e],r=this.buf[e+1],t=this.buf[e+2],i=this.buf[e+3];return this.index+=4,(i<<24|t<<16|r<<8|n)>>>0}},{key:"readInt32",value:function(){return 0|this.readUint32()}},{key:"readBytes",value:function(e){var n=this.buf.subarray(this.index,this.index+e);return this.index+=e,n}},{key:"readChars",value:function(e){var n=this.readBytes(e),r=n.indexOf(0);return r>=0&&(n=n.subarray(0,r)),this.decoder.decode(n)}},{key:"skip",value:function(e){this.index+=e}},{key:"currentOffset",get:function(){return this.index}},{key:"remaining",get:function(){var e=this.buf.length-this.index;return e>0?e:0}}]),e}()}}]);