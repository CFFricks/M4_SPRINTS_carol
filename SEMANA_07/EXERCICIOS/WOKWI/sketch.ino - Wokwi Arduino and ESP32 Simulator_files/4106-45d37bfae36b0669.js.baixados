(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4106,8107],{55929:function(e,n,r){"use strict";r.d(n,{r:function(){return d}});var t=r(85893),i=r(41664),a=r.n(i),o=r(27909),s=r(11529),c=r(47598),l=r.n(c);function d(e){var n=e.children;return(0,t.jsx)("header",{children:(0,t.jsxs)("div",{className:l().toolbar,role:"banner",children:[(0,t.jsx)(a(),{href:"/",children:(0,t.jsx)("a",{className:l().logo,children:(0,t.jsx)(s.F,{width:80,height:24})})}),n,(0,t.jsx)("div",{className:l().spacer}),(0,t.jsx)("nav",{className:l().menu,children:(0,t.jsx)("a",{href:"https://docs.wokwi.com/?utm_source=wokwi",target:"_blank",children:"Docs"})}),(0,t.jsx)(o.I,{size:"small"})]})})}},21258:function(e,n,r){"use strict";r.d(n,{_:function(){return t}});var t=(0,r(81719).ZP)("div")({display:"flex",flexDirection:"column",minHeight:"100vh"})},44106:function(e,n,r){"use strict";r.d(n,{m:function(){return fr}});var t=r(47568),i=r(34051),a=r.n(i),o=r(85893),s=r(55317),c=r(8849),l=r.n(c),d=r(95617),u=r(19620),h=r(75862),p=r(38043),f=r(51797),m=r(31538),v=r(7473),x=r(61702),b=r(22841),g=r(75158),k=r(54225),j=r(72389),y=r(80562),w=r(30120),_=r(89497),Z=r(13264),S=r(71217),C=r(9008),P=r.n(C),L=r(41664),D=r.n(L),T=r(11163),E=r.n(T),I=r(67294),A=r(10625),N=r(49060),M=r(86899),F=r(2889),U=r(32122);var R=r(41842),W=r(31320),O=r(26042),z=r(69396),B=r(99534),H=r(45111),G=r(62135),X=r(19117),q=r(80134),V=(0,I.createContext)(null),K=(0,q.Z)(k.Z)({minWidth:"28px",padding:"4px 0"});function Y(e){var n=e.text,r=e.children,t=e.variant,i=(0,B.Z)(e,["text","children","variant"]),a=(0,I.useState)(!1),s=a[0],c=a[1],l=(0,I.useRef)(null),d=function(){return c(!1)};return(0,o.jsxs)(V.Provider,{value:{closeMenu:d},children:[(0,o.jsxs)(G.Z,{variant:t,ref:l,children:[(0,o.jsx)(k.Z,(0,z.Z)((0,O.Z)({variant:t},i),{children:n})),(0,o.jsx)(K,{size:"small",onClick:function(){return c(!0)},variant:t,children:(0,o.jsx)(H.Z,{})})]}),(0,o.jsx)(X.Z,{open:s,onClose:d,anchorEl:l.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:r})]})}function J(e){var n=e.children,r=(0,I.useContext)(V);return(0,o.jsx)("div",{onClick:function(){null===r||void 0===r||r.closeMenu()},children:n})}var Q=r(88440),$=r(55929),ee=r(21258),ne=r(1890),re=r(77745),te=r(95398),ie=r(29630),ae=r(76779),oe=r(82272),se=r(6853),ce=r.n(se);function le(e){var n=e.link,r=(0,A.q)("project.shareDialog").translate,t=(0,I.useRef)(null);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"text",value:n,ref:t,readOnly:!0,onClick:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.select()}}),(0,o.jsx)(j.Z,{title:r("copyToClipboard","Copy to clipboard"),children:(0,o.jsx)(y.Z,{onClick:function(e){var n;null===(n=t.current)||void 0===n||n.select(),document.execCommand("copy"),e.target.focus()},children:(0,o.jsx)(l(),{path:s._U3,size:1})})})]})}function de(e){var n,r=e.open,t=e.onClose,i=e.project,a=e.saving,c=e.onSaveProject,d=(0,A.q)("project.shareDialog").translate;return(0,o.jsxs)(ne.Z,{open:r,onClose:t,classes:{paper:ce().modalContent},children:[(0,o.jsx)(oe.P,{onClose:t}),(0,o.jsx)(re.Z,{children:d("title","Share Project")}),(0,o.jsx)(te.Z,{children:(null===i||void 0===i?void 0:i.url)?(0,o.jsx)("div",{className:ce().shareLinkContainer,children:(0,o.jsx)(le,{link:null!==(n=i.url)&&void 0!==n?n:""})}):(0,o.jsxs)(ie.Z,{children:[d("pleaseSave","To share this project, please save it first:"),(0,o.jsx)(w.Z,{mt:2,children:(0,o.jsx)(k.Z,{variant:"contained",startIcon:a?(0,o.jsx)(l(),{path:s.CEZ,size:1,spin:!0}):(0,o.jsx)(l(),{path:s.Tls,size:1}),onClick:c,children:d("saveProject","Save project")})})]})}),(0,o.jsx)(ae.Z,{children:(0,o.jsx)(k.Z,{onClick:t,children:d("closeButton","Close")})})]})}var ue=r(10253),he=r(29815),pe=r(88272),fe=r(90713);var me=r(70062),ve=r(29894),xe=r(85214),be=r(80748),ge=r(91712),ke=r(68102),je=r(40622),ye=(0,S.Pi)((function(e){var n=e.show,r=e.onHide;return(0,o.jsxs)(ne.Z,{open:n,onClose:r,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,o.jsx)(re.Z,{id:"form-dialog-title",children:"Hmm... Join the club?"}),(0,o.jsx)(te.Z,{children:"File upload is only available to Wokwi Club members."}),(0,o.jsxs)(ae.Z,{children:[(0,o.jsx)(k.Z,{variant:"outlined",onClick:r,sx:{margin:1},children:"Close"}),(0,o.jsx)(k.Z,{variant:"contained",href:"/club",target:"_blank",children:"Learn more"})]})]})})),we=r(46761),_e=r(26576),Ze=r(70754);function Se(e){var n;return(0,o.jsxs)(w.Z,{sx:{position:"relative",display:"inline-flex"},children:[(0,o.jsx)(Ze.Z,(0,O.Z)({variant:"determinate"},e)),(0,o.jsx)(w.Z,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)(ie.Z,{variant:"caption",component:"div",color:"text.secondary",children:"".concat(Math.round(null!==(n=e.value)&&void 0!==n?n:100),"%")})})]})}var Ce=(0,S.Pi)((function(e){var n=e.file,r=e.onRemove,t=n.name.substring(ge.ir.length);return(0,o.jsxs)(be.ZP,{secondaryAction:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(y.Z,{onClick:function(){return r(n)},children:(0,o.jsx)(we.Z,{})})}),children:[(0,o.jsx)(x.Z,{primary:t,secondary:"".concat(n.size," bytes"),sx:{marginRight:1}}),n.transferring&&(0,o.jsx)(Se,{value:Math.floor(100*n.progress)}),n.uploadFailed&&(0,o.jsx)(j.Z,{title:"Upload failed",children:(0,o.jsx)(_e.Z,{color:"error"})})]})})),Pe=(0,S.Pi)((function(){var e=(0,pe.a)(),n=(0,je.P)(),r=(0,A.q)("editor.sdCard").translate,i=(0,I.useState)(!1),s=i[0],c=i[1],l=function(){var r=(0,t.Z)(a().mark((function r(t){var i,o,s,l,d,u,h;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.club){r.next=3;break}return c(!0),r.abrupt("return");case 3:return r.next=5,(0,ke.aE)(t?{directory:!0}:{multiple:!0});case 5:for(i=r.sent.files,o=!0,s=!1,l=void 0,r.prev=7,d=i[Symbol.iterator]();!(o=(u=d.next()).done);o=!0)h=u.value,n.uploadFile(e,h,ge.ir);r.next=15;break;case 11:r.prev=11,r.t0=r.catch(7),s=!0,l=r.t0;case 15:r.prev=15,r.prev=16,o||null==d.return||d.return();case 18:if(r.prev=18,!s){r.next=21;break}throw l;case 21:return r.finish(18);case 22:return r.finish(15);case 23:case"end":return r.stop()}}),r,null,[[7,11,15,23],[16,,18,22]])})));return function(e){return r.apply(this,arguments)}}(),d=function(e){return n.removeServerFile(e)},u=n.sdCardFiles;return(0,o.jsxs)(w.Z,{display:"flex",flexDirection:"column",flex:1,height:0,children:[(0,o.jsx)(ye,{show:s,onHide:function(){return c(!1)}}),(0,o.jsxs)(w.Z,{p:1,children:[(0,o.jsx)(Y,{text:r("uploadFiles","Upload files"),variant:"contained",onClick:function(){return l(!1)},children:(0,o.jsx)(J,{children:(0,o.jsxs)(m.Z,{onClick:function(){return l(!0)},children:[(0,o.jsx)(ve.Z,{children:(0,o.jsx)(me.Z,{fontSize:"small"})}),(0,o.jsx)(x.Z,{children:r("uploadCompleteFolder","Upload complete folder")})]})})}),(0,o.jsx)(k.Z,{variant:"outlined",sx:{marginLeft:1},onClick:function(){var e=!0,r=!1,t=void 0;try{for(var i,a=n.serverFiles[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;n.removeServerFile(o)}}catch(s){r=!0,t=s}finally{try{e||null==a.return||a.return()}finally{if(r)throw t}}},children:r("uploadCompleteFolder","Delete all files")})]}),(0,o.jsxs)(xe.Z,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},children:[!u.length&&(0,o.jsx)(be.ZP,{children:(0,o.jsx)(x.Z,{primary:r("noFilesYet","No files yet. Please upload some files.")})}),u.map((function(e){return(0,o.jsx)(Ce,{file:e,onRemove:d},e.name)}))]})]})}));var Le=r(60286),De=r(68949),Te=r(5176),Ee=r(26017);function Ie(e){switch(e){case Te.G.Running:return"start";case Te.G.Stopped:return"stop";case Te.G.Paused:return"pause"}}var Ae=r(74372),Ne=r(80947),Me=r(67044);function Fe(){return(Fe=(0,t.Z)(a().mark((function e(n){var t,i,o,s,c,l,d,u,h,p,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=[],d=null===(t=n.diagram)||void 0===t?void 0:t.findMCU(),p=(0,Ne.nr)(null!==(u=null===d||void 0===d?void 0:d.type)&&void 0!==u?u:"",null!==(h=null===d||void 0===d?void 0:d.attrs.get("env"))&&void 0!==h?h:""),l.push((0,Ae.b)(n.files,{board:p,buildType:"backend",projectId:n.id})),e.t0=null===(i=n.diagram)||void 0===i?void 0:i.board.mcuType,e.next="rp2040"===e.t0?9:"esp32"===e.t0||"esp32-c3"===e.t0||"esp32-s2"===e.t0||"esp32-s3"===e.t0?11:13;break;case 9:return l.push(Promise.all([r.e(2319),r.e(3368)]).then(r.bind(r,53368))),e.abrupt("break",13);case 11:return l.push(Promise.all([r.e(3421),r.e(2442),r.e(3244)]).then(r.bind(r,43244))),e.abrupt("break",13);case 13:if(f=n.files.some((function(e){return"main.py"===e.name})),m="terminal"===(null===(o=n.diagram)||void 0===o||null===(s=o.serialMonitor)||void 0===s?void 0:s.display),(f||m)&&l.push(Promise.all([r.e(6142),r.e(2787)]).then(r.bind(r,82787))),f&&l.push((0,Me.V)("lfs")),!(null===(c=n.diagram)||void 0===c?void 0:c.parts.some((function(e){return"wokwi-midi-player"===e.type})))){e.next=23;break}return e.t1=l,e.next=21,r.e(5661).then(r.bind(r,95661));case 21:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 23:return e.next=25,Promise.all(l);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue="i2c-counter.chip.c",Re='\n// Wokwi Custom Chip - For information and examples see:\n// https://link.wokwi.com/custom-chips-alpha\n//\n// SPDX-License-Identifier: MIT\n// Copyright (C) 2022 Uri Shaked / wokwi.com\n\n#include "wokwi-api.h"\n#include <stdio.h>\n#include <stdlib.h>\n\nconst int ADDRESS = 0x22;\n\ntypedef struct {\n  pin_t pin_int;\n  uint8_t counter;\n  uint32_t threshold_attr;\n} chip_state_t;\n\nstatic bool on_i2c_connect(void *user_data, uint32_t address, bool connect);\nstatic uint8_t on_i2c_read(void *user_data);\nstatic bool on_i2c_write(void *user_data, uint8_t data);\nstatic void on_i2c_disconnect(void *user_data);\n\nvoid chip_init() {\n  chip_state_t *chip = malloc(sizeof(chip_state_t));\n\n  chip->pin_int = pin_init("INT", INPUT);\n  chip->counter = 0;\n\n  const i2c_config_t i2c_config = {\n    .user_data = chip,\n    .address = ADDRESS,\n    .scl = pin_init("SCL", INPUT),\n    .sda = pin_init("SDA", INPUT),\n    .connect = on_i2c_connect,\n    .read = on_i2c_read,\n    .write = on_i2c_write,\n    .disconnect = on_i2c_disconnect, // Optional\n  };\n  i2c_init(&i2c_config);\n\n  // This attribute can be edited by the user. It\'s defined in wokwi-custom-part.json:\n  chip->threshold_attr = attr_init("threshold", 127);\n\n  // The following message will appear in the browser\'s DevTools console:\n  printf("Hello from custom chip!\\n");\n}\n\nstatic void counter_updated(chip_state_t *chip) {\n  const uint32_t threshold = attr_read(chip->threshold_attr);\n  if (chip->counter > threshold) {\n    pin_write(chip->pin_int, LOW);\n    pin_mode(chip->pin_int, OUTPUT);\n  } else {\n    pin_mode(chip->pin_int, INPUT);\n  }\n}\n\nbool on_i2c_connect(void *user_data, uint32_t address, bool connect) {\n  return true; /* Ack */\n}\n\nuint8_t on_i2c_read(void *user_data) {\n  chip_state_t *chip = user_data;\n  chip->counter++;\n  counter_updated(chip);\n  return chip->counter;\n}\n\nbool on_i2c_write(void *user_data, uint8_t data) {\n  chip_state_t *chip = user_data;\n  chip->counter = data;\n  counter_updated(chip);\n  return true; // Ack\n}\n\nvoid on_i2c_disconnect(void *user_data) {\n  // Do nothing\n}\n'.trim()+"\n",We="i2c-counter.chip.json",Oe=JSON.stringify({name:"I2C Counter",author:"Uri Shaked",pins:["INT","SCL","SDA","GND","VCC","","","","",""],controls:[{id:"threshold",label:"LED Threshold",type:"range",min:1,max:255,step:1}]},null,2),ze=r(77432),Be=r(28715),He=r(84003),Ge=r(904),Xe=r(72428),qe=r(10160),Ve=r(43963),Ke=r(20293),Ye=r(80451),Je=r(23115),Qe=r(84104),$e=r(82670),en=r(96506),nn=r(52149),rn=r(85050),tn=r(76866),an=r(9041),on=r(852),sn=r(86070),cn=r(13288),ln=r(9764),dn=r(86010),un=function(e){return fetch(e).then((function(e){return e.json()}))},hn=(0,S.Pi)((function(e){var n=e.onAddLibrary,r=e.onUploadLibrary,t=(0,cn.ZP)("https://libraries.wokwi.workers.dev/list",un),i=t.data,a=t.error,s=(0,I.useState)(""),c=s[0],l=s[1],d=(0,I.useState)(-1),u=d[0],h=d[1],p=(0,I.useRef)(null),f=(0,I.useRef)(null),v=(0,I.useRef)(null);if(a)return(0,o.jsx)(w.Z,{p:1,children:(0,o.jsx)(ie.Z,{children:"Error loading library index :-("})});var x,b=c.trim().toLowerCase(),g=b&&null!==(x=null===i||void 0===i?void 0:i.libraries.filter((function(e){return e.toLowerCase().includes(b)})))&&void 0!==x?x:[],j=function(e){var n,r=function(e){var n=g.length-1;switch(e){case"ArrowUp":return Math.max(0,u-1);case"ArrowDown":return Math.min(n,u+1);case"PageUp":return Math.max(0,u-12);case"PageDown":return Math.max(0,u+12);default:return null}}(e.code);null!=r&&(null===(n=f.current)||void 0===n||n.scrollIntoView({index:r,behavior:"auto",done:function(){return h(r)}}),e.preventDefault())};return(0,o.jsxs)(w.Z,{p:2,minWidth:300,children:[(0,o.jsxs)(rn.Z,{position:"sticky",onFocus:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.focus()},children:[(0,o.jsx)(tn.Z,{autoFocus:!0,ref:p,value:c,onChange:function(e){return l(e.target.value)},onClick:function(e){return e.stopPropagation()},sx:{width:"100%"},onKeyDown:function(e){if("Enter"===e.key){var r=u>=0&&g[u];r&&(n(r),e.preventDefault())}else"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&"PageUp"!==e.key&&"PageDown"!=e.key||(j(e),e.preventDefault())},endAdornment:(0,o.jsx)(an.Z,{position:"end",children:(0,o.jsx)(en.Z,{})})})," "]}),(0,o.jsxs)(on.Z,{children:[b&&!i&&(0,o.jsxs)(w.Z,{py:2,children:[(0,o.jsx)(ie.Z,{children:"Loading library index..."}),(0,o.jsx)(sn.Z,{})]}),g.length>0&&(0,o.jsx)(ln.OO,{style:{height:"400px",maxHeight:"100%"},data:g,ref:f,scrollerRef:function(e){(0,$e.Z)(e,HTMLElement)&&(e.addEventListener("keydown",j),v.current=function(){return e.removeEventListener("keydown",j)})},itemContent:function(e,r){return(0,o.jsx)(m.Z,{onClick:function(){return n(r)},className:(0,dn.Z)(e===u&&"Mui-focusVisible"),children:r},r)}}),b&&!g.length&&(0,o.jsx)(ie.Z,{color:"gray",children:"No libraries found"}),!b&&(0,o.jsx)(ie.Z,{color:"gray",children:"Type some text to search for libraries"})]}),!b&&(0,o.jsx)(k.Z,{startIcon:(0,o.jsx)(nn.Z,{}),onClick:r,children:"Upload a library"})]})})),pn="wokwi:",fn=r(39702),mn=r(57322),vn=r(44731),xn=(0,S.Pi)((function(e){var n=e.library,r=e.onRemoveLibrary,t=(0,ue.Z)(n.split("@"),2),i=t[0],a=t[1],s=null===a||void 0===a?void 0:a.startsWith(pn),c=i+".zip",l=null===a||void 0===a?void 0:a.substring(pn.length),d="https://wokwi.com/storage/libs/".concat(l,"/").concat(c);return(0,o.jsxs)(be.ZP,{secondaryAction:(0,o.jsxs)(o.Fragment,{children:[s&&(0,o.jsx)("a",{href:d,download:!0,children:(0,o.jsx)(y.Z,{children:(0,o.jsx)(fn.Z,{})})}),(0,o.jsx)(y.Z,{onClick:r,children:(0,o.jsx)(we.Z,{})})]}),children:[(0,o.jsx)(ve.Z,{children:(0,o.jsx)(vn.Z,{children:(0,o.jsx)(mn.Z,{})})}),(0,o.jsx)(x.Z,{primary:s?c:i})]})})),bn=r(30521),gn=(0,S.Pi)((function(e){var n=e.uploadState,r=(0,A.q)("project.libManager.uploadDialog").translate,t=function(){return n.abort()};return(0,o.jsxs)(ne.Z,{open:n.uploading,onClose:t,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,o.jsx)(re.Z,{id:"form-dialog-title",children:r("title","Uploading library...")}),(0,o.jsx)(te.Z,{children:(0,o.jsx)(bn.y,{value:100*n.progress})}),(0,o.jsx)(ae.Z,{children:(0,o.jsx)(k.Z,{onClick:t,children:r("cancelButton","Cancel")})})]})})),kn=r(51438),jn=r(52951),yn=r(14924),wn=function(){function e(){(0,kn.Z)(this,e),(0,yn.Z)(this,"uploading",!1),(0,yn.Z)(this,"progress",0),(0,yn.Z)(this,"abortController",void 0),(0,De.ky)(this)}return(0,jn.Z)(e,[{key:"startUpload",value:function(e,n){var r=this;return(0,t.Z)(a().mark((function t(){var i,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.uploading=!0,r.abortController=new AbortController,t.next=4,(0,R.jI)(e,n,{abortSignal:r.abortController.signal,onProgress:function(e){return r.updateProgress(e.loaded/e.total)}});case 4:if(i=t.sent,o=r.abortController.signal.aborted,r.finishUpload(),!o){t.next=9;break}return t.abrupt("return",null);case 9:return t.abrupt("return",null!==i&&void 0!==i?i:null);case 10:case"end":return t.stop()}}),t)})))()}},{key:"updateProgress",value:function(e){this.progress=e}},{key:"finishUpload",value:function(){this.uploading=!1,this.abortController=void 0}},{key:"abort",value:function(){var e;this.uploading=!1,null===(e=this.abortController)||void 0===e||e.abort()}}]),e}(),_n=(0,S.Pi)((function(){var e,n=(0,je.P)(),r=(0,pe.a)(),i=(0,I.useRef)(null),s=(0,I.useState)(!1),c=s[0],l=s[1],d=(0,I.useState)(!1),u=d[0],h=d[1],p=(0,I.useState)(new wn)[0],f=n.findFile(Qe.vW),m=Array.from((0,Je.h)(null!==(e=null===f||void 0===f?void 0:f.content)&&void 0!==e?e:"")),v=function(){if(f)return f;var e=n.files.filter((function(e){return"sketch"===(0,Qe.r5)(e.name)})).flatMap((function(e){return(0,Ye.h7)(e.content)})).map((function(e){return Je.i[e]})).filter((function(e){return e})),r=["# Wokwi Library List","# See https://docs.wokwi.com/guides/libraries",""],t=!1,i=!0,a=!1,o=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;t||(r.push("# Automatically added based on includes:"),t=!0),r.push(l)}}catch(d){a=!0,o=d}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return t&&r.push(""),n.addFile(Qe.vW,r.join("\n")+"\n")},b=function(e){var n=v(),r=n.content;r.endsWith("\n")||(r+="\n"),r+=e,n.update(r),l(!1)},g=function(e){var n=v(),r=n.content.split("\n").filter((function(n){return n.trim().split("@")[0]!==e})).join("\n");n.update(r)},k=function(){var e=(0,t.Z)(a().mark((function e(){var n,t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.club){e.next=3;break}return h(!0),e.abrupt("return");case 3:return e.next=5,(0,ke.aE)({directory:!0});case 5:if(n=e.sent.files,(t=Array.from(n).filter(R.kn)).length){e.next=10;break}return alert("Invalid library: no source files (.c, .cpp, .h) found!"),e.abrupt("return");case 10:return e.next=12,p.startUpload(r,t);case 12:(i=e.sent)&&(g(i.libraryName),b("".concat(i.libraryName,"@").concat(pn).concat(i.fileId)));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.jsxs)(w.Z,{display:"flex",flexDirection:"column",flex:1,height:0,position:"relative",children:[(0,o.jsx)(gn,{uploadState:p}),(0,o.jsx)(ye,{show:u,onHide:function(){return h(!1)}}),(0,o.jsxs)(w.Z,{p:1,children:[(0,o.jsx)(ie.Z,{variant:"h5",component:"h2",children:"Project Libraries"}),(0,o.jsx)(j.Z,{title:"Add a new library",children:(0,o.jsx)(qe.Z,{color:"primary",size:"medium",ref:i,onClick:function(){return l(!0)},sx:{position:"absolute",top:16,right:16,zIndex:10},children:(0,o.jsx)(Xe.Z,{})})}),(0,o.jsx)(Ve.ZP,{open:c,anchorEl:i.current,onClose:function(){return l(!1)},onClick:function(){return l(!1)},onKeyDown:function(e){"Enter"===e.key&&(l(!1),e.stopPropagation())},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,o.jsx)(hn,{onAddLibrary:b,onUploadLibrary:k})})]}),(0,o.jsxs)(xe.Z,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},"aria-labelledby":"nested-list-subheader",subheader:(0,o.jsx)(Ke.Z,{component:"div",id:"nested-list-subheader",children:"Installed Libraries"}),children:[!m.length&&(0,o.jsx)(be.ZP,{children:(0,o.jsx)(x.Z,{children:"No libraries installed."})}),m.map((function(e){return(0,o.jsx)(xn,{library:e,onRemoveLibrary:function(){return g(e.split("@")[0])}},e)}))]})]})})),Zn=r(59130),Sn=r(89022),Cn=r(66442);var Pn=r(98107),Ln=r(56498),Dn=r(64728),Tn=r(19903),En=r(90457),In=r.n(En);function An(e){for(var n=[],r=e.items,t=0;t<4;t++)t<r.length?n.push((0,Ln.MS)(r[t])):n.push("        ");return e.empty&&(n[0]="<EMPTY> "),n.join(" ")}var Nn=(0,S.Pi)((function(){var e=(0,I.useState)(0),n=e[0],r=e[1],t=(0,I.useState)(0),i=t[0],a=t[1],s=(0,I.useState)(0)[1],c=(0,I.useContext)(Tn.D),l=c.tempRunner,d=l.cpu,u=l.pioRunners[n],h=d.pio[n],p=h.instructions,f=h.machines[i],m=f.pc,v=(0,I.useMemo)((function(){return(0,Pn.C)(p,(0,Pn.k)(f.pinCtrl))}),[p,f]),x=function(){var e=(0,I.useState)(0)[1];return(0,I.useCallback)((function(){e((function(e){return e+1}))}),[])}();(0,I.useEffect)((function(){var e=setInterval((function(){s(f.cycles)}),100);return function(){return clearInterval(e)}}),[f]);var b=function(){d.pio[n].step(),c.forceUpdate(),s(f.cycles)},g=(0,I.useMemo)((function(){if(!f.enabled)return"STOP";if(!f.waiting)return"RUN";var e=f.waitPolarity?"1":"0";switch(f.waitType){case 1:return"WAIT ".concat(e," PIN ").concat(f.waitIndex);case 2:return"WAIT RXFIFO";case 3:case 5:return"WAIT TXFIFO";case 4:return"WAIT ".concat(e," IRQ ").concat(f.waitIndex);default:return""}}),[f.waitType,f.waitPolarity,f.waitIndex,f.waiting,f.enabled]);return(0,o.jsxs)("div",{className:In().debugger,onKeyPress:function(e){"n"===e.key.toLowerCase()&&(b(),e.preventDefault())},children:[(0,o.jsxs)("div",{children:["Wokwi PIO Debugger"," ",(0,o.jsxs)(G.Z,{size:"small",children:[(0,o.jsx)(k.Z,{onClick:function(){c.paused?c.resume():c.pause()},children:c.paused?(0,o.jsx)(Zn.Z,{}):(0,o.jsx)(Sn.Z,{})}),(0,o.jsx)(k.Z,{disabled:!c.running||!c.paused,children:(0,o.jsx)(Cn.Z,{onClick:b})})]})," ","PIO:"," ",(0,o.jsxs)(G.Z,{size:"small",children:[(0,o.jsx)(k.Z,{onClick:function(){return r(0)},variant:0===n?"contained":"outlined",children:"0"}),(0,o.jsx)(k.Z,{onClick:function(){return r(1)},variant:1===n?"contained":"outlined",children:"1"})]}),"Machine:",(0,o.jsxs)(G.Z,{size:"small",children:[(0,o.jsx)(k.Z,{onClick:function(){return a(0)},variant:0===i?"contained":"outlined",children:"0"}),(0,o.jsx)(k.Z,{onClick:function(){return a(1)},variant:1===i?"contained":"outlined",children:"1"}),(0,o.jsx)(k.Z,{onClick:function(){return a(2)},variant:2===i?"contained":"outlined",children:"2"}),(0,o.jsx)(k.Z,{onClick:function(){return a(3)},variant:3===i?"contained":"outlined",children:"3"})]})]}),(0,o.jsx)("div",{className:In().listing,children:v.map((function(e){return(0,o.jsxs)("pre",{className:(0,dn.Z)(e.address===m&&In().current),children:[(0,o.jsx)("input",{title:"Breakpoint","aria-label":"Breakpoint",type:"checkbox",checked:!!(u.breakpoints&1<<e.address),className:(0,dn.Z)(In().breakpoint),onChange:function(){u.breakpoints^=1<<e.address,x()}}),(0,o.jsx)("span",{className:In().lineNumber,children:(0,Dn.Gt)(e.address,2," ")}),(0,o.jsx)("span",{children:e.text})]},e.address)}))}),(0,o.jsxs)("div",{className:In().registers,children:["Registers: X ",(0,Ln.MS)(f.x)," Y ",(0,Ln.MS)(f.y)," ISR ",(0,Ln.MS)(f.inputShiftReg)," [",(0,o.jsx)("span",{children:(0,Dn.Gt)(f.inputShiftCount,2," ")}),"] OSR"," ",(0,Ln.MS)(f.outputShiftReg)," [",(0,o.jsx)("span",{children:(0,Dn.Gt)(f.outputShiftCount,2," ")}),"] CYCLES ",(0,o.jsx)("span",{children:(0,Dn.Gt)(f.cycles,8," ")})," ",g,(0,o.jsx)("br",{}),"RX: ",(0,o.jsx)("span",{className:In().fifo,children:An(f.rxFIFO)}),"TX: ",(0,o.jsx)("span",{className:In().fifo,children:An(f.txFIFO)})]})]})}));function Mn(){return Mn=(0,t.Z)(a().mark((function e(n,r,t){var i,o,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.removeFile(R.rp),e.next=3,r.build((0,z.Z)((0,O.Z)({},t),{files:n.files,diagram:n.diagram||Le.S0.create(),listing:!0}));case 3:if(i=e.sent,o=i.hex,!(s=i.hexError)){e.next=10;break}return console.error(s),alert("Error connecting to build server: "+s),e.abrupt("return");case 10:if(null===o||void 0===o?void 0:o.listing){e.next=14;break}return console.log(null===o||void 0===o?void 0:o.stderr),alert("Build failed!"),e.abrupt("return");case 14:(c=n.findFile(R.rp))?(c.update(o.listing),c.setPristine()):n.addFile(R.rp,o.listing);case 16:case"end":return e.stop()}}),e)}))),Mn.apply(this,arguments)}var Fn=r(56760),Un=r(5893),Rn=r(8107),Wn=r.n(Rn),On=r(61449),zn=r(80950),Bn=r.n(zn),Hn=r(38456),Gn=r.n(Hn),Xn=r(10043),qn=r.n(Xn),Vn=r(72832),Kn=r(48734),Yn=(0,On.N)().dark,Jn=(0,S.Pi)((function(e){var n,r,t=e.diagram,i=e.readme,a=e.files,s=(0,I.useState)(0),c=s[0],l=s[1];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(Kn.mQ,{children:[(0,o.jsx)(Kn.OK,{onClick:function(){return l(0)},active:0===c,children:"Simulation"}),(null===(n=null===i||void 0===i?void 0:i.content.trim())||void 0===n?void 0:n.length)?(0,o.jsx)(Kn.OK,{onClick:function(){return l(1)},active:1===c,children:"Description"}):null]}),0===c&&t&&(0,o.jsx)(Vn.u,{diagram:t,files:a}),1===c&&(0,o.jsx)("section",{className:(0,dn.Z)("markdown-body",Yn&&"dark"),children:(0,o.jsx)(Gn(),{remarkPlugins:[qn()],children:null!==(r=null===i||void 0===i?void 0:i.content)&&void 0!==r?r:""})}),(0,o.jsx)("style",{children:"\n        .markdown-body {\n          background: #eee;\n          color: black;\n          overflow: auto; /* Enable scrolling */\n          padding: 1.5em;\n          min-height: 100%;\n        }\n        .markdown-body.dark {\n          background: #111;\n          color: inherit;\n        }\n        .markdown-body.dark a {\n          color: #88f;\n        }\n        .markdown-body.dark pre {\n          background: #333;\n        }\n\n        .markdown-body::-webkit-scrollbar {\n          height: 16px;\n          width: 16px;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb,\n        .markdown-body::-webkit-scrollbar-track {\n          border: 4px solid transparent;\n          border-radius: 8px;\n          background-clip: padding-box;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb {\n          min-height: 40px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-thumb {\n          background-color: #3d3a3a;\n        }\n\n        .markdown-body::-webkit-scrollbar-track {\n          margin-bottom: 8px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-track {\n          background-color: #2a2a2a;\n        }\n\n        .markdown-body.dark table {\n          color: black;\n        }\n      "})]})})),Qn=(0,S.Pi)((function(e){var n=e.project,r=e.files,t=(0,I.useContext)(Q.r),i=Wn()(),a=i.ref,s=i.width,c=void 0===s?1:s,l=i.height,d=void 0===l?1:l,u=(0,I.useState)(""),h=u[0],p=u[1],f=(0,Fn.Z)();(0,I.useEffect)((function(){"diagram"===(0,On.N)().view&&p("diagram")}),[]),(0,I.useEffect)((function(){var e;null===(e=t.doLayout)||void 0===e||e.call(t)}),[c,d,t]);var m=n.files.some((function(e){return["readme","diagram"].includes(e.type)})),v=function(){return(0,o.jsx)("div",{className:Bn().editor,ref:a,children:(0,o.jsx)(Q.p,{tabs:r,architecture:n.architecture})})},x=function(){return(0,o.jsx)("div",{className:Bn().preview,children:(0,o.jsx)(Jn,{diagram:n.diagram,readme:n.readme,files:n.files})})};return(0,o.jsx)("div",{className:Bn().container,children:"diagram"===h?(0,o.jsx)("div",{className:Bn().diagramOnly,children:x()}):m?(0,o.jsxs)(Un.o,{split:"vertical",className:Bn().splitPane,resizerOptions:{hoverCss:{background:f.palette.primary.light,marginLeft:-2,width:4}},collapseOptions:{beforeToggleButton:(0,o.jsx)("button",{children:"\u27a1"}),afterToggleButton:(0,o.jsx)("button",{children:"\u2b05"}),overlayCss:{backgroundColor:"black"},collapseDirection:"right",buttonTransition:"zoom",buttonPositionOffset:-20,collapsedSize:10,collapseTransitionTimeout:350},children:[v(),x()]}):v()})})),$n=r(62722),er=r(18661),nr=r(81719),rr=r(79570),tr=r.n(rr),ir=(0,nr.ZP)($n.Z)({minHeight:24,background:"#333"}),ar=(0,nr.ZP)(er.Z)((function(e){var n=e.theme;return{textTransform:"none",minHeight:24,paddingTop:n.spacing(1),paddingBottom:n.spacing(1),"&.Mui-selected":{background:n.palette.secondary.dark,color:n.palette.primary.contrastText}}}));function or(e){var n=e.children,r=e.value,t=e.index,i=(0,B.Z)(e,["children","value","index"]);return(0,o.jsx)("div",(0,z.Z)((0,O.Z)({className:tr().tab,role:"tabpanel",hidden:r!==t,id:"full-width-tabpanel-".concat(t),"aria-labelledby":"full-width-tab-".concat(t)},i),{children:r===t&&n}))}var sr=(0,S.Pi)((function(e){var n=e.project,r=e.files,t=(0,I.useContext)(Q.r),i=Wn()(),a=i.ref,s=i.width,c=void 0===s?1:s,l=i.height,d=void 0===l?1:l,u=(0,I.useState)(0),h=u[0],p=u[1];(0,I.useEffect)((function(){var e;null===(e=t.doLayout)||void 0===e||e.call(t)}),[c,d,t]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(ir,{value:h,onChange:function(e,n){p(n)},variant:"fullWidth",indicatorColor:"secondary",children:[(0,o.jsx)(ar,{label:"Simulation"}),(0,o.jsx)(ar,{label:"Code"})]}),(0,o.jsxs)("div",{className:tr().container,children:[(0,o.jsx)(or,{value:h,index:0,children:(0,o.jsx)("div",{className:tr().diagram,children:n.diagram&&(0,o.jsx)(Vn.u,{diagram:n.diagram,files:n.files})})}),(0,o.jsx)(or,{value:h,index:1,children:(0,o.jsx)("div",{className:tr().editor,ref:a,children:(0,o.jsx)(Q.p,{tabs:r,architecture:n.architecture})})})]})]})})),cr={name:"Library Manager",content:"",customComponent:(0,o.jsx)(_n,{})},lr=(0,S.Pi)((function(e){var n=e.project,i=e.hex,s=(0,I.useContext)(Tn.D),c=(0,I.useContext)(Q.r),l=(0,I.useContext)(Ge.A),d=(0,I.useState)(c.ready),u=d[0],h=d[1],p=s.running&&s.showPioDebugger,f=(0,pe.a)(),m=(0,fe.$)(),v=function(){var e=(0,I.useState)("large"),n=e[0],r=e[1];return(0,I.useEffect)((function(){var e=window.matchMedia("(max-width: 640px)"),n=window.matchMedia("(max-width: 1007px)"),t=function(){e.matches?r("small"):n.matches?r("medium"):r("large")};return"addEventListener"in e?(e.addEventListener("change",t),n.addEventListener("change",t)):(e.addListener(t),n.addListener(t)),t(),function(){"removeEventListener"in e?(e.removeEventListener("change",t),n.removeEventListener("change",t)):(e.removeListener(t),n.removeListener(t))}}),[]),n}(),x=function(e){var n,r=(0,I.useMemo)((function(){return{name:"SD Card",content:"",customComponent:(0,o.jsx)(Pe,{})}}),[]);return r.modified=e.sdCardFiles.some((function(e){return e.modified})),(null===(n=e.diagram)||void 0===n?void 0:n.parts.find((function(e){return"wokwi-microsd-card"===e.type})))?[r]:[]}(n);(0,I.useEffect)((function(){(null===i||void 0===i?void 0:i.cacheKey)&&Ae.I.put(i.cacheKey,i)})),function(e){var n="Leave page? Changes you made may not be saved.";(0,I.useEffect)((function(){var r=function(r){if(E().asPath!==r&&e&&!confirm(n))throw E().events.emit("routeChangeError"),E().replace(E().asPath,E().asPath,{shallow:!0}),"Abort route change. Please ignore this error."},t=function(r){if(e)return r.preventDefault(),r.returnValue=n,n};return window.addEventListener("beforeunload",t),E().events.on("routeChangeStart",r),function(){window.removeEventListener("beforeunload",t),E().events.off("routeChangeStart",r)}}),[e])}(n.modified),(0,I.useEffect)((function(){n&&u&&function(e){Fe.apply(this,arguments)}(n)}),[n,u]);var b=(0,he.Z)(n.files).concat((0,he.Z)(x),(0,he.Z)("arduino"===n.projectType?[cr]:[]),(0,he.Z)(p?[{name:"PIO \ud83d\udc1b",content:"",customComponent:(0,o.jsx)(Nn,{})}]:[])),g={userId:f.id,projectId:n.id};c.onEditorReady=function(){h(!0)},c.onRunCode=function(){n.diagram&&s.start((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram}))};var k=function(e){n.diagram&&s.start((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram,autoPause:!0,elf:!0,debug:e}))};c.commands.startPaused={name:"Start program paused",callback:k},c.commands.assemblyListing={name:"View Compiled Assembly Code Listing",callback:function(){return function(e,n,r){return Mn.apply(this,arguments)}(n,s,g)}},c.commands.openControlSocket={name:"Open Debug Web Socket",callback:function(){var e=prompt("Web socket URL?","ws://localhost:2442");e&&function(e,n,r){var t=new WebSocket(e),i=[],a=!1,o=!1,s=function(e){t.send(JSON.stringify(e))};t.addEventListener("open",(function(){s({cmd:"aloha",protocol:"wokwi",version:1}),i.push((0,De.N7)(n,"status",(function(e){s({cmd:"statusChange",status:Ie(e.newValue)}),e.newValue===Te.G.Paused&&a&&s({cmd:"gdbResponse",response:n.breakpoint?Ee.$_:Ee.ZY})}),!1))})),t.addEventListener("error",(function(){alert("Web socket connection failed!")})),t.addEventListener("close",(function(){var e=!0,n=!1,r=void 0;try{for(var t,a=i[Symbol.iterator]();!(e=(t=a.next()).done);e=!0)(0,t.value)()}catch(o){n=!0,r=o}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}console.log("[Websocket] disconnected")})),t.addEventListener("message",(function(e){var t,c=e.data;try{t=JSON.parse(c)}catch(f){return void console.error("[Websocket] invalid message:",c)}switch(t.cmd){case"start":var l=t.hex,d=r.diagram;if(!d)return void console.error("[Websocket] can't start simulation: missing diagram");l?n.loadHex(l,d).then((function(){n.resume()})):n.start({files:r.files,diagram:d});break;case"pause":n.pause();break;case"resume":n.resume();break;case"stop":n.stop();break;case"gdb":a=!0,n.debugging=!0;var u=n.gdbMessage(t.message);u&&s({cmd:"gdbResponse",response:u});break;case"serialMonitor":var h,p;o||(i.push(null!==(p=null===(h=n.serialRx)||void 0===h?void 0:h.subscribe((function(e){var n=!0,r=!1,t=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var o=i.value;s({cmd:"serialData",value:o})}}catch(c){r=!0,t=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw t}}})))&&void 0!==p?p:function(){return 0}),o=!0)}}))}(e,s,n)}},c.commands.startGDB={name:"Start Web GDB Session (debug build)",callback:function(){window.open("https://wokwi.github.io/web-gdb/"),k(!0),window.addEventListener("message",(function(e){var n=e.data;"gdbInit"===n.type&&(console.log("GDB Attached!"),function(e,n){var r=(0,De.N7)(e,"status",(function(r){r.newValue!==Te.G.Paused||e.restarting||n.postMessage({type:"gdb",data:e.breakpoint?Ee.$_:Ee.ZY})}),!1);e.debugging=!0,n.onmessage=function(r){var t=r.data;switch(t.type){case"break":e.pause();break;case"downloadElf":e.buildResult&&n.postMessage({type:"elf",data:e.buildResult.elf});break;case"downloadSources":var i;(null===(i=e.buildResult)||void 0===i?void 0:i.debugSources)&&n.postMessage({type:"sources",data:(0,De.ZN)(e.buildResult.debugSources)});break;case"gdb":var a=e.gdbMessage(t.data);a&&n.postMessage({type:"gdb",data:a})}},n.onmessageerror=function(){e.debugging=!1,r()}}(s,n.data))}))}},c.commands.downloadHex={name:"Download Compiled HEX Firmware",callback:(0,t.Z)(a().mark((function e(){var r,t,i,o,c,l,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.build((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram||Le.S0.create()}));case 2:r=e.sent,t=r.hex,(i=r.hexError)?alert(i):(null===(o=n.diagram)||void 0===o?void 0:o.board.mcuType.startsWith("esp32"))?(c=n.diagram.board.mcuType,(0,He.Sv)("firmware-".concat(c,".bin"),(0,ze.Xs)(null!==(l=null===t||void 0===t?void 0:t.hex)&&void 0!==l?l:""),"application/octet-stream")):(0,He.Sv)("firmware.hex",null!==(d=null===t||void 0===t?void 0:t.hex)&&void 0!==d?d:"","application/octet-stream");case 6:case"end":return e.stop()}}),e)})))},c.commands.flash={name:"Flash firmware to device (beta)",callback:(0,t.Z)(a().mark((function e(){var r,t,i,o,c,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=null===(r=n.diagram)||void 0===r?void 0:r.board.mcuType)||void 0===t?void 0:t.startsWith("esp32")){e.next=5;break}return alert("This feature is only available for ESP32 boards"),e.abrupt("return");case 5:return e.next=7,s.build((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram||Le.S0.create()}));case 7:i=e.sent,o=i.hex,(c=i.hexError)?alert(c):o&&(l="".concat(o.cacheKey,"-").concat((new Date).getTime()),window.open("https://flasher-esp32.apps.wokwi.com/?mcu=".concat(t,"&build=").concat(l)),window.addEventListener("message",(function(e){var n=e.data,r=n.port;if("loadBinary"===n.type&&n.build===l){var t,i=(0,ze.Xs)(null!==(t=null===o||void 0===o?void 0:o.hex)&&void 0!==t?t:"");r.postMessage({type:"flash",binaries:[{offset:65536,data:i.buffer}]},{transfer:[i.buffer]})}})));case 11:case"end":return e.stop()}}),e)})))},c.commands.downloadUF2={name:"Download UF2 Binary",callback:(0,t.Z)(a().mark((function e(){var t,i,o,c,l,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.e(838).then(r.bind(r,40838)),e.next=3,s.build((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram||Le.S0.create()}));case 3:return i=e.sent,o=i.hex,c=i.hexError,e.next=8,t;case 8:l=e.sent.hexToUF2,c?alert(c):(0,He.Sv)("firmware.uf2",l(null!==(d=null===o||void 0===o?void 0:o.hex)&&void 0!==d?d:""),"application/octet-stream");case 10:case"end":return e.stop()}}),e)})))},c.commands.downloadELF={name:"Download ELF with Debugging Symbols",callback:(0,t.Z)(a().mark((function e(){var r,t,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.build((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram||Le.S0.create(),elf:!0,debug:!0}));case 2:r=e.sent,t=r.hex,(i=r.hexError)?alert(i):(0,He.Sv)("firmware.elf",(0,ze.Xs)(null!==(o=null===t||void 0===t?void 0:t.elf)&&void 0!==o?o:""),"application/octet-stream");case 6:case"end":return e.stop()}}),e)})))},c.commands.simulateHex={name:"Load HEX File and Start Simulation...",callback:(0,t.Z)(a().mark((function e(){var r,t,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ke.aE)({});case 2:if(r=e.sent.files,t=null===r||void 0===r?void 0:r[0]){e.next=6;break}return e.abrupt("return");case 6:return i=t.name.toLowerCase(),o=i.endsWith(".uf2")||i.endsWith(".bin")||i.endsWith(".elf"),e.next=10,o?(0,ke.DT)(t):(0,ke.Ve)(t);case 10:if(c=e.sent,n.diagram){e.next=13;break}return e.abrupt("return");case 13:s.start((0,z.Z)((0,O.Z)({},g),{files:n.files,diagram:n.diagram,autoPause:i.includes("-pause."),sideHex:c}));case 14:case"end":return e.stop()}}),e)})))},c.commands.loadCustomChipC={name:"Create a custom C chip (alpha)",callback:(0,t.Z)(a().mark((function e(){var r,t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.files.find((function(e){return e.name===Ue}))){e.next=3;break}return alert("File ".concat(Ue," already exists, please edit it.")),e.abrupt("return");case 3:if(n.addFile(Ue,Re),n.files.find((function(e){return e.name===We}))||n.addFile(We,Oe),r=n.diagram){e.next=8;break}return e.abrupt("return");case 8:t="chip-"+We.split(".")[0],r.parts.find((function(e){return e.type===t}))||(r.addPartFromTemplate({type:t,prefix:"chip",attrs:[]}),n.syncDiagram());case 10:case"end":return e.stop()}}),e)})))},c.commands.loadCustomBoard={name:"Load custom board file...",callback:(0,t.Z)(a().mark((function e(){var r,t,i,o,s,c,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ke.aE)({directory:!0});case 2:if(r=e.sent.files,t=(0,he.Z)(r),i=t.find((function(e){return"board.json"===e.name})),o=t.find((function(e){return"board.svg"===e.name})),i){e.next=9;break}return alert("Error: missing board.json!"),e.abrupt("return");case 9:if(o){e.next=12;break}return alert("Error: missing board.svg!"),e.abrupt("return");case 12:return e.t0=ue.Z,e.next=15,Promise.all([(0,ke.Ve)(i),(0,ke.Ve)(o)]);case 15:e.t1=e.sent,s=(0,e.t0)(e.t1,2),c=s[0],d=s[1],m.loadUserBoard(c,d),n.syncDiagram(),l.fit();case 22:case"end":return e.stop()}}),e)})))},c.commands.downloadPcap={name:"Download WiFi Packet Capture (PCAP) file",callback:(0,t.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=s.wifi)&&n.medium.frames.length){e.next=4;break}return alert("No clients connect to the virtual WiFi"),e.abrupt("return");case 4:n.medium.downloadPcap();case 5:case"end":return e.stop()}}),e)})))};var j=["297588808377958922","300574786540536333","324549257843442260","316487782954435136","334081863635173972","341084517319049811","341045744203989588"];return c.commands.enableGateway={name:"Enable Private Wokwi IoT Gateway",callback:function(){f.club||j.includes(f.id||"")||"espressif"===f.organization?confirm("Enable local Wokwi IoT Gateway?")?localStorage.setItem("__proxy","ws://localhost:9011"):localStorage.removeItem("__proxy"):alert("This feature is only available for Wokwi Club members: https://wokwi.com/club")}},c.commands.enablePrivateBuild={name:"Enable private build server",callback:function(){var e=prompt("Build server name? (empty to disable)","");e&&"PIAI-df68d5f0"!==e&&"localhexi"!==e?alert("Unknown build server"):(localStorage.removeItem("__buildServer"),localStorage.removeItem("__hexi"),"localhexi"===e?localStorage.setItem("__hexi","http://localhost:4055"):e&&localStorage.setItem("__buildServer",e))}},(0,Be.Uf)()&&(c.commands.loadLocalLibraries={name:"Select local Arduino libraries directory",callback:(0,t.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Be.Y1)();case 2:(n=e.sent)&&(s.localLibraryDirectory=n);case 4:case"end":return e.stop()}}),e)})))}),"small"===v?(0,o.jsx)(sr,{project:n,files:b}):(0,o.jsx)(Qn,{project:n,files:b})})),dr=r(5970),ur=r.n(dr),hr=(0,Z.Z)(m.Z)({height:48}),pr=(0,_.Z)((function(e){return{button:{margin:e.spacing(1)},buttonIcon:{display:"inline-flex",minWidth:"initial",marginRight:e.spacing(1)}}})),fr=(0,S.Pi)((function(e){var n=e.project,r=e.embedMode,i=(0,I.useState)(!1),c=i[0],m=i[1],_=(0,I.useState)(!1),Z=_[0],S=_[1],C=(0,N.A)(),L=(0,I.useState)({ready:!1,embedMode:r||C.embed,commands:{}})[0],E=(0,I.useContext)(Tn.D),O=(0,I.useContext)(M.St),z=(0,A.q)("project").translate,B=(0,T.useRouter)();(0,I.useEffect)((function(){(0,W.f)()}),[]),(0,I.useEffect)((function(){O.token&&n.updateFromServer(O)}),[n,O,O.token]);var H=C.hatcheryEgg;(0,I.useEffect)((function(){H&&n.loadEgg(H)}),[n,H]);var G=function(){var e=(0,t.Z)(a().mark((function e(){var r,t,i=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>0&&void 0!==i[0]&&i[0],n){e.next=3;break}return e.abrupt("return");case 3:if(!n.locked||r){e.next=6;break}return alert(z("error.saveFailed","Save failed: project is locked!")),e.abrupt("return");case 6:return m(!0),e.prev=7,r&&n.fork(),e.next=11,(0,R.UI)(O,n);case 11:t=e.sent,n.changeId(t.projectId),n.changeOwner(t.owner),n.setPristine(),B.push("/projects/".concat(n.id),void 0,{shallow:!0});case 16:return e.prev=16,m(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[7,,16,19]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=(0,t.Z)(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.loggedIn){e.next=3;break}return alert(z("error.signInToLikeProject","Please sign-in to Like this project.")),e.abrupt("return");case 3:if(n&&n.id){e.next=5;break}return e.abrupt("return");case 5:return r=!n.userLiked,n.updateUserLike(r),e.t0=n,e.next=10,(0,R.$v)(O,n.id,r);case 10:e.t1=e.sent.hearts,e.t0.updateHearts.call(e.t0,e.t1),(0,F.L)({action:r?"like":"unlike",category:"project",label:n.name});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();L.onSaveCode=function(){return G(!1)},(0,I.useEffect)((function(){return function(){E.closeProject()}}),[n,E]);var q,V=pr(),K=n.id?(q="https://wokwi.com/share/".concat(n.id),"https://wokwi.com/api/oembed?url=".concat(encodeURIComponent(q))):null,ne=n.owner&&n.owner===O.id,re=U.h.find((function(e){return e.id===n.owner}));return(0,o.jsxs)(ee._,{children:[(0,o.jsx)(P(),{children:K&&(0,o.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:K,title:"Wokwi oEmbed provider"})}),(0,o.jsx)($.r,{children:(0,o.jsxs)("div",{className:ur().topButtons,children:[(0,o.jsxs)(Y,{size:"small",onClick:function(){return G(!1)},disabled:!n.modified||c||n.locked,variant:"contained",text:(0,o.jsx)(v.Z,{smDown:!0,implementation:"css",children:z("header.save","Save")}),startIcon:c?(0,o.jsx)(l(),{path:s.CEZ,size:1,spin:!0}):(0,o.jsx)(l(),{path:s.Tls,size:1}),children:[(0,o.jsx)(J,{children:(0,o.jsxs)(hr,{onClick:function(){return G(!0)},children:[(0,o.jsx)("div",{className:V.buttonIcon,children:(0,o.jsx)(d.Z,{})}),(0,o.jsx)(x.Z,{children:z("menu.saveACopy","Save a copy")})]})}),ne&&(0,o.jsx)(hr,{children:(0,o.jsx)(b.Z,{control:(0,o.jsx)(g.Z,{name:"lock",checkedIcon:(0,o.jsx)(u.Z,{}),icon:(0,o.jsx)(h.Z,{}),checked:n.locked,onChange:function(e,r){n.setLocked(r),(0,R.ty)(O,n)}}),label:z("menu.lockProject","Lock project")})}),ne&&(0,o.jsx)(hr,{children:(0,o.jsx)(b.Z,{control:(0,o.jsx)(g.Z,{name:"lock",checked:n.unlisted,onChange:function(e,r){n.setUnlisted(r),(0,R.ty)(O,n)}}),label:z("menu.unlistProject","Unlist project")})}),(0,o.jsxs)(hr,{onClick:function(){return(0,W.r)(n)},children:[(0,o.jsx)("div",{className:V.buttonIcon,children:(0,o.jsx)(l(),{path:s.OGU,size:1})}),(0,o.jsx)(x.Z,{children:z("menu.downloadProjectZip","Download project ZIP")})]})]}),(0,o.jsx)(k.Z,{size:"small",className:V.button,onClick:function(){return S(!0)},disabled:c,variant:"contained",startIcon:(0,o.jsx)(l(),{path:s.dGe,size:1}),children:z("header.share","Share")}),n.isDBProject&&(0,o.jsx)(j.Z,{title:n.userLiked?z("header.unlikeProjectTooltip","Unlike this project"):z("header.likeProjectTooltip","Like this project"),children:(0,o.jsx)(y.Z,{onClick:X,color:n.userLiked?"primary":"default",size:"large",children:(0,o.jsx)(p.Z,{})})}),(ne||re)&&(0,o.jsx)(v.Z,{smDown:!0,implementation:"css",children:(0,o.jsxs)(w.Z,{mx:1,sx:{position:"relative"},children:[n.name," ",(0,o.jsx)(y.Z,{size:"small",sx:{position:"absolute",top:-4},onClick:function(){var e=prompt("New project name?",null===n||void 0===n?void 0:n.name);n&&e&&e!==n.name&&(n.setName(e),(0,R.ty)(O,n))},children:(0,o.jsx)(f.Z,{})}),re&&(0,o.jsxs)("div",{children:["by"," ",(0,o.jsx)(D(),{href:"/makers/[maker]",as:"/makers/".concat(re.name),children:(0,o.jsx)("a",{children:null===re||void 0===re?void 0:re.name})})]})]})})]})}),(0,o.jsx)(de,{open:Z,project:n,onClose:function(){return S(!1)},saving:c,onSaveProject:function(){return G(!1)}}),(0,o.jsx)("main",{className:ur().main,children:(0,o.jsx)(je.x.Provider,{value:n,children:(0,o.jsx)(Q.r.Provider,{value:L,children:(0,o.jsx)(lr,{project:n})})})})]})}))},80451:function(e,n,r){"use strict";r.d(n,{h7:function(){return i},yz:function(){return t}});r(84104);var t={"AccelStepper.h":"AccelStepper","Adafruit_GFX.h":"Adafruit GFX Library","Adafruit_INA219.h":"Adafruit INA219","Adafruit_LEDBackpack.h":"Adafruit LED Backpack Library","Adafruit_MPU6050.h":"Adafruit MPU6050","Adafruit_NeoMatrix.h":"Adafruit NeoMatrix","Adafruit_NeoPixel.h":"Adafruit NeoPixel","Adafruit_SoftServo.h":"Adafruit SoftServo","Adafruit_ST7789.h":"Adafruit ST7735 and ST7789 Library","Adafruit_ST7735.h":"Adafruit ST7735 and ST7789 Library","Adafruit_ILI9341.h":"Adafruit ILI9341","Adafruit_Sensor.h":"Adafruit Unified Sensor","Adafruit_SSD1306.h":"Adafruit SSD1306","ArduinoJson.h":"ArduinoJson","BasicLinearAlgebra.h":"BasicLinearAlgebra","basicMPU6050.h":"basicMPU6050","blinker.h":"LC_baseTools","Bounce2.h":"Bounce2","Button.h":"Button","DallasTemperature.h":"DallasTemperature","dht.h":"DHTlib","DHT.h":"DHT sensor library","DHT_U.h":"DHT sensor library","DHTesp.h":"DHT sensor library for ESPx","DS3231.h":"DS3231","EEPROM.h":"EEPROM","Encoder.h":"Encoder","FastLED.h":"FastLED","FastLED_NeoMatrix.h":"FastLED NeoMatrix","FixedPoints.h":"FixedPoints","Geometry.h":"Geometry","I2Cdev.h":"MPU6050","idlers.h":"LC_baseTools","IRremote.h":"IRremote","IRremoteInt.h":"IRremote","Key.h":"Keypad","Keypad.h":"Keypad","lcdgfx.h":"lcdgfx","LedControl.h":"LedControl","lilParser.h":"LC_lilParser","LiquidCrystal.h":"LiquidCrystal","LiquidCrystal_I2C.h":"LiquidCrystal I2C","LiquidMenu.h":"LiquidMenu","MD_MAX72xx.h":"MD_MAX72XX","MD_Parola.h":"MD_Parola","mechButton.h":"LC_baseTools","Midier.h":"Midier","MPU6050.h":"MPU6050","MultiStepper.h":"AccelStepper","OneButton.h":"OneButton","OneWire.h":"OneWire","qrcode.h":"QRCode","PID_v1.h":"PID","pitches.h":"PlayRtttl","PlayRtttl.h":"PlayRtttl","protothreads.h":"Protothreads","pt.h":"Protothreads","RTClib.h":"RTClib","runningAvg.h":"LC_baseTools","SD.h":"SD","SdFat.h":"SdFat","Segment.h":"Segment","Servo.h":"Servo","ServoEasing.h":"ServoEasing","SevSeg.h":"SevSeg","ShiftDisplay.h":"ShiftDisplay","SimpleDHT.h":"SimpleDHT","SimpleTimer.h":"SimpleTimer","SoftwareSerial.h":"SoftwareSerial","SPI.h":"SPI","ssd1306.h":"ssd1306","SSD1306Ascii.h":"SSD1306Ascii","SSD1306AsciiWire.h":"SSD1306Ascii","SSD1306init.h":"SSD1306Ascii","Stepper.h":"Stepper","Talkie.h":"Talkie","TaskScheduler.h":"TaskScheduler","TimeLib.h":"Time","timeObj.h":"LC_baseTools","TimerOne.h":"TimerOne","Tiny4kOLED.h":"Tiny4kOLED","TinyDebug.h":"TinyDebug","TinyWireM.h":"TinyWireM","TM1637TinyDisplay.h":"TM1637TinyDisplay","U8glib.h":"U8glib","U8g2lib.h":"U8g2","U8x8lib.h":"U8g2","Ultrasonic.h":"Ultrasonic","VarSpeedServo.h":"VarSpeedServo","WiFiNINA.h":"WiFiNINA","Wire.h":"Wire"};function i(e){var n=e.matchAll(/(^|\n)\s*#include\s*[<"]([^.]+\.h)[">]/g);return Array.from(n).map((function(e){return e[2]}))}},98107:function(e,n,r){"use strict";function t(e){return{sidesetCount:e>>29&7,sideEn:!!(e&1<<30)}}function i(e){var n=255&e;switch(e>>>13){case 0:var r={0:"",1:"!x",2:"x--",3:"!y",4:"y--",5:"x!=y",6:"pin",7:"!osre"}[n>>5],t=31&n;return"jmp ".concat(r?r+", ":"").concat(t);case 1:var i={0:"gpio",1:"pin",2:"irq",3:"reserved"}[n>>5&3],a="irq"===i?7&n:31&n,o="irq"===i&&16&n?" rel":"";return"wait ".concat(128&n?"1":"0"," ").concat(i," ").concat(a).concat(o);case 2:var s=31&n;return"in ".concat({0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"reserved",6:"isr",7:"osr"}[n>>5],", ").concat(s||32);case 3:var c=31&n;return"out ".concat({0:"pins",1:"x",2:"y",3:"null",4:"pindirs",5:"pc",6:"isr",7:"exec"}[n>>5],", ").concat(c||32);case 4:var l=32&n?"":" noblock",d=64&n;return 128&n?"pull".concat(d?" ifempty":"").concat(l):"push".concat(d?" iffull":"").concat(l);case 5:var u={0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"status",6:"isr",7:"osr"}[7&n],h=n>>3&3,p={0:"pins",1:"x",2:"y",3:"reserved",4:"exec",5:"pc",6:"isr",7:"osr"}[n>>5&7],f=0===h?"":1===h?"~":2===h?"::":"";return u===p&&0===h?"nop":"mov ".concat(p,", ").concat(f).concat(u);case 6:if(128&n)return".data ".concat(e.toString(16));var m=32&n?" wait":"",v=16&n?" rel":"",x=7&n;return"irq".concat(64&n?" clear":"").concat(m," ").concat(x).concat(v);case 7:var b=31&n;return"set ".concat({0:"pins",1:"x",2:"y",4:"pindirs"}[n>>5],", ").concat(b)}return".data ".concat(e.toString(16))}function a(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t(0),r=n.sidesetCount,a=n.sideEn,o=[],s=[],c=0;c<e.length;c++){var l=e[c],d=l>>8&31,u=d&(1<<5-r)-1,h=i(l);if(r&&(!a||16&d)){var p=d>>5-r;a&&(p&=(1<<r-1)-1),h+=" .side(".concat(p,")")}u&&(h+=" [".concat(u,"]")),o[c]={address:c,text:h,label:!1},l>>13===0&&s.push(31&l)}var f=!0,m=!1,v=void 0;try{for(var x,b=s[Symbol.iterator]();!(f=(x=b.next()).done);f=!0){var g=x.value;o[g]&&(o[g].label=!0)}}catch(k){m=!0,v=k}finally{try{f||null==b.return||b.return()}finally{if(m)throw v}}return o}r.d(n,{C:function(){return a},k:function(){return t}})},64728:function(e,n,r){"use strict";function t(e,n,r){for(;e.length<n;)e=r+e;return e}function i(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return t(e.toString(),n,r)}r.d(n,{Gt:function(){return i}})},47598:function(e){e.exports={toolbar:"header-small_toolbar__as_Xd",logo:"header-small_logo__700Lg",menu:"header-small_menu__g1j0W",spacer:"header-small_spacer__ctq8S"}},90457:function(e){e.exports={debugger:"pio-debugger_debugger__FmzYe",current:"pio-debugger_current__DOX_g",listing:"pio-debugger_listing__qMfqG",lineNumber:"pio-debugger_lineNumber__bwbeZ",breakpoint:"pio-debugger_breakpoint__2hlYE",registers:"pio-debugger_registers__4PqDz",fifo:"pio-debugger_fifo__LpGn8"}},6853:function(e){e.exports={modalContent:"share-modal_modalContent__biXYr",shareLinkContainer:"share-modal_shareLinkContainer__TA_bA"}},5970:function(e){e.exports={topButtons:"project-page_topButtons__g_rp4",main:"project-page_main__3R7nS"}},80950:function(e){e.exports={splitPane:"workbench-desktop_splitPane__B0r3f",container:"workbench-desktop_container__c61v2",editor:"workbench-desktop_editor__L4Jxo",preview:"workbench-desktop_preview__Eeuqi",diagramOnly:"workbench-desktop_diagramOnly__d81uo"}},79570:function(e){e.exports={container:"workbench-mobile_container__QXVNe",tab:"workbench-mobile_tab__lFXw9",editor:"workbench-mobile_editor__IOH7W",diagram:"workbench-mobile_diagram__4pv_n"}}}]);